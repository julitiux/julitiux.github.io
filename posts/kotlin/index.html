<!DOCTYPE html>










































<html
  class="not-ready lg:text-base"
  style="--bg: #fbfbfb"
  lang="en-us"
>
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, shrink-to-fit=no"
  />

  
  <title>Kotlin - Blogs</title>

  
  <meta name="theme-color" />

  
  
  
  <meta name="description" content="INDEX 1. Your first kotlin application 2. Variables, Constants, and Types 3. Conditionals 4. Functions 5. anonymous Functions and the Function Type 6. Null safety and exceptions 7. Strings 8. Numbers 9. Starndard Functions 10. List and Sets 11. Maps 12. Defining Classes 13. Initialization. 14. Inhertance 15. Objects 16. Interfaces and Abstract Classes 17. Generics 18. Extensions 19. Functional Programming Basics 20. Java Interoperability 1. Your first kotlin application 2." />
  <meta name="author" content="Julitiux" />
  

  
  
  
  
  
  
  <link rel="preload stylesheet" as="style" href="https://julitiux.github.io/main.min.css" />

  

  
     
  <link rel="preload" as="image" href="https://julitiux.github.io/theme.svg" />

  
  
  
  <link rel="preload" as="image" href="https://cdn.v2ex.com/gravatar/6fd8df4abe41f17fd8e2dd7d97b5cc8c?s=160&amp;d=identicon" />
  
  

  
  <link rel="preload" as="image" href="https://julitiux.github.io/twitter.svg" />
  
  <link rel="preload" as="image" href="https://julitiux.github.io/github.svg" />
  
  <link rel="preload" as="image" href="https://julitiux.github.io/instagram.svg" />
  
  

  
  
  <link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.css"
  integrity="sha384-3UiQGuEI4TTMaFmGIZumfRPtfKQ3trwQE2JgosJxCnGmQpL/lJdjpcHkaaFwHlcI"
  crossorigin="anonymous"
/>
<script
  defer
  src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.js"
  integrity="sha384-G0zcxDFp5LWZtDuRMnBkk3EphCK1lhEf4UEyEM693ka574TZGwo4IWwS6QLzM/2t"
  crossorigin="anonymous"
></script>
<script
  defer
  src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/contrib/auto-render.min.js"
  integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05"
  crossorigin="anonymous"
  onload="renderMathInElement(document.body);"
></script>

  
  
  

  
  <link rel="icon" href="https://julitiux.github.io/favicon.ico" />
  <link rel="apple-touch-icon" href="https://julitiux.github.io/apple-touch-icon.png" />

  
  <meta name="generator" content="Hugo 0.107.0">

  
  

  
  
  
  
  
  
  
  <meta property="og:title" content="Kotlin" />
<meta property="og:description" content="INDEX 1. Your first kotlin application 2. Variables, Constants, and Types 3. Conditionals 4. Functions 5. anonymous Functions and the Function Type 6. Null safety and exceptions 7. Strings 8. Numbers 9. Starndard Functions 10. List and Sets 11. Maps 12. Defining Classes 13. Initialization. 14. Inhertance 15. Objects 16. Interfaces and Abstract Classes 17. Generics 18. Extensions 19. Functional Programming Basics 20. Java Interoperability 1. Your first kotlin application 2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://julitiux.github.io/posts/kotlin/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-03-07T14:46:09-06:00" />
<meta property="article:modified_time" content="2022-03-07T14:46:09-06:00" />


  
  <meta itemprop="name" content="Kotlin">
<meta itemprop="description" content="INDEX 1. Your first kotlin application 2. Variables, Constants, and Types 3. Conditionals 4. Functions 5. anonymous Functions and the Function Type 6. Null safety and exceptions 7. Strings 8. Numbers 9. Starndard Functions 10. List and Sets 11. Maps 12. Defining Classes 13. Initialization. 14. Inhertance 15. Objects 16. Interfaces and Abstract Classes 17. Generics 18. Extensions 19. Functional Programming Basics 20. Java Interoperability 1. Your first kotlin application 2."><meta itemprop="datePublished" content="2022-03-07T14:46:09-06:00" />
<meta itemprop="dateModified" content="2022-03-07T14:46:09-06:00" />
<meta itemprop="wordCount" content="25106">
<meta itemprop="keywords" content="" />
  
  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Kotlin"/>
<meta name="twitter:description" content="INDEX 1. Your first kotlin application 2. Variables, Constants, and Types 3. Conditionals 4. Functions 5. anonymous Functions and the Function Type 6. Null safety and exceptions 7. Strings 8. Numbers 9. Starndard Functions 10. List and Sets 11. Maps 12. Defining Classes 13. Initialization. 14. Inhertance 15. Objects 16. Interfaces and Abstract Classes 17. Generics 18. Extensions 19. Functional Programming Basics 20. Java Interoperability 1. Your first kotlin application 2."/>

  
  
</head>

  <body class="text-black duration-200 ease-out dark:text-white">
    <header class="mx-auto flex h-[4.5rem] max-w-3xl px-8 lg:justify-center">
  <div class="relative z-50 mr-auto flex items-center">
    <a
      class="-translate-x-[1px] -translate-y-[1px] text-2xl font-semibold"
      href="https://julitiux.github.io/"
      >Blogs</a
    >
    <div
      class="btn-dark text-[0] ml-4 h-6 w-6 shrink-0 cursor-pointer [background:url(./theme.svg)_left_center/cover_no-repeat] dark:invert dark:[background-position:right]"
      role="button"
      aria-label="Dark"
    ></div>
  </div>

  <div
    class="btn-menu relative z-50 -mr-8 flex h-[4.5rem] w-[5rem] shrink-0 cursor-pointer flex-col items-center justify-center gap-2.5 lg:hidden"
    role="button"
    aria-label="Menu"
  ></div>

  
  <script>
    
    const htmlClass = document.documentElement.classList;
    setTimeout(() => {
      htmlClass.remove('not-ready');
    }, 10);

    
    const btnMenu = document.querySelector('.btn-menu');
    btnMenu.addEventListener('click', () => {
      htmlClass.toggle('open');
    });

    
    const metaTheme = document.querySelector('meta[name="theme-color"]');
    const lightBg = '#fbfbfb'.replace(/"/g, '');
    const setDark = (isDark) => {
      metaTheme.setAttribute('content', isDark ? '#000' : lightBg);
      htmlClass[isDark ? 'add' : 'remove']('dark');
      localStorage.setItem('dark', isDark);
    };

    
    const darkScheme = window.matchMedia('(prefers-color-scheme: dark)');
    if (htmlClass.contains('dark')) {
      setDark(true);
    } else {
      const darkVal = localStorage.getItem('dark');
      setDark(darkVal ? darkVal === 'true' : darkScheme.matches);
    }

    
    darkScheme.addEventListener('change', (event) => {
      setDark(event.matches);
    });

    
    const btnDark = document.querySelector('.btn-dark');
    btnDark.addEventListener('click', () => {
      setDark(localStorage.getItem('dark') !== 'true');
    });
  </script>

  <div
    class="nav-wrapper fixed inset-x-0 top-full z-40 flex h-full select-none flex-col justify-center pb-16 duration-200 dark:bg-black lg:static lg:h-auto lg:flex-row lg:!bg-transparent lg:pb-0 lg:transition-none"
  >
    
    

    
    <nav
      class="mt-12 flex justify-center space-x-10 dark:invert lg:ml-12 lg:mt-0 lg:items-center lg:space-x-6"
    >
      
      <a
        class="h-8 w-8 text-[0] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6"
        style="--url: url(./twitter.svg)"
        href="https://twitter.com/julitiux"
        target="_blank"
        rel="me"
      >
        twitter
      </a>
      
      <a
        class="h-8 w-8 text-[0] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6"
        style="--url: url(./github.svg)"
        href="https://github.com/julitiux"
        target="_blank"
        rel="me"
      >
        github
      </a>
      
      <a
        class="h-8 w-8 text-[0] [background:var(--url)_center_center/cover_no-repeat] lg:h-6 lg:w-6"
        style="--url: url(./instagram.svg)"
        href="https://instagram.com/julitiux"
        target="_blank"
        rel="me"
      >
        instagram
      </a>
      
    </nav>
    
  </div>
</header>


    <main
      class="prose prose-neutral relative mx-auto min-h-[calc(100%-9rem)] max-w-3xl px-8 pb-16 pt-12 dark:prose-invert"
    >
      

<article>
  <header class="mb-16">
    <h1 class="!my-0 pb-2.5">Kotlin</h1>

    
    <div class="text-sm antialiased opacity-60">
      
      <time>Mar 7, 2022</time>
      
      
      
      
    </div>
    
  </header>

  <section><h1 id="index"><strong>INDEX</strong></h1>
<h1 id="1-your-first-kotlin-application1-your-first-kotlin-application"><a href="#1-your-first-kotlin-application">1. Your first kotlin application</a></h1>
<h1 id="2-variables-constants-and-types2-variables-constants-and-types"><a href="#2-variables-constants-and-types">2. Variables, Constants, and Types</a></h1>
<h1 id="3-conditionals3-conditionals"><a href="#3-conditionals">3. Conditionals</a></h1>
<h1 id="4-functions4-functions"><a href="#4-functions">4. Functions</a></h1>
<h1 id="5-anonymous-functions-and-the-function-type5-anonymous-functions-and-the-function-type"><a href="#5-anonymous-functions-and-the-function-type">5. anonymous Functions and the Function Type</a></h1>
<h1 id="6-null-safety-and-exceptions6-null-safety-and-exceptions"><a href="#6-null-safety-and-exceptions">6. Null safety and exceptions</a></h1>
<h1 id="7-strings7-strings"><a href="#7-strings">7. Strings</a></h1>
<h1 id="8-numbers8-numbers"><a href="#8-numbers">8. Numbers</a></h1>
<h1 id="9-starndard-functions9-starndard-functions"><a href="#9-starndard-functions">9. Starndard Functions</a></h1>
<h1 id="10-list-and-sets10-list-and-sets"><a href="#10-list-and-sets">10. List and Sets</a></h1>
<h1 id="11-maps11-maps"><a href="#11-maps">11. Maps</a></h1>
<h1 id="12-defining-classes12-defining-classes"><a href="#12-defining-classes">12. Defining Classes</a></h1>
<h1 id="13-initialization13-initialization"><a href="#13-initialization">13. Initialization.</a></h1>
<h1 id="14-inhertance14-inhertance"><a href="#14-inhertance">14. Inhertance</a></h1>
<h1 id="15-objects15-objects"><a href="#15-objects">15. Objects</a></h1>
<h1 id="16-interfaces-and-abstract-classes16-interfaces-and-abstract-classes"><a href="#16-interfaces-and-abstract-classes">16. Interfaces and Abstract Classes</a></h1>
<h1 id="17-generics17-generics"><a href="#17-generics">17. Generics</a></h1>
<h1 id="18-extensions18-extensions"><a href="#18-extensions">18. Extensions</a></h1>
<h1 id="19-functional-programming-basics19-functional-programming-basics"><a href="#19-functional-programming-basics">19. Functional Programming Basics</a></h1>
<h1 id="20-java-interoperability20-java-interoperability"><a href="#20-java-interoperability">20. Java Interoperability</a></h1>
<h1 id="1-your-first-kotlin-application">1. Your first kotlin application</h1>
<h1 id="2-variables-constants-and-types">2. Variables, Constants, and Types</h1>
<p>You use <em>variables</em> and <em>constants</em> ti store values and pass data around in your application.</p>
<h2 id="declaring-a-variable">Declaring a Variable</h2>
<p>You defines a variable using the keyword var, which indicates that you want to declare a new variable, followed by the new variable&rsquo;s name.</p>
<p>Next, you specified the type definition for the variable. : Int.</p>
<p>Last, you used th <em>assignment operator</em> (=) to assign what is on the righthand.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> variableName : Int = <span style="color:#ae81ff">5</span>
</span></span></code></pre></div><h2 id="kotlins-built-in-tyoes">Kotlin&rsquo;s Built-In Tyoes</h2>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
<th>Examples</th>
</tr>
</thead>
<tbody>
<tr>
<td>String</td>
<td>Textual Data</td>
<td>&ldquo;Text&rdquo;</td>
</tr>
<tr>
<td>Char</td>
<td>Single character</td>
<td>&lsquo;x&rsquo; Unicode character U+0041</td>
</tr>
<tr>
<td>Boolean</td>
<td>True/False values</td>
<td>true / false</td>
</tr>
<tr>
<td>Int</td>
<td>Whole numbers</td>
<td>1,2,3,4,5,6,7,8,9,0</td>
</tr>
<tr>
<td>Double</td>
<td>Decimal numbers</td>
<td>3.14, 2.10</td>
</tr>
<tr>
<td>List</td>
<td>Collections of Elements</td>
<td>[1,2,3,4,5,6,7,8,9,0]</td>
</tr>
<tr>
<td>Set</td>
<td>Collections of <em>unique</em> elements</td>
<td>[1,2,3,4,5,6,7,8,9,0]</td>
</tr>
<tr>
<td>Map</td>
<td>Collections of key-value pairs</td>
<td>&ldquo;small&rdquo; to 5.99, &ldquo;medium&rdquo; to 7.99, &ldquo;large&rdquo; to 10.99</td>
</tr>
</tbody>
</table>
<h2 id="read-only-variables">Read-Only Variables</h2>
<p>Kotlin provides a different syntaxis for declaring <em>read-only</em> variables - variables that cannot be modified once they are addigned.</p>
<p>To declare a read-only variable, you use the <strong>val</strong> keyword.</p>
<h2 id="type-inference">Type Inference</h2>
<p>Notice that the type definitions you specified for the playerName and experiencePoints variables are grayed out in IntelliJ. Grayed-out text indicates an element that is not required.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> playerName : _String_ = <span style="color:#e6db74">&#34;Estragon&#34;</span>
</span></span></code></pre></div><p>Kotlin includes a feature called <em>type inference</em> that allows you to omit the type definition for the variable that are assigned a value when are declared. Because you assign data of the String type to playerName and of the Int type to experiencePoints when you declare them, the kotlin compiler infers the appropriate type information for both variables.</p>
<h2 id="inspecting-kotlin-bytecode">Inspecting Kotlin Bytecode</h2>
<p>Press the Shift key twice to open the Search Everywhere dialog. Begin entering &ldquo;show kotling bytecode&rdquo; in the search box, and select Show Kotlin Bytecode from the list of available actions when it appears.</p>
<p>You can also open the tool window with Tools =&gt; Kotlin =&gt; Show Kotlin Bytecode.</p>
<h2 id="common-functions-in-kotlin">Common functions in Kotlin</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>  <span style="color:#66d9ef">val</span> emptyList = emptyList&lt;Int&gt;()
</span></span><span style="display:flex;"><span>  println(<span style="color:#e6db74">&#34;emptyList.any() is </span><span style="color:#e6db74">${emptyList.any()}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">val</span> nonEmptyList = listOf&lt;Int&gt;(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>  println(<span style="color:#e6db74">&#34;nonEmptyList.any() is </span><span style="color:#e6db74">${nonEmptyList.any()}</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>  <span style="color:#66d9ef">val</span> numbers = listOf(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">val</span> firstOdd = numbers.find { <span style="color:#66d9ef">it</span> % <span style="color:#ae81ff">2</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">val</span> firstLast = numbers.findLast { <span style="color:#66d9ef">it</span> % <span style="color:#ae81ff">2</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> }
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>  <span style="color:#66d9ef">val</span> strings : List&lt;String&gt; = listOf(<span style="color:#e6db74">&#34;12a&#34;</span>, <span style="color:#e6db74">&#34;45&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;3&#34;</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">val</span> ints: List&lt;Int&gt; = strings.mapNotNull { <span style="color:#66d9ef">it</span>.toIntOrNull() }
</span></span><span style="display:flex;"><span>  println(ints) <span style="color:#75715e">// [45, 3]
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  println(ints.sum()) <span style="color:#75715e">// 48
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>  <span style="color:#66d9ef">val</span> map = mapOf(<span style="color:#e6db74">&#34;Alice&#34;</span> to <span style="color:#ae81ff">20</span>, <span style="color:#e6db74">&#34;Tom&#34;</span> to <span style="color:#ae81ff">13</span>, <span style="color:#e6db74">&#34;Bob&#34;</span> to <span style="color:#ae81ff">18</span> )
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">val</span> adults = map.mapNotNull { (name, age) <span style="color:#f92672">-&gt;</span> name.takeIf { age <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">18</span> } }
</span></span><span style="display:flex;"><span>  println(adults) <span style="color:#75715e">// [Alice, Bob]
</span></span></span></code></pre></div><h1 id="3-conditionals">3. Conditionals</h1>
<p>This lenguage feature is called <em>control flow</em>, and it allows yoy yo describe the conditions for when specific portions of your program should run.</p>
<p>Tip: Add a <strong>main</strong> entry point function to <em>program_kt</em> by typing &ldquo;main&rdquo; and pressing the Tab key. Your function should look like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;){
</span></span><span style="display:flex;"><span>	<span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-31-printing-the-players-health-condition-gamekt">Listing 3.1 Printing the playerâ€™s health condition (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>&gt;&gt;    <span style="color:#66d9ef">val</span> name = <span style="color:#e6db74">&#34;Madrigal&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;    <span style="color:#66d9ef">var</span> healthPoints = <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>&gt;&gt;    <span style="color:#66d9ef">if</span> (healthPoints <span style="color:#f92672">==</span> <span style="color:#ae81ff">100</span>) {
</span></span><span style="display:flex;"><span>&gt;&gt;        println(name + <span style="color:#e6db74">&#34; is in excellent condition!&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>&gt;&gt;        println(name + <span style="color:#e6db74">&#34; is in awful condition!&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>You express this with the == <em>structural equality operator</em>. It can be read as &ldquo;is equal to&rdquo;, so this statement reads &ldquo;if healthPoint is equals to 100&rdquo;.</p>
<p>Using the addition operator (+) to append a value to a string is called <em>string concatenation</em>. It is an easy way to customize what is printed to the conole based on the value of variable.</p>
<h3 id="table-31-comparison-operators">Table 3.1 Comparison operators</h3>
<table>
<thead>
<tr>
<th>Operator</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>&lt;</td>
<td>Evaluates whether the value on the left is less than the value on the right</td>
</tr>
<tr>
<td>&lt;=</td>
<td>Evaluates whether the value on the left is less than or equal to the value on the right</td>
</tr>
<tr>
<td>&gt;</td>
<td>Evaluates whether the value on the left is greater than the value on the right</td>
</tr>
<tr>
<td>&gt;=</td>
<td>Evaluates whether the value on the left is greater than or equal to the value on the right</td>
</tr>
<tr>
<td>==</td>
<td>Evaluates whether the value on the left is equal to the value on the right</td>
</tr>
<tr>
<td>!=</td>
<td>Evaluates whether the value on the left is not equal to the value on the right</td>
</tr>
<tr>
<td>===</td>
<td>Evaluates whether the two instances point to the same reference</td>
</tr>
<tr>
<td>!==</td>
<td>Evaluates whether the two instances do not point to the same reference</td>
</tr>
</tbody>
</table>
<p>Back to business. Run Game.tk by clicking the run button to the left of the <strong>main</strong> function.</p>
<p>You can included a code <em>comment</em>, indicated by //</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#75715e">// This is a comment
</span></span></span></code></pre></div><p>Anything to the right of // is included in the comment and is ignored by the compiler, so you can use any syntaxys you want there.</p>
<h3 id="listing-32-modifying-healthpoints-gamekt">Listing 3.2 Modifying healthPoints (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> name = <span style="color:#e6db74">&#34;Madrigal&#34;</span>
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">var</span> healthPoints = <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">var</span> healthPoints = <span style="color:#ae81ff">89</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (healthPoints <span style="color:#f92672">==</span> <span style="color:#ae81ff">100</span>) {
</span></span><span style="display:flex;"><span>        println(name + <span style="color:#e6db74">&#34; is in excellent condition!&#34;</span>)
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        println(name + <span style="color:#e6db74">&#34; is in awful condition!&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-33-checking-for-more-player-conditions-gamekt">Listing 3.3 Checking for more player conditions (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> name = <span style="color:#e6db74">&#34;Madrigal&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> healthPoints = <span style="color:#ae81ff">89</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (healthPoints <span style="color:#f92672">==</span> <span style="color:#ae81ff">100</span>) {
</span></span><span style="display:flex;"><span>        println(name + <span style="color:#e6db74">&#34; is in excellent condition!&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (healthPoints <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">90</span>) { println(name + <span style="color:#e6db74">&#34; has a few scratches.&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (healthPoints <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">75</span>) {
</span></span><span style="display:flex;"><span>&gt;&gt;      println(name + <span style="color:#e6db74">&#34; has some minor wounds.&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (healthPoints <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">15</span>) {
</span></span><span style="display:flex;"><span>&gt;&gt;      println(name + <span style="color:#e6db74">&#34; looks pretty hurt.&#34;</span>)
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        println(name + <span style="color:#e6db74">&#34; is in awful condition!&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-34-checking-for-blessedness-gamekt">Listing 3.4 Checking for blessedness (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> name = <span style="color:#e6db74">&#34;Madrigal&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> healthPoints = <span style="color:#ae81ff">89</span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> isBlessed = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (healthPoints <span style="color:#f92672">==</span> <span style="color:#ae81ff">100</span>) {
</span></span><span style="display:flex;"><span>            println(name + <span style="color:#e6db74">&#34;is in excellent condition!&#34;</span>)
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (healthPoints <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">90</span>) {
</span></span><span style="display:flex;"><span>            println(name + <span style="color:#e6db74">&#34; has a few scratches.&#34;</span>)
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (healthPoints <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">75</span>) {
</span></span><span style="display:flex;"><span>&gt;&gt;          <span style="color:#66d9ef">if</span> (isBlessed) {
</span></span><span style="display:flex;"><span>&gt;&gt;              println(name + <span style="color:#e6db74">&#34; has some minor wounds but is healing quite quickly!&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;          } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                println(name + <span style="color:#e6db74">&#34; has some minor wounds.&#34;</span>)
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (healthPoints <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">15</span>) {
</span></span><span style="display:flex;"><span>            println(name + <span style="color:#e6db74">&#34; looks pretty hurt.&#34;</span>)
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            println(name + <span style="color:#e6db74">&#34; is in awful condition!&#34;</span>)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-35-using-logical-operators-in-a-conditional-gamekt">Listing 3.5 Using logical operators in a conditional (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> name = <span style="color:#e6db74">&#34;Madrigal&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> healthPoints = <span style="color:#ae81ff">89</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> isBlessed = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> isImmortal = <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#75715e">// Aura
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>&gt;&gt;  <span style="color:#66d9ef">if</span> (isBlessed <span style="color:#f92672">&amp;&amp;</span> healthPoints &gt; <span style="color:#ae81ff">50</span> <span style="color:#f92672">||</span> isImmortal) {
</span></span><span style="display:flex;"><span>&gt;&gt;      println(<span style="color:#e6db74">&#34;GREEN&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>&gt;&gt;      println(<span style="color:#e6db74">&#34;NONE&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (healthPoints <span style="color:#f92672">==</span> <span style="color:#ae81ff">100</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="table-32-logical-operator">Table 3.2 Logical operator</h3>
<table>
<thead>
<tr>
<th>Operator</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>&amp;&amp;</td>
<td>Logical &lsquo;and&rsquo; : true if and only if both are true (false otherwise)</td>
</tr>
<tr>
<td>'</td>
<td></td>
</tr>
<tr>
<td>!</td>
<td>Logical &rsquo;not&rsquo; : true becomes false, false becomes true</td>
</tr>
</tbody>
</table>
<p>Incidentally, if you tired of keeping your code nicely indented as you make changes. IntelliJ is here to help. Select Code =&gt; Auto-Ident Lines and enjoy the simple pleasure of clean idents.</p>
<h3 id="listing-36-using-logical-operators-in-the-declaration-of-a-variable-gamekt">Listing 3.6 Using logical operators in the declaration of a variable (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Aura
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>&lt;&lt;  <span style="color:#66d9ef">if</span> (isBlessed <span style="color:#f92672">&amp;&amp;</span> healthPoints &gt; <span style="color:#ae81ff">50</span> <span style="color:#f92672">||</span> isImmortal) {
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> auraVisible = isBlessed <span style="color:#f92672">&amp;&amp;</span> healthPoints &gt; <span style="color:#ae81ff">50</span> <span style="color:#f92672">||</span> isImmortal
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">if</span> (auraVisible) {
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;GREEN&#34;</span>)
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;NONE&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-37-using-a-conditional-expression-gamekt">Listing 3.7 Using a conditional expression (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">if</span> (healthPoints <span style="color:#f92672">==</span> <span style="color:#ae81ff">100</span>) {
</span></span><span style="display:flex;"><span>&gt;&gt;    <span style="color:#66d9ef">val</span> healthStatus = <span style="color:#66d9ef">if</span> (healthPoints <span style="color:#f92672">==</span> <span style="color:#ae81ff">100</span>) {
</span></span><span style="display:flex;"><span>&gt;&gt;        println(name + <span style="color:#e6db74">&#34;is in excellent condition!&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;is in excellent condition!&#34;</span>
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (healthPoints <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">90</span>) {
</span></span><span style="display:flex;"><span>&lt;&lt;      println(name + <span style="color:#e6db74">&#34; has a few scratches.&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;      <span style="color:#e6db74">&#34;has a few scratches.&#34;</span>
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (healthPoints <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">75</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (isBlessed) {
</span></span><span style="display:flex;"><span>&lt;&lt;      println(name + <span style="color:#e6db74">&#34; has some minor wounds but is healing quite quickly!&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;      <span style="color:#e6db74">&#34;has some minor wounds but is healing quite quickly!&#34;</span>
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>&lt;&lt;          println(name + <span style="color:#e6db74">&#34; has some minor wounds.&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;          <span style="color:#e6db74">&#34;has some minor wounds.&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (healthPoints <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">15</span>) {
</span></span><span style="display:flex;"><span>&lt;&lt;      println(name + <span style="color:#e6db74">&#34; looks pretty hurt.&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;      <span style="color:#e6db74">&#34;looks pretty hurt.&#34;</span>
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>&lt;&lt;      println(name + <span style="color:#e6db74">&#34; is in awful condition!&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;      <span style="color:#e6db74">&#34;is in awful condition!&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#75715e">// Player status
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>&gt;&gt;  println(name + <span style="color:#e6db74">&#34; &#34;</span> + healthStatus)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-38-improving-aura-code-with-a-conditional-expression-gamekt">Listing 3.8 Improving aura code with a conditional expression (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Aura
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">val</span> auraVisible = isBlessed <span style="color:#f92672">&amp;&amp;</span> healthPoints &gt; <span style="color:#ae81ff">50</span> <span style="color:#f92672">||</span> isImmortal
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">if</span> (auraVisible) {
</span></span><span style="display:flex;"><span>&lt;&lt;      println(<span style="color:#e6db74">&#34;GREEN&#34;</span>)
</span></span><span style="display:flex;"><span>&lt;&lt;  } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>&lt;&lt;      println(<span style="color:#e6db74">&#34;NONE&#34;</span>)
</span></span><span style="display:flex;"><span>&lt;&lt;  }
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> auraColor = <span style="color:#66d9ef">if</span> (auraVisible) <span style="color:#e6db74">&#34;GREEN&#34;</span> <span style="color:#66d9ef">else</span> <span style="color:#e6db74">&#34;NONE&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;  println(auraColor)
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><h2 id="ranges">Ranges</h2>
<p>Kotlin provides <em>ranges</em> to represent a lineas seriesof values.</p>
<p>The .. operator, as in in 1..5, signals a range. A range includes all values from the value on the leftof the .. operator to the value on teh rigth, so 1..5 includes 1,2,3,4 and 5. Ranges can also be a sequence of characteres.</p>
<p>You use the <em>in</em> keyword to check whether a value is within a range.</p>
<h3 id="listing-39-refactoring-healthstatus-with-rangesgamekt">Listing 3.9 Refactoring healthStatus with ranges(Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> healthStatus = <span style="color:#66d9ef">if</span> (healthPoints <span style="color:#f92672">==</span> <span style="color:#ae81ff">100</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;is in excellent condition!&#34;</span>
</span></span><span style="display:flex;"><span>&lt;&lt;      } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (healthPoints <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">90</span>) {
</span></span><span style="display:flex;"><span>&gt;&gt;      } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (healthPoints <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">90.</span>.<span style="color:#ae81ff">99</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;has a few scratches.&#34;</span>
</span></span><span style="display:flex;"><span>&lt;&lt;      } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (healthPoints <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">75</span>) {
</span></span><span style="display:flex;"><span>&gt;&gt;      } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (healthPoints <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">75.</span>.<span style="color:#ae81ff">89</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (isBlessed) {
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;has some minor wounds but is healing quite quickly!&#34;</span>
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;has some minor wounds.&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>&lt;&lt;      } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (healthPoints <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">15</span>) {
</span></span><span style="display:flex;"><span>&gt;&gt;      } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (healthPoints <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">15.</span>.<span style="color:#ae81ff">74</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;looks pretty hurt.&#34;</span>
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;is in awful condition!&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="when-expressions">when Expressions</h2>
<p>Then when espression is another control flow mechanism available in Kotlin. Like if/else, the when expression allows you to write conditions to check for and will execute corresponding code when the condition evaluates as true. when provides a more concise syntaxis and is an especially good fit for conditionals with three or more branches.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> race = <span style="color:#e6db74">&#34;gnaome&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">val</span> faction = <span style="color:#66d9ef">when</span> (race) {
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;dwarf&#34;</span> <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;Keepers of the Mines&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;gnome&#34;</span> <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;Keepers of the Mines&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;orc&#34;</span> <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;Free people of the Rolling Hills&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;human&#34;</span> <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;Free people of the Rolling Hills&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>First, a val is declared, race. Next, a second val is declared: faction, whose value isdetermined with a when expression. The expression checks tha value of race against each of the values on the lefthand side of the -&gt; operator (called the arrow), and when it finds a match it assigns faction the value on the righthand side. (-&gt; is used differently in other langaujes &ndash; and, is has other uses in Kotlin, as you will see later)</p>
<p>A practical rule of thumb is that a when expression should replace an if/else expression if your code includes an else if branch.</p>
<p>A when expression work similarly to an if/else expression in that you define conditions and branches that are executed if a conditions is true. when is different in that it <em>scopes</em> the lefthand side of the condition automatically to whatever you provide as an argument to when.</p>
<p>By the way, were you wondering abut the nested if/else in one branch of your when expression? This pattern is not very common, but Kotlin&rsquo;s when expression gives you all of flexibility that you need to implement it.</p>
<h2 id="listing-310-refactoring-healthstatus-with-when-gamekt">Listing 3.10 Refactoring healthStatus with when (Game.kt)</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">val</span> healthStatus = <span style="color:#66d9ef">if</span> (healthPoints <span style="color:#f92672">==</span> <span style="color:#ae81ff">100</span>) {
</span></span><span style="display:flex;"><span>&lt;&lt;          <span style="color:#e6db74">&#34;is in excellent condition!&#34;</span>
</span></span><span style="display:flex;"><span>&lt;&lt;      } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (healthPoints <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">90.</span>.<span style="color:#ae81ff">99</span>) {
</span></span><span style="display:flex;"><span>&lt;&lt;          <span style="color:#e6db74">&#34;has a few scratches.&#34;</span>
</span></span><span style="display:flex;"><span>&lt;&lt;      } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (healthPoints <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">75.</span>.<span style="color:#ae81ff">89</span>) {
</span></span><span style="display:flex;"><span>&lt;&lt;          <span style="color:#66d9ef">if</span> (isBlessed) {
</span></span><span style="display:flex;"><span>&lt;&lt;              <span style="color:#e6db74">&#34;has some minor wounds but is healing quite quickly!&#34;</span>
</span></span><span style="display:flex;"><span>&lt;&lt;          } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>&lt;&lt;              <span style="color:#e6db74">&#34;has some minor wounds.&#34;</span>
</span></span><span style="display:flex;"><span>&lt;&lt;          }
</span></span><span style="display:flex;"><span>&lt;&lt;      } <span style="color:#66d9ef">else</span> <span style="color:#66d9ef">if</span> (healthPoints <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">15.</span>.<span style="color:#ae81ff">74</span>) {
</span></span><span style="display:flex;"><span>&lt;&lt;          <span style="color:#e6db74">&#34;looks pretty hurt.&#34;</span>
</span></span><span style="display:flex;"><span>&lt;&lt;      } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>&lt;&lt;          <span style="color:#e6db74">&#34;is in awful condition!&#34;</span>
</span></span><span style="display:flex;"><span>&lt;&lt;      }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;    <span style="color:#66d9ef">val</span> healthStatus = <span style="color:#66d9ef">when</span> (healthPoints) {
</span></span><span style="display:flex;"><span>&gt;&gt;        <span style="color:#ae81ff">100</span> <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;is in excellent condition!&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;        <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">90.</span>.<span style="color:#ae81ff">99</span> <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;has a few scratches.&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;        <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">75.</span>.<span style="color:#ae81ff">89</span> <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">if</span> (isBlessed) {
</span></span><span style="display:flex;"><span>&gt;&gt;            <span style="color:#e6db74">&#34;has some minor wounds but is healing quite quickly!&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;        } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>&gt;&gt;            <span style="color:#e6db74">&#34;has some minor wounds.&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;        }
</span></span><span style="display:flex;"><span>&gt;&gt;        <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">15.</span>.<span style="color:#ae81ff">74</span> <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;looks pretty hurt.&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;        <span style="color:#66d9ef">else</span> <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;is in awful condition!&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="string-templates">String Templates</h2>
<p>You have seen that a string can be built up with the values of variables and even the results of conditional expressions. Kotlin features <em>string templates</em> to aid in this common need and, again, make your code more readable. Templates allow you to include the value of a variable inside a strig&rsquo;s quotation marks.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>println (name + <span style="color:#e6db74">&#34; &#34;</span> + otherVariable)
</span></span><span style="display:flex;"><span>println (<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">$name</span><span style="color:#e6db74"> </span><span style="color:#e6db74">$otherVariable</span><span style="color:#e6db74">&#34;</span>)
</span></span></code></pre></div><h2 id="listing-311-using-a-string-template-gamekt">Listing 3.11 Using a string template (Game.kt)</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Player status
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>&lt;&lt;  println(name + <span style="color:#e6db74">&#34; &#34;</span> + healthStatus)
</span></span><span style="display:flex;"><span>&gt;&gt;  println(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">$name</span><span style="color:#e6db74"> </span><span style="color:#e6db74">$healthStatus</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>This special symbol indicates to Kotlin that you would be like to template a val o var within a string you define, and it is provided as a convenience. Note that these templated values appeat inside the quotation marks that define the string.</p>
<p>Kotlin also allow you to evaluate an expression within a string and <em>interpolate</em> the result &ndash; that is, to insert the result into to string. Any expression that you add within the curl braces after a dollar-sign character (${}) will be evaluated as a part of the string. Add a report of the player&rsquo;s blessedness and aura color to the player status display to see how this works.</p>
<h2 id="listing-312-formatting-the-isblessed-status-with-a-string-expression-gamekt">Listing 3.12 Formatting the isBlessed status with a string expression (Game.kt)</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Aura
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">val</span> auraVisible = isBlessed <span style="color:#f92672">&amp;&amp;</span> healthPoints &gt; <span style="color:#ae81ff">50</span> <span style="color:#f92672">||</span> isImmortal
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> auraColor = <span style="color:#66d9ef">if</span> (auraVisible) <span style="color:#e6db74">&#34;GREEN&#34;</span> <span style="color:#66d9ef">else</span> <span style="color:#e6db74">&#34;NONE&#34;</span>
</span></span><span style="display:flex;"><span>&lt;&lt;  print(auraColor)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Player status
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>&gt;&gt;  println(<span style="color:#e6db74">&#34;(Aura: </span><span style="color:#e6db74">$auraColor</span><span style="color:#e6db74">) &#34;</span> +
</span></span><span style="display:flex;"><span>&gt;&gt;          <span style="color:#e6db74">&#34;(Blessed: </span><span style="color:#e6db74">${if (isBlessed) &#34;YES&#34; else &#34;NO&#34;}</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">$name</span><span style="color:#e6db74"> </span><span style="color:#e6db74">$healthStatus</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h1 id="4-functions">4. Functions</h1>
<p>A <em>function</em> is a reausable portion of code that accomplishes a specific task.</p>
<p>Control-click (click-right) on the code you selected and choose Refactor -&gt; Extract -&gt; Function&hellip;</p>
<h2 id="anatomy-of-a-function">Anatomy of a Function</h2>
<p>A function consist of a function header and function body</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">formatHealthStatus</span>(healhPoints: Int, isBlessed: Boolean): String {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> healthStatus
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="function-header">Function header</h2>
<p>This first part of function is the function header. The function header is made up of five parts. the visibility modifier, function declaration keyword, function name , function parametert, and return type</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">formatHealthStatus</span>(healthPoint: Int, isBlessed Boolean); String{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> healthStatus
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// visibility modifier
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">private</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// function declatartion keyword
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">fun</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">//</span> <span style="color:#a6e22e">function</span> name
</span></span><span style="display:flex;"><span>formatHealthStatus
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// function parameters
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>healthPoint: Int, isBlessed Boolean
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">//return type
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>String
</span></span></code></pre></div><h2 id="listing41-adding-a-castfireball-function-gamekt">Listing4.1 Adding a castFireball function (Game.kt)</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">auraColor</span>(isBlessed: Boolean,
</span></span><span style="display:flex;"><span>                        healthPoints: Int,
</span></span><span style="display:flex;"><span>                        isImmortal: Boolean): String {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> auraVisible = isBlessed <span style="color:#f92672">&amp;&amp;</span> healthPoints &gt; <span style="color:#ae81ff">50</span> <span style="color:#f92672">||</span> isImmortal
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> auraColor = <span style="color:#66d9ef">if</span> (auraVisible) <span style="color:#e6db74">&#34;GREEN&#34;</span> <span style="color:#66d9ef">else</span> <span style="color:#e6db74">&#34;NONE&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> auraColor
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">castFireball</span>() {
</span></span><span style="display:flex;"><span>&gt;&gt;      println(<span style="color:#e6db74">&#34;A glass of Fireball springs into existence.&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  }
</span></span></code></pre></div><h2 id="listing-42-calling-castfireball-gamekt">Listing 4.2 Calling castFireball (Game.kt)</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Player status
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    printPlayerStatus(auraColor, isBlessed, name, healthStatus)
</span></span><span style="display:flex;"><span>&gt;&gt;  castFireball()
</span></span><span style="display:flex;"><span>} <span style="color:#f92672">..</span>.
</span></span></code></pre></div><h2 id="listing-43-adding-a-numfireballs-parameter-gamekt">Listing 4.3 Adding a numFireballs parameter (Game.kt)</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Player status
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    printPlayerStatus(auraColor, isBlessed, name, healthStatus)
</span></span><span style="display:flex;"><span>&lt;&lt;  castFireball()
</span></span><span style="display:flex;"><span>&gt;&gt;  castFireball(<span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">castFireball</span>() {
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">castFireball</span>(numFireballs: Int) {
</span></span><span style="display:flex;"><span>&lt;&lt;      println(<span style="color:#e6db74">&#34;A glass of Fireball springs into existence.&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;        println(<span style="color:#e6db74">&#34;A glass of Fireball springs into existence. (x</span><span style="color:#e6db74">$numFireballs</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="default-arguments">Default Arguments</h2>
<h3 id="listing-44-giving-the-numfireballs-parameter-a-default-valuegamekt">Listing 4.4 Giving the numFireballs parameter a default value(Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Player status
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    printPlayerStatus(auraColor, isBlessed, name, healthStatus)
</span></span><span style="display:flex;"><span>    castFireball(<span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">castFireball</span>(numFireballs: Int) {
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">castFireball</span>(numFireballs: Int = <span style="color:#ae81ff">2</span>) {
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;A glass of Fireball springs into existence. (x</span><span style="color:#e6db74">$numFireballs</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><h3 id="listing-45-using-castfireballs-default-argument-value-gamekt">Listing 4.5 Using castFireballâ€™s default argument value (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Player status
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    printPlayerStatus(auraColor, isBlessed, name, healthStatus)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;&lt;  castFireball(<span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  castFireball()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><h3 id="listing-46-using-optional-single-expression-function-syntax-gamekt">Listing 4.6 Using optional single-expression function syntax (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">formatHealthStatus</span>(healthPoints: Int, isBlessed: Boolean): String {
</span></span><span style="display:flex;"><span>&lt;&lt;      <span style="color:#66d9ef">val</span> healthStatus = <span style="color:#66d9ef">when</span> (healthPoints) {
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">formatHealthStatus</span>(healthPoints: Int, isBlessed: Boolean) =
</span></span><span style="display:flex;"><span>&gt;&gt;          <span style="color:#66d9ef">when</span> (healthPoints) {
</span></span><span style="display:flex;"><span>                <span style="color:#ae81ff">100</span> <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;is in excellent condition!&#34;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">90.</span>.<span style="color:#ae81ff">99</span> <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;has a few scratches.&#34;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">75.</span>.<span style="color:#ae81ff">89</span> <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">if</span> (isBlessed) {
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#34;has some minor wounds, but is healing quite quickly!&#34;</span>
</span></span><span style="display:flex;"><span>                } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                    <span style="color:#e6db74">&#34;has some minor wounds.&#34;</span>
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">15.</span>.<span style="color:#ae81ff">74</span> <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;looks pretty hurt.&#34;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">else</span> <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;is in awful condition!&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>&lt;&lt;      <span style="color:#66d9ef">return</span> healthStatus
</span></span><span style="display:flex;"><span>&lt;&lt;  }
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">castFireball</span>(numFireballs: Int = <span style="color:#ae81ff">2</span>)  {
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">castFireball</span>(numFireballs: Int = <span style="color:#ae81ff">2</span>) =
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;A glass of Fireball springs into existence. (x</span><span style="color:#e6db74">$numFireballs</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>&lt;&lt;  }
</span></span></code></pre></div><h2 id="unit-functions">Unit Functions</h2>
<p>Not all functions return a value. Some use side effects instead to do their work, like modifying the state of a variable or calling other functions that yield system output.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">castFireball</span>(numFireballs: Int = <span style="color:#ae81ff">2</span>) =
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;A glass of Fireball springs into existence. (x</span><span style="color:#e6db74">$numFireballs</span><span style="color:#e6db74">)&#34;</span>)
</span></span></code></pre></div><p>Kotlin uses the <em>Unit</em> return type to signify exactly this: a function that returns no value. If the return keyword is not used, it is implicit that the return type for that function is Unit.</p>
<h2 id="named-function-aguments">Named Function Aguments</h2>
<p>Take a look at how you call the printPlayerStatus function, passing arguments as parameters:</p>
<pre tabindex="0"><code class="language-kotling" data-lang="kotling">printPlayerStatus(&#34;NONE&#34;, true, &#34;Mandrigal&#34;, status)
</code></pre><p>Another way you could call the same function is:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>printPlayerStatus(auraColor = <span style="color:#e6db74">&#34;NONE&#34;</span>,
</span></span><span style="display:flex;"><span>                  isBlessed = <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>                  name = <span style="color:#e6db74">&#34;Mandrigal&#34;</span>,
</span></span><span style="display:flex;"><span>                  healthStatus = status)
</span></span></code></pre></div><p>This optional syntax uses a <em>named function arguments</em> and is an alternative way to provide arguments to a function. Using named arguments frees you to pass the argument to the function in whatever order you would like. For example, you could also call *printPlayerStatus like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>printPlayerStatus(healthStatus = status,
</span></span><span style="display:flex;"><span>                  auraColor = <span style="color:#e6db74">&#34;NONE&#34;</span>,
</span></span><span style="display:flex;"><span>                  name = <span style="color:#e6db74">&#34;Mandrigal&#34;</span>,
</span></span><span style="display:flex;"><span>                  isBlessed = <span style="color:#66d9ef">true</span>)
</span></span></code></pre></div><h1 id="5-anonymous-functions-and-the-function-type">5. Anonymous Functions and the Function Type</h1>
<p>Functions defined without a name, called <em>anonymous functions</em>, are similar, with two major differences: Anonymous functions have no name as part of their definition, an they interact with the rest of your code a little different in that they are commonly passed to or returned from other functions.</p>
<h2 id="anonymous-functions">Anonymous Functions</h2>
<p>An anonymous function lets you describe additional rules for a standar library function so that you can customize its behavior.</p>
<p>One of meny functions in teh standard library is <strong>count</strong>. When called on a string, <strong>count</strong> return the total number of letters in the string. The following code counts the letters in the string &ldquo;Mississippi&rdquo;</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> numLetters = <span style="color:#e6db74">&#34;Mississippi&#34;</span>.count()
</span></span><span style="display:flex;"><span>println(numLetters)
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Prints 11
</span></span></span></code></pre></div><p>But what if you wanted to count only a specific character in &ldquo;Mississippi, say the letter &ldquo;s&rdquo;. the kotlin standard library allows you to provide rules to the <strong>count</strong> function to determine whether a letter should be counted. You describe the rules for the function by providing an anonymous function as an argument:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> numLetters = <span style="color:#e6db74">&#34;Mississippi&#34;</span>.count({ letter <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>    letter <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;s&#39;</span>
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>println(numLetters)
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Prints 4
</span></span></span></code></pre></div><h3 id="listing-51-defining-an-anonymous-greeting-function-simvillagekt">Listing 5.1 Defining an anonymous greeting function (SimVillage.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    println({
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> currentYear = <span style="color:#ae81ff">2018</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Welcome to SimVillage, Mayor! (copyright </span><span style="color:#e6db74">$currentYear</span><span style="color:#e6db74">)&#34;</span>
</span></span><span style="display:flex;"><span>    }())
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Outside the anonymous function&rsquo;s closing brace, you call function with a pair of empty parentheses.</p>
<h2 id="the-function-type">The function type</h2>
<p>Anonymous functions also have a type, called the <strong>function type</strong>. Variables of the function type can hold an anonymous function as their value, and the function can then be passed around your code like any other variable.</p>
<h3 id="listing-52-assigning-the-anonymous-function-to-a-variable-simvillagekt">Listing 5.2 Assigning the anonymous function to a variable (SimVillage.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>&lt;&lt;  println({
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> greetingFunction: () <span style="color:#f92672">-&gt;</span> String = {
</span></span><span style="display:flex;"><span>&gt;&gt;      <span style="color:#66d9ef">val</span> currentYear = <span style="color:#ae81ff">2018</span>
</span></span><span style="display:flex;"><span>&gt;&gt;      <span style="color:#e6db74">&#34;Welcome to SimVillage, Mayor! (copyright </span><span style="color:#e6db74">$currentYear</span><span style="color:#e6db74">)&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;  }
</span></span><span style="display:flex;"><span>&lt;&lt;  })()
</span></span><span style="display:flex;"><span>    println(greetingFunction())
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="figure-51-function-type-sintaxis">Figure 5.1 Function type sintaxis</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">greetingFunction</span>():   String
</span></span><span style="display:flex;"><span>                        v       v
</span></span><span style="display:flex;"><span>                        () <span style="color:#f92672">-&gt;</span> String
</span></span></code></pre></div><p>A function type definition consists of two parts: the function&rsquo;s parameters, in parentheses, followed by its return type, delimited by the arrow (-&gt;), as show in Figure 5.1</p>
<h2 id="implicit-returns">Implicit returns</h2>
<p>Maybe you have noticed that there is no return keyword within the anonymous function you defined:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> greeetingFunction: () <span style="color:#f92672">-&gt;</span> String = {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> currentYear = <span style="color:#ae81ff">2018</span>
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Welcome to SimVillage, Mayor (copyrigth </span><span style="color:#e6db74">$currentYear</span><span style="color:#e6db74">)&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><h2 id="function-arguments">Function arguments</h2>
<p>Like a named function, an anonymous function can accept zero, one or multiple argument of any type. The parameters an anonymous function accepts are indicated by type in the function type definition and then named in the anonymous functions&rsquo;s definition.</p>
<h3 id="listing53-adding-a-playername-parameter-to-the-anonymous-function-simvillagekt">Listing5.3 Adding a playerName parameter to the anonymous function (SimVillage.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">val</span> greetingFunction: () <span style="color:#f92672">-&gt;</span> String = {
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> greetingFunction: (String) <span style="color:#f92672">-&gt;</span> String = { playerName <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> currentYear = <span style="color:#ae81ff">2018</span>
</span></span><span style="display:flex;"><span>&lt;&lt;      <span style="color:#e6db74">&#34;Welcome to SimVillage, Mayor! (copyright </span><span style="color:#e6db74">$currentYear</span><span style="color:#e6db74">)&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;      <span style="color:#e6db74">&#34;Welcome to SimVillage, </span><span style="color:#e6db74">$playerName</span><span style="color:#e6db74">! (copyright </span><span style="color:#e6db74">$currentYear</span><span style="color:#e6db74">)&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>&lt;&lt;  println(greetingFunction())
</span></span><span style="display:flex;"><span>&gt;&gt;  println(greetingFunction(<span style="color:#e6db74">&#34;Guyal&#34;</span>))
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="the-it-keyword">The it keyword</h2>
<p>When defining anonymous functions that accept exactly one argument, the it keyword is available as a convenient alternative to specifying the parameter name.</p>
<h3 id="listing-54-using-the-it-keyword-simvillagekt">Listing 5.4 Using the it keyword (SimVillage.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">val</span> greetingFunction: (String) <span style="color:#f92672">-&gt;</span> String = { playerName <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> greetingFunction: (String) <span style="color:#f92672">-&gt;</span> String = {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> currentYear = <span style="color:#ae81ff">2018</span>
</span></span><span style="display:flex;"><span>&lt;&lt;      <span style="color:#e6db74">&#34;Welcome to SimVillage, </span><span style="color:#e6db74">$playerName</span><span style="color:#e6db74">! (copyright </span><span style="color:#e6db74">$currentYear</span><span style="color:#e6db74">)&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;      <span style="color:#e6db74">&#34;Welcome to SimVillage, </span><span style="color:#e6db74">$it</span><span style="color:#e6db74">! (copyright </span><span style="color:#e6db74">$currentYear</span><span style="color:#e6db74">)&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    println(greetingFunction(<span style="color:#e6db74">&#34;Guyal&#34;</span>))
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="acceptig-multiple-arguments">Acceptig multiple arguments</h2>
<p>While the <em>it</em> syntaxis is available for an anonymous function that accept one argument, it is not allowed when there is more than one argument, However, anonymous functions can certainly accept multiplen named arguments.</p>
<h3 id="listing-55-accepting-a-second-argument-simvillagekt">Listing 5.5 Accepting a second argument (SimVillage.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">val</span> greetingFunction: (String) <span style="color:#f92672">-&gt;</span> String = {
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> greetingFunction: (String, Int) <span style="color:#f92672">-&gt;</span> String = { playerName, numBuildings <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> currentYear = <span style="color:#ae81ff">2018</span>
</span></span><span style="display:flex;"><span>&gt;&gt;      println(<span style="color:#e6db74">&#34;Adding </span><span style="color:#e6db74">$numBuildings</span><span style="color:#e6db74"> houses&#34;</span>)
</span></span><span style="display:flex;"><span>&lt;&lt;      <span style="color:#e6db74">&#34;Welcome to SimVillage, </span><span style="color:#e6db74">$it</span><span style="color:#e6db74">! (copyright </span><span style="color:#e6db74">$currentYear</span><span style="color:#e6db74">)&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;      <span style="color:#e6db74">&#34;Welcome to SimVillage, </span><span style="color:#e6db74">$playerName</span><span style="color:#e6db74">! (copyright </span><span style="color:#e6db74">$currentYear</span><span style="color:#e6db74">)&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>&lt;&lt;  println(greetingFunction(<span style="color:#e6db74">&#34;Guyal&#34;</span>))
</span></span><span style="display:flex;"><span>&gt;&gt;  println(greetingFunction(<span style="color:#e6db74">&#34;Guyal&#34;</span>, <span style="color:#ae81ff">2</span>))
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="type-inference-support">Type inference Support</h2>
<p>Kotlin&rsquo;s type inference rules behave exactly the same with function types as they do with the types you met earlier in thie book: If a variabe is given an anonymous function as its value when it is declared no explicit tyoe definition is needed.</p>
<h3 id="listing-56-using-type-inference-for-greetingfunction-simvillagekt">Listing 5.6 Using type inference for greetingFunction (SimVillage.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">val</span> greetingFunction: (String, Int) <span style="color:#f92672">-&gt;</span> String = { playerName, numBuildings <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> greetingFunction = { playerName: String, numBuildings: Int <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> currentYear = <span style="color:#ae81ff">2018</span>
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;Adding </span><span style="color:#e6db74">$numBuildings</span><span style="color:#e6db74"> houses&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Welcome to SimVillage, </span><span style="color:#e6db74">$playerName</span><span style="color:#e6db74">! (copyright </span><span style="color:#e6db74">$currentYear</span><span style="color:#e6db74">)&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    println(greetingFunction(<span style="color:#e6db74">&#34;Guyal&#34;</span>, <span style="color:#ae81ff">2</span>))
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="defining-a-function-that-accpets-a-function">Defining a Function that accpets a function</h2>
<p>The book refers to anonymous functions as lambdas and their definitions as lambda expressions.</p>
<h3 id="listing-57-adding-the-runsimulation-function-simvillagekt">Listing 5.7 Adding the runSimulation function (SimVillage.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> greetingFunction = { playerName: String, numBuildings: Int <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> currentYear = <span style="color:#ae81ff">2018</span>
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;Adding </span><span style="color:#e6db74">$numBuildings</span><span style="color:#e6db74"> houses&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Welcome to SimVillage, </span><span style="color:#e6db74">$playerName</span><span style="color:#e6db74">! (copyright </span><span style="color:#e6db74">$currentYear</span><span style="color:#e6db74">)&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>&lt;&lt;  println(greetingFunction(<span style="color:#e6db74">&#34;Guyal&#34;</span>, <span style="color:#ae81ff">2</span>))
</span></span><span style="display:flex;"><span>&gt;&gt;  runSimulation(<span style="color:#e6db74">&#34;Guyal&#34;</span>, greetingFunction)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">runSimulation</span>(playerName: String, greetingFunction: (String, Int) <span style="color:#f92672">-&gt;</span> String) {
</span></span><span style="display:flex;"><span>&gt;&gt;      <span style="color:#66d9ef">val</span> numBuildings = (<span style="color:#ae81ff">1.</span>.<span style="color:#ae81ff">3</span>).shuffled().last()   <span style="color:#75715e">// Randomly selects 1, 2, or 3
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>&gt;&gt;      println(greetingFunction(playerName, numBuildings))
</span></span><span style="display:flex;"><span>&gt;&gt;  }
</span></span></code></pre></div><h2 id="shorthand-syntaxis">Shorthand syntaxis</h2>
<p>When a function accepts a function type for its last parameter, you can also aomit the parenthesesaroung the lambda argument.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#e6db74">&#34;Mississippi&#34;</span>.count({<span style="color:#66d9ef">it</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;s&#39;</span>})
</span></span></code></pre></div><p>Can also written this way</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#e6db74">&#34;Mississippi&#34;</span>.count {<span style="color:#66d9ef">it</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;s&#39;</span>}
</span></span></code></pre></div><h3 id="listing-58-passing-a-lambda-with-the-shorthand-syntax-simvillagekt">Listing 5.8 Passing a lambda with the shorthand syntax (SimVillage.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">val</span> greetingFunction = { playerName: String, numBuildings: Int <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;  runSimulation(<span style="color:#e6db74">&#34;Guyal&#34;</span>) { playerName, numBuildings <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> currentYear = <span style="color:#ae81ff">2018</span>
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;Adding </span><span style="color:#e6db74">$numBuildings</span><span style="color:#e6db74"> houses&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Welcome to SimVillage, </span><span style="color:#e6db74">$playerName</span><span style="color:#e6db74">! (copyright </span><span style="color:#e6db74">$currentYear</span><span style="color:#e6db74">)&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">runSimulation</span>(playerName: String, greetingFunction: (String, Int) <span style="color:#f92672">-&gt;</span> String) {
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">val</span> numBuildings = (<span style="color:#ae81ff">1.</span>.<span style="color:#ae81ff">3</span>).shuffled().last()   <span style="color:#75715e">// Randomly selects 1, 2, or 3
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>   println(greetingFunction(playerName, numBuildings))
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="function-inlining">Function Inlining</h2>
<p>Lambda are useful because they enable a high degree of felxibility in how your programs can be written. However, that flexibility comes at a cost.</p>
<p>When you define a lambda, it is represented as an object instancce on the JVM. The JVM alse performs memory allocations for all variables accesible to the lambda, and this behavior comes with associated memory costs. As a result, lambdas introduce memory overhead that can in turn cause a performance impact - and such performance impacts are to be avoided.</p>
<p>The inline a lambda, you mark the function that accpets the lambda using the <em>inline</em> keyword.</p>
<h3 id="listing59-using-the-inline-keyword-simvillagekt">Listing5.9 Using the inline keyword (SimVillage.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">inline</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">runSimulation</span>(playerName: String,
</span></span><span style="display:flex;"><span>                         greetingFunction: (String, Int) <span style="color:#f92672">-&gt;</span> String) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> numBuildings = (<span style="color:#ae81ff">1.</span>.<span style="color:#ae81ff">3</span>).shuffled().last()   <span style="color:#75715e">// Randomly selects 1, 2, or 3
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    println(greetingFunction(playerName, numBuildings))
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="function-references">Function References</h2>
<p>So far, you have defined lambdas to provide a function as an argument to another function. There is another way to do so: by passing a â€”function reference_. A function reference converts a named function (a function defined using the fun keyword) to a value that can be passed as an argument. Tou can use a function reference anywhere you use a lamnda expresion.</p>
<h3 id="listing-510-defining-the-printconstructioncost-function-simvillagekt">Listing 5.10 Defining the printConstructionCost function (SimVillage.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">inline</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">runSimulation</span>(playerName: String,
</span></span><span style="display:flex;"><span>                        greetingFunction: (String, Int) <span style="color:#f92672">-&gt;</span> String) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> numBuildings = (<span style="color:#ae81ff">1.</span>.<span style="color:#ae81ff">3</span>).shuffled().last()   <span style="color:#75715e">// Randomly selects 1, 2, or 3
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    println(greetingFunction(playerName, numBuildings))
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">printConstructionCost</span>(numBuildings: Int) {
</span></span><span style="display:flex;"><span>&gt;&gt;      <span style="color:#66d9ef">val</span> cost = <span style="color:#ae81ff">500</span>
</span></span><span style="display:flex;"><span>&gt;&gt;      println(<span style="color:#e6db74">&#34;construction cost: </span><span style="color:#e6db74">${cost * numBuildings}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  }
</span></span></code></pre></div><h3 id="listing-511-adding-a-costprinter-parameter-simvillagekt">Listing 5.11 Adding a costPrinter parameter (SimVillage.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">inline</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">runSimulation</span>(playerName: String,
</span></span><span style="display:flex;"><span>&lt;&lt;                           greetingFunction: (String, Int) <span style="color:#f92672">-&gt;</span> String) {
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">inline</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">runSimulation</span>(playerName: String,
</span></span><span style="display:flex;"><span>&gt;&gt;                           costPrinter: (Int) <span style="color:#f92672">-&gt;</span> Unit,
</span></span><span style="display:flex;"><span>                             greetingFunction: (String, Int) <span style="color:#f92672">-&gt;</span> String) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> numBuildings = (<span style="color:#ae81ff">1.</span>.<span style="color:#ae81ff">3</span>).shuffled().last()   <span style="color:#75715e">// Randomly selects 1, 2, or 3
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        costPrinter(numBuildings)
</span></span><span style="display:flex;"><span>        println(greetingFunction(playerName, numBuildings))
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">printConstructionCost</span>(numBuildings: Int) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> cost = <span style="color:#ae81ff">500</span>
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;construction cost: </span><span style="color:#e6db74">${cost * numBuildings}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>to obtain a function reference, you use the :: operator with the function name you would like a reference for.</p>
<h3 id="listing-512-passing-a-function-reference-simvillagekt">Listing 5.12 Passing a function reference (SimVillage.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>&lt;&lt;  runSimulation(<span style="color:#e6db74">&#34;Guyal&#34;</span>) { playerName, numBuildings <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;  runSimulation(<span style="color:#e6db74">&#34;Guyal&#34;</span>, <span style="color:#f92672">::</span>printConstructionCost) { playerName, numBuildings <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> currentYear = <span style="color:#ae81ff">2018</span>
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;Adding </span><span style="color:#e6db74">$numBuildings</span><span style="color:#e6db74"> houses&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Welcome to SimVillage, </span><span style="color:#e6db74">$playerName</span><span style="color:#e6db74">! (copyright </span><span style="color:#e6db74">$currentYear</span><span style="color:#e6db74">)&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><h2 id="function-type-as-return-type">Function Type as return type</h2>
<p>Like any other type, the function type is also a valid return type, meaning you can define a function that returns a function</p>
<h3 id="listing513-adding-the-configuregreetingfunction-function-simvillagekt">Listing5.13 Adding the configureGreetingFunction function (SimVillage.kt)</h3>
<pre tabindex="0"><code class="language-kotling" data-lang="kotling">fun main(args: Array&lt;String&gt;) {
&lt;&lt;  runSimulation(&#34;Guyal&#34;, ::printContructionCost) { playerName, numBuildings -&gt;
&lt;&lt;      val currentYear = 2018
&lt;&lt;      println(&#34;Adding $numBuildings houses&#34;)
&lt;&lt;      &#34;Welcome to SimVillage, $playerName! (copyright $currentYear)&#34;
&lt;&lt;  }
&gt;&gt;  runSimulation()
}

&lt;&lt;inline fun runSimulation(playerName: String,
&lt;&lt;                        costPrinter: (Int) -&gt; Unit,
&lt;&lt;                        greetingFunction: (String, Int) -&gt; String) {
&lt;&lt;    val numBuildings = (1..3).shuffled().last()   // Randomly selects 1, 2, or 3
&lt;&lt;    costPrinter(numBuildings)
&lt;&lt;    println(greetingFunction(playerName, numBuildings))
&gt;&gt;fun runSimulation() {
&gt;&gt;    val greetingFunction = configureGreetingFunction()
&gt;&gt;    println(greetingFunction(&#34;Guyal&#34;))
}

&gt;&gt;fun configureGreetingFunction(): (String) -&gt; String {
&gt;&gt;    val structureType = &#34;hospitals&#34;
&gt;&gt;    var numBuildings = 5
&gt;&gt;    return { playerName: String -&gt;
&gt;&gt;        val currentYear = 2018
&gt;&gt;        numBuildings += 1
&gt;&gt;        println(&#34;Adding $numBuildings $structureType&#34;)
&gt;&gt;        &#34;Welcome to SimVillage, $playerName! (copyright $currentYear)&#34;
&gt;&gt;    }
&gt;&gt;}
</code></pre><h1 id="6-null-safety-and-exceptions">6. Null safety and exceptions</h1>
<p>Null is a especial value that indicates that the value of a var does not exists</p>
<h2 id="nullability">Nullability</h2>
<p>Some elements in Kotlin can be assigned a value of null, and some cannot. We say thta the former are <em>nullable</em> and the latter are <em>non-nullable</em></p>
<h3 id="listing-61-reassigning-a-vars-value-to-null-tavernkt">Listing 6.1 Reassigning a varâ€™s value to null (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> signatureDrink = <span style="color:#e6db74">&#34;Buttered Ale&#34;</span>
</span></span><span style="display:flex;"><span>    signatureDrink = <span style="color:#66d9ef">null</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Null can not be a value of a non-null type String</p>
<h2 id="kotlins-explicit-null-type">Kotlin&rsquo;s Explicit null type</h2>
<p>NullPointerExceptions like the one that you say above should be avoided ata ll costs.</p>
<h3 id="listing-62-defining-a-nullable-variable-tavernkt">Listing 6.2 Defining a nullable variable (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">var</span> signatureDrink = <span style="color:#e6db74">&#34;Buttered Ale&#34;</span>
</span></span><span style="display:flex;"><span>&lt;&lt;  signatureDrink = <span style="color:#66d9ef">null</span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">var</span> beverage = readLine()
</span></span><span style="display:flex;"><span>&gt;&gt;  println(beverage)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>This means that assigning beverage to a null value will indeed compile</p>
<h3 id="listing-63-reassigning-a-variable-to-null-tavernkt">Listing 6.3 Reassigning a variable to null (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> beverage = readLine()
</span></span><span style="display:flex;"><span>&gt;&gt;  beverage = <span style="color:#66d9ef">null</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    println(beverage)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-64-restoring-service-tavernkt">Listing 6.4 Restoring service (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> beverage = readLine()
</span></span><span style="display:flex;"><span>&lt;&lt;  beverage = <span style="color:#66d9ef">null</span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#75715e">// beverage = null
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    println(beverage)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="compile-time-vs-runtime">Compile Time vs Runtime</h2>
<p>Kotlin is a <em>compiler language</em>, meaning that your program is translated into machine-language instructions prior to execution by a special program, called the compiler. During this step, the compiler ensures that certain requirements are met by you code before the instructions are generated</p>
<p>Errors caught at compiler time are called <em>compile-time errors</em>, and they are one of the adventages of working with kotlin.</p>
<p>On the other hand, a <em>runtime error</em> us a mistake that happends after the program has compiled and is already running, because the compuler was unable to dicovery it.</p>
<h2 id="null-safety">Null Safety</h2>
<p>Because Kotlin distinguishes between multiple nullable and non-nullable types, the compiler is aware of the possibly dangerous situation of asking a variable defined as a nullable type to do something when the variable might not exists.</p>
<h3 id="listing-65-using-a-nullable-variable-tavernkt">Listing 6.5 Using a nullable variable (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">var</span> beverage = readLine()
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">var</span> beverage = readLine().capitalize()
</span></span><span style="display:flex;"><span><span style="color:#75715e">//   beverage = null
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    println(beverage)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="option-one-the-safe-call-operator">Option one: the safe call operator</h2>
<p>Sometimes, nothing but a nullable type will do. For example, when you are working with a variable from code you do not control, you cannot be sure that it eill not return null. In cases like that, your first option is to use the <em>safe call operator</em> <strong>(?.)</strong> in your function call.</p>
<h3 id="listing-66-using-the-safe-call-operator-tavernkt">Listing 6.6 Using the safe call operator (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">var</span> beverage = readLine().capitalize()
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">var</span> beverage = readLine()<span style="color:#f92672">?.</span>capitalize()
</span></span><span style="display:flex;"><span><span style="color:#75715e">//   beverage = null
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    println(beverage)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="using-safe-calls-with-let">Using safe calls with let</h2>
<p><strong>Let</strong> provides its own function scope, you can use a safe call with <strong>let</strong> to scope multiple expressions that each require the variable that they are called on to be non-null.</p>
<h3 id="listing-67-using-__let__-with-the-safe-call-operatortavernkt">Listing 6.7 Using <strong>let</strong> with the safe call operator(Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">var</span> beverage = readLine()<span style="color:#f92672">?.</span>capitalize()
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">var</span> beverage = readLine()<span style="color:#f92672">?.</span>let {
</span></span><span style="display:flex;"><span>&gt;&gt;      <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">it</span>.isNotBlank()) {
</span></span><span style="display:flex;"><span>&gt;&gt;          <span style="color:#66d9ef">it</span>.capitalize()
</span></span><span style="display:flex;"><span>&gt;&gt;      } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>&gt;&gt;          <span style="color:#e6db74">&#34;Buttered Ale&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;      }
</span></span><span style="display:flex;"><span>&gt;&gt;  }
</span></span><span style="display:flex;"><span><span style="color:#75715e">//  beverage = null
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>println(beverag
</span></span></code></pre></div><p>This time you assign its value to the result of safely calling let on it. When bevereage is not null and <strong>let</strong> is invoked, everything withit the anonymous function passed to <strong>let</strong> is evaluated: The input from <strong>readline</strong> is checkef to see whether it is blank; if it is not blank it is capitalized, and if it is blank, then a fallback beverage name, &ldquo;Buttered Ale&rdquo;, is returned instead. Both <strong>isNotBlank</strong>  and <strong>capitalize</strong> require the beverage name to be non-null, which is guaranteed by <strong>let</strong></p>
<h2 id="option-two-the-double-bang-operator">Option two: the double-bang operator</h2>
<p>The double-bang operator (!!.) can be used to call a function on a nullable type . But be forewarned. This is a much drastic option than the safe call operator and should generally not be used. If you use !!., you are proclaming tot he compiler: &ldquo;If I ask nonexistent thing to do something, I DEMAND that you throw a null pointer exception!!&rdquo;</p>
<p>By the way, its official name is the <em>non-null assertion operator</em>, but is more often called the double-bang operator.</p>
<h3 id="listing-68-using-the-double-bang-operator-tavernkt">Listing 6.8 Using the double-bang operator (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">var</span> beverage = readLine()<span style="color:#f92672">?.</span>let {
</span></span><span style="display:flex;"><span>&lt;&lt;      <span style="color:#66d9ef">if</span> (<span style="color:#66d9ef">it</span>.isNotBlank()) {
</span></span><span style="display:flex;"><span>&lt;&lt;          <span style="color:#66d9ef">it</span>.capitalize()
</span></span><span style="display:flex;"><span>&lt;&lt;      } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>&lt;&lt;          <span style="color:#e6db74">&#34;Buttered Ale&#34;</span>
</span></span><span style="display:flex;"><span>&lt;&lt;      }
</span></span><span style="display:flex;"><span>&lt;&lt;  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">var</span> beverage = readLine()<span style="color:#f92672">!!</span>.capitalize()
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// beverage = null
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    println(beverage)
</span></span></code></pre></div><p>I don&rsquo;t care whether beverage is null; capitalize it anyway!. If beverage is indeed null, a KotlinNullPointerException us thrown.</p>
<h2 id="option-three-checking-whether-a-value-is-null-with-if">Option three: checking whether a value is null with if</h2>
<p>A third option for working safely with null values is to check whether a value is null a condition for executing an <strong>if</strong> branch</p>
<h3 id="listing-69-using--null-for-null-checking-tavernkt">Listing 6.9 Using != null for null checking (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">var</span> beverage = readLine()<span style="color:#f92672">!!</span>.capitalize()
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">var</span> beverage = readLine()
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// beverage = null
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>&gt;&gt;  <span style="color:#66d9ef">if</span> (beverage <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>&gt;&gt;      beverage = beverage.capitalize()
</span></span><span style="display:flex;"><span>&gt;&gt;  } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>&gt;&gt;      println(<span style="color:#e6db74">&#34;I can&#39;t do that without crashing - beverage was null!&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    println(beverage)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="the-null-coalescing-operator">The null coalescing operator</h2>
<p>Another way to check for null values is to use kotlin&rsquo;s <em>null coalescing operator</em> <strong>?:</strong> also know as the &ldquo;Elvis operator&rdquo;. this operator says: &ldquo;If the thing on the lefthand side of me is null, do the thing on the righthand side instead&rdquo;.</p>
<h3 id="listing-610-using-the-null-coalescing-operator-tavernkt">Listing 6.10 Using the null coalescing operator (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> beverage = readLine()
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// beverage = null
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> (beverage <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>        beverage = beverage.capitalize()
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;I can&#39;t do that without crashing - beverage was null!&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;&lt;  println(beverage)
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> beverageServed: String = beverage <span style="color:#f92672">?:</span> <span style="color:#e6db74">&#34;Buttered Ale&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;  println(beverageServed)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="exceptions">Exceptions</h2>
<p>Like many others languages, kotlin laso includes <em>exceptions</em> to indicate that something went wrong in you program</p>
<h3 id="listing-611-adding-sword-juggling-logic-swordjugglerkt">Listing 6.11 Adding sword juggling logic (SwordJuggler.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> swordsJuggling: Int? = <span style="color:#66d9ef">null</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> isJugglingProficient = (<span style="color:#ae81ff">1.</span>.<span style="color:#ae81ff">3</span>).shuffled().last() <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (isJugglingProficient) {
</span></span><span style="display:flex;"><span>        swordsJuggling = <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;You juggle </span><span style="color:#e6db74">$swordsJuggling</span><span style="color:#e6db74"> swords!&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-612-adding-a-third-sword-swordjugglerkt">Listing 6.12 Adding a third sword (SwordJuggler.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> swordsJuggling: Int? = <span style="color:#66d9ef">null</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> isJugglingProficient = (<span style="color:#ae81ff">1.</span>.<span style="color:#ae81ff">3</span>).shuffled().last() <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (isJugglingProficient) {
</span></span><span style="display:flex;"><span>        swordsJuggling = <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    swordsJuggling = swordsJuggling<span style="color:#f92672">!!</span>.plus(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;You juggle </span><span style="color:#e6db74">$swordsJuggling</span><span style="color:#e6db74"> swords!&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="throwing-an-exception">Throwing an exception</h2>
<p>Similar to many languages, Kotlin allows you to manually signal that an exception has occurred, you do this with the <em>throw</em> operator and it is calle throwing an exception.</p>
<h3 id="listing613-throwing-an-illegalstateexceptionswordjugglerkt">Listing6.13 Throwing an IllegalStateException(SwordJuggler.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> swordsJuggling: Int? = <span style="color:#66d9ef">null</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> isJugglingProficient = (<span style="color:#ae81ff">1.</span>.<span style="color:#ae81ff">3</span>).shuffled().last() <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (isJugglingProficient) {
</span></span><span style="display:flex;"><span>        swordsJuggling = <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>&gt;&gt;  proficiencyCheck(swordsJuggling)
</span></span><span style="display:flex;"><span>    swordsJuggling = swordsJuggling<span style="color:#f92672">!!</span>.plus(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;You juggle </span><span style="color:#e6db74">$swordsJuggling</span><span style="color:#e6db74"> swords!&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">proficiencyCheck</span>(swordsJuggling: Int?) {
</span></span><span style="display:flex;"><span>&gt;&gt;      swordsJuggling <span style="color:#f92672">?:</span> <span style="color:#66d9ef">throw</span> IllegalStateException(<span style="color:#e6db74">&#34;Player cannot juggle swords&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  }
</span></span></code></pre></div><h2 id="custom-exceptions">Custom exceptions</h2>
<p>You have now seen how to use the throw operator  to signal that an exception has occurred. The exception you just threw, IllegalStateException, indicates that an illegal state has ocurres and gives  you the opportunity to add more information by passing a string to be printed when the exception is thrown.</p>
<h3 id="listing-614-defining-a-custom-exception-swordjugglerkt">Listing 6.14 Defining a custom exception (SwordJuggler.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>  <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">proficiencyCheck</span>(swordsJuggling: Int?) {
</span></span><span style="display:flex;"><span>      swordsJuggling <span style="color:#f92672">?:</span> <span style="color:#66d9ef">throw</span> IllegalStateException(<span style="color:#e6db74">&#34;Player cannot juggle swords&#34;</span>)
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt; <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UnskilledSwordJugglerException</span>() :
</span></span><span style="display:flex;"><span>&gt;&gt;         IllegalStateException(<span style="color:#e6db74">&#34;Player cannot juggle swords&#34;</span>)
</span></span></code></pre></div><h3 id="listing-615-throwing-a-custom-exception-swordjugglerkt">Listing 6.15 Throwing a custom exception (SwordJuggler.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">proficiencyCheck</span>(swordsJuggling: Int?) {
</span></span><span style="display:flex;"><span>&lt;&lt;      swordsJuggling <span style="color:#f92672">?:</span> <span style="color:#66d9ef">throw</span> IllegalStateException(<span style="color:#e6db74">&#34;Player cannot juggle swords&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;      swordsJuggling <span style="color:#f92672">?:</span> <span style="color:#66d9ef">throw</span> UnskilledSwordJugglerException()
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UnskilledSwordJugglerException</span>() :
</span></span><span style="display:flex;"><span>        IllegalStateException(<span style="color:#e6db74">&#34;Player cannot juggle swords&#34;</span>)
</span></span></code></pre></div><h2 id="handling-exceptions">Handling exceptions</h2>
<p>Exceptions are disruptive, and they should by - they represent a state that ud unrecoverable unless ut is handled. Kotlin allows you to specify how to handle exceptions by defining a <em>try/catch</em> statement arounf the code that might cause one.</p>
<h3 id="listing616-addingatrycatchstatementswordjugglerkt">Listing6.16 Addingatry/catchstatement(SwordJuggler.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> swordsJuggling: Int? = <span style="color:#66d9ef">null</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> isJugglingProficient = (<span style="color:#ae81ff">1.</span>.<span style="color:#ae81ff">3</span>).shuffled().last() <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (isJugglingProficient) {
</span></span><span style="display:flex;"><span>        swordsJuggling = <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>&gt;&gt;      proficiencyCheck(swordsJuggling)
</span></span><span style="display:flex;"><span>&gt;&gt;      swordsJuggling = swordsJuggling<span style="color:#f92672">!!</span>.plus(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  } <span style="color:#66d9ef">catch</span> (e: Exception) {
</span></span><span style="display:flex;"><span>&gt;&gt;      println(e)
</span></span><span style="display:flex;"><span>&gt;&gt;  }
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;You juggle </span><span style="color:#e6db74">$swordsJuggling</span><span style="color:#e6db74"> swords!&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">proficiencyCheck</span>(swordsJuggling: Int?) {
</span></span><span style="display:flex;"><span>    swordsJuggling <span style="color:#f92672">?:</span> <span style="color:#66d9ef">throw</span> UnskilledSwordJugglerException()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UnskilledSwordJugglerException</span>() :
</span></span><span style="display:flex;"><span>        IllegalStateException(<span style="color:#e6db74">&#34;Player cannot juggle swords&#34;</span>)
</span></span></code></pre></div><h2 id="preconditions">Preconditions</h2>
<p>Unexpected values can cause your program to behave in unintended way. As a developer, you will spend plenty of time validating input to endure you are working with the calues you intend. some sources of exceptions are common, like unexpected null values.</p>
<p>These functions are called <em>precondition functions</em>, because they allow you to define preconditions - conditions that must be true before some piece of code is executed.</p>
<h3 id="listing-617-using-a-precondition-function-swordjugglerkt">Listing 6.17 Using a precondition function (SwordJuggler.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> swordsJuggling: Int? = <span style="color:#66d9ef">null</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> isJugglingProficient = (<span style="color:#ae81ff">1.</span>.<span style="color:#ae81ff">3</span>).shuffled().last() <span style="color:#f92672">==</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (isJugglingProficient) {
</span></span><span style="display:flex;"><span>        swordsJuggling = <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>        proficiencyCheck(swordsJuggling)
</span></span><span style="display:flex;"><span>        swordsJuggling = swordsJuggling<span style="color:#f92672">!!</span>.plus(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> (e: Exception) {
</span></span><span style="display:flex;"><span>        println(e)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;You juggle </span><span style="color:#e6db74">$swordsJuggling</span><span style="color:#e6db74"> swords!&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">proficiencyCheck</span>(swordsJuggling: Int?) {
</span></span><span style="display:flex;"><span>&lt;&lt;  swordsJuggling <span style="color:#f92672">?:</span> <span style="color:#66d9ef">throw</span> UnskilledSwordJugglerException()
</span></span><span style="display:flex;"><span>&gt;&gt;  checkNotNull(swordsJuggling, { <span style="color:#e6db74">&#34;Player cannot juggle swords&#34;</span> })
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">UnskilledSwordJugglerException</span>() :
</span></span><span style="display:flex;"><span>        IllegalStateException(<span style="color:#e6db74">&#34;Player cannot juggle swords&#34;</span>)
</span></span></code></pre></div><p>Table 6.1 Kotlin precondition functions</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>checkNotNull</td>
<td>Throws an IllegalStateException if argument is null, Otherwise return the non-null value.</td>
</tr>
<tr>
<td>require</td>
<td>Throw as IllegalArgumentException if argument is false.</td>
</tr>
<tr>
<td>requireNotNull</td>
<td>Throws an IllegalArgumentException if argument is null, Otherwise returns the non-null value.</td>
</tr>
<tr>
<td>error</td>
<td>Throw an IllegalArgumentException with a provided message if argument is null,. Otherwise return the non-null value.</td>
</tr>
<tr>
<td>assert</td>
<td>Throws an AssertionError if argument is false and the assertion compiler flag is enabled</td>
</tr>
</tbody>
</table>
<h1 id="7-strings">7. Strings</h1>
<p>In programming, textual data is represented by <em>strings</em> -ordered sequences of characteres.</p>
<h2 id="extracting-substrings">Extracting Substrings</h2>
<h3 id="substrings">Substrings</h3>
<h3 id="listing-71-extracting-the-tavern-masters-name-tavernkt">Listing 7.1 Extracting the tavern masterâ€™s name (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">val</span> TAVERN_NAME = <span style="color:#e6db74">&#34;Taernyl&#39;s Folly&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">var</span> beverage = readLine()
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#75715e">// beverage = null
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>&lt;&lt;  <span style="color:#66d9ef">if</span> (beverage <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>&lt;&lt;      beverage = beverage.capitalize()
</span></span><span style="display:flex;"><span>&lt;&lt;  } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>&lt;&lt;      println(<span style="color:#e6db74">&#34;I can&#39;t do that without crashing - beverage was null!&#34;</span>)
</span></span><span style="display:flex;"><span>&lt;&lt;  }
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">val</span> beverageServed: String = beverage <span style="color:#f92672">?:</span> <span style="color:#e6db74">&#34;Buttered Ale&#34;</span>
</span></span><span style="display:flex;"><span>&lt;&lt;  println(beverageServed)
</span></span><span style="display:flex;"><span>    placeOrder()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">placeOrder</span>() {
</span></span><span style="display:flex;"><span>&gt;&gt;     <span style="color:#66d9ef">val</span> indexOfApostrophe = <span style="color:#a6e22e">TAVERN_NAME</span>.indexOf(<span style="color:#e6db74">&#39;\&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;     <span style="color:#66d9ef">val</span> tavernMaster = <span style="color:#a6e22e">TAVERN_NAME</span>.substring(<span style="color:#ae81ff">0</span> until indexOfApostrophe)
</span></span><span style="display:flex;"><span>&gt;&gt;     println(<span style="color:#e6db74">&#34;Madrigal speaks with </span><span style="color:#e6db74">$tavernMaster</span><span style="color:#e6db74"> about their order.&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  }
</span></span></code></pre></div><p>The list of sdiferents escapes sequences (consisting of \ abd the character being escaped) and their meaning to the compiler.</p>
<h3 id="table-71-escape-sequences">Table 7.1 Escape sequences</h3>
<table>
<thead>
<tr>
<th>Escape sequence</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>\t</td>
<td>Tab character</td>
</tr>
<tr>
<td>\b</td>
<td>Backspace character</td>
</tr>
<tr>
<td>\n</td>
<td>Newline character</td>
</tr>
<tr>
<td>\r</td>
<td>Carrier return</td>
</tr>
<tr>
<td>&quot;</td>
<td>Double quotation mark</td>
</tr>
<tr>
<td>'</td>
<td>Single quotation mark/apostrophe</td>
</tr>
<tr>
<td>\</td>
<td>Backslash</td>
</tr>
<tr>
<td>$</td>
<td>Dollar sign</td>
</tr>
<tr>
<td>\u</td>
<td>Unicode character</td>
</tr>
</tbody>
</table>
<h2 id="split">split</h2>
<p>Creates a series of substrings using a delimiter you provide. Accepts a delimiter character to look for and retuns a list of the resulting substrings with the delimiter omitted, in this case , split, returns a list of strings in the order it found them. You use indices in square brackets.</p>
<h3 id="listing72-passing-tavern-data-to-placeorder-tavernkt">Listing7.2 Passing tavern data to placeOrder (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#66d9ef">val</span> TAVERN_NAME = <span style="color:#e6db74">&#34;Taernyl&#39;s Folly&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    placeOrder(<span style="color:#e6db74">&#34;shandy,Dragon&#39;s Breath,5.91&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">placeOrder</span>(menuData: String) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> indexOfApostrophe = <span style="color:#a6e22e">TAVERN_NAME</span>.indexOf(<span style="color:#e6db74">&#39;\&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> tavernMaster = <span style="color:#a6e22e">TAVERN_NAME</span>.substring(<span style="color:#ae81ff">0</span> until indexOfApostrophe)
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;Madrigal speaks with </span><span style="color:#e6db74">$tavernMaster</span><span style="color:#e6db74"> about their order.&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-73-splitting-the-menu-data-tavernkt">Listing 7.3 Splitting the menu data (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">placeOrder</span>(menuData: String) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> indexOfApostrophe = <span style="color:#a6e22e">TAVERN_NAME</span>.indexOf(<span style="color:#e6db74">&#39;\&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> tavernMaster = <span style="color:#a6e22e">TAVERN_NAME</span>.substring(<span style="color:#ae81ff">0</span> until indexOfApostrophe)
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;Madrigal speaks with </span><span style="color:#e6db74">$tavernMaster</span><span style="color:#e6db74"> about their order.&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> data = menuData.split(<span style="color:#e6db74">&#39;,&#39;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> type = <span style="color:#66d9ef">data</span>[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> name = <span style="color:#66d9ef">data</span>[<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> price = <span style="color:#66d9ef">data</span>[<span style="color:#ae81ff">2</span>]
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> message = <span style="color:#e6db74">&#34;Madrigal buys a </span><span style="color:#e6db74">$name</span><span style="color:#e6db74"> (</span><span style="color:#e6db74">$type</span><span style="color:#e6db74">) for </span><span style="color:#e6db74">$price</span><span style="color:#e6db74">.&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;  println(message)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Because <strong>split</strong> returns a list, it also supports simplified syntax called <em>destructuring</em> - a feature that allows you to declare and assign multiple variables in a single expression.</p>
<h3 id="listing-74-destructuring-the-menu-data-tavernkt">Listing 7.4 Destructuring the menu data (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">placeOrder</span>(menuData: String) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> indexOfApostrophe = <span style="color:#a6e22e">TAVERN_NAME</span>.indexOf(<span style="color:#e6db74">&#39;\&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> tavernMaster = <span style="color:#a6e22e">TAVERN_NAME</span>.substring(<span style="color:#ae81ff">0</span> until indexOfApostrophe)
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;Madrigal speaks with </span><span style="color:#e6db74">$tavernMaster</span><span style="color:#e6db74"> about their order.&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">val</span> data = menuData.split(<span style="color:#e6db74">&#39;,&#39;</span>)
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">val</span> type = <span style="color:#66d9ef">data</span>[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">val</span> name = <span style="color:#66d9ef">data</span>[<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">val</span> price = <span style="color:#66d9ef">data</span>[<span style="color:#ae81ff">2</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> <span style="color:#960050;background-color:#1e0010">(</span>type, name, price) = menuData.split(<span style="color:#e6db74">&#39;,&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> message = <span style="color:#e6db74">&#34;Madrigal buys a </span><span style="color:#e6db74">$name</span><span style="color:#e6db74"> (</span><span style="color:#e6db74">$type</span><span style="color:#e6db74">) for </span><span style="color:#e6db74">$price</span><span style="color:#e6db74">.&#34;</span>
</span></span><span style="display:flex;"><span>    println(message)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="string-manipulation">String Manipulation</h2>
<h3 id="replace">Replace</h3>
<p>The version of the <strong>replace</strong> function you used accepts two arguments. The first argument is a <strong>regular expression</strong> that determines which characteres you want to replace, A regular expression, or <strong>regex</strong>, defines a search pattern for characters you want to look for.</p>
<p><strong>Regex</strong> accpets a pattern argument, &ldquo;[aeiou]&rdquo;, that defines the characters you want to match and replace. Kotlin uses tha same regular expression patterns as Java</p>
<h3 id="listing-75-defining-the-__todragonspeak__-function-tavernkt">Listing 7.5 Defining the <strong>toDragonSpeak</strong> function (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#66d9ef">val</span> TAVERN_NAME = <span style="color:#e6db74">&#34;Taernyl&#39;s Folly&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    placeOrder(<span style="color:#e6db74">&#34;shandy,Dragon&#39;s Breath,5.91&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">toDragonSpeak</span>(phrase: String) =
</span></span><span style="display:flex;"><span>&gt;&gt;    phrase.replace(Regex(<span style="color:#e6db74">&#34;[aeiou]&#34;</span>)) {
</span></span><span style="display:flex;"><span>&gt;&gt;        <span style="color:#66d9ef">when</span> (<span style="color:#66d9ef">it</span>.<span style="color:#66d9ef">value</span>) {
</span></span><span style="display:flex;"><span>&gt;&gt;            <span style="color:#e6db74">&#34;a&#34;</span> <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;4&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;            <span style="color:#e6db74">&#34;e&#34;</span> <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;3&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;            <span style="color:#e6db74">&#34;i&#34;</span> <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;1&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;            <span style="color:#e6db74">&#34;o&#34;</span> <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;0&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;            <span style="color:#e6db74">&#34;u&#34;</span> <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;|_|&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;            <span style="color:#66d9ef">else</span> <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">it</span>.<span style="color:#66d9ef">value</span>
</span></span><span style="display:flex;"><span>&gt;&gt;        }
</span></span><span style="display:flex;"><span>&gt;&gt;    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">placeOrder</span>(menuData: String) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    println(message)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> phrase = <span style="color:#e6db74">&#34;Ah, delicious </span><span style="color:#e6db74">$name</span><span style="color:#e6db74">!&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;  println(<span style="color:#e6db74">&#34;Madrigal exclaims: </span><span style="color:#e6db74">${toDragonSpeak(phrase)}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="strings-are-immutable">Strings are immutable</h2>
<p>Whether they are defined with <em>var</em> or <em>val</em>, all strings in Kotlin are actually immutable (as they are in Java). Though the variables that hold the value for the String can be reassigned if the string is a var, the string instance itself an never be changed. Any function that appears to change teh value of a string (like replace) actually creates a new string with the change applied to it.</p>
<h2 id="string-comparison">String Comparison</h2>
<p>You checked the <em>structural equality</em> of name and &ldquo;Dragon&rsquo;s Breath&rdquo; using the strucutral equality operator, ==. You have seen this operator before, used with numeric values. When used with strings, it checks that the characters in each string match one another and are in the same order.</p>
<p>There is another way to check the equality of two variables: <em>comparing referential equality</em>, wich means checking that two variables share the same reference to a type instance - in other words, that two variables point to same object on the heap. Referential equality is checked using ===.</p>
<p>Referential comparison is not usually what you want. You generally donot care whether strings are different instances, only that they have the same characters in the same sequences</p>
<h1 id="8-numbers">8. Numbers</h1>
<p>Kotlin has a variety of types for dealing with numbers and numeric computations. Multiple types are available for each of two main varieties of numbers that Kotlin can work with: whole-number integers and numbers with decimals.</p>
<h2 id="numeric-types">Numeric Types</h2>
<p>All numeric types in kotlin, as in Java , are <em>signed</em>, meaning they can represent both positive and negative number. In addition to whether they support decimal values, the numeric types differ in the number of bits they are allocated in memory and, consequently, their minimum and maximum values.</p>
<p>Table 8.1 Commonly used numeric types.</p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Bits</th>
<th>Max Value</th>
<th>Min Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Byte</td>
<td>8</td>
<td>127</td>
<td>-128</td>
</tr>
<tr>
<td>Short</td>
<td>16</td>
<td>32767</td>
<td>-32768</td>
</tr>
<tr>
<td>Int</td>
<td>32</td>
<td>2147483647</td>
<td>-2147483648</td>
</tr>
<tr>
<td>Long</td>
<td>64</td>
<td>9223372036854775807</td>
<td>-9223372036854775808</td>
</tr>
<tr>
<td>Float</td>
<td>32</td>
<td>3.4028235E38</td>
<td>1.4E-45</td>
</tr>
<tr>
<td>Double</td>
<td>64</td>
<td>1.7976931348623157E308</td>
<td>4.9E-324</td>
</tr>
</tbody>
</table>
<h2 id="integers">Integers</h2>
<p>You learned in the Chapter 2 that an integer is a number that does not have a decimal point - a whole number - and is represented in kotlin with the <em>Int</em> type. Int is good for representing a quantity od count of &ldquo;things&rdquo;: the remaining points of mead, the number of tavern patrons, or the count of gold and silver coins a player possesses.</p>
<h3 id="listing-81-setting-up-the-players-purse-tavernkt">Listing 8.1 Setting up the playerâ€™s purse (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#66d9ef">val</span> TAVERN_NAME = <span style="color:#e6db74">&#34;Taernyl&#39;s Folly&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> playerGold = <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> playerSilver = <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    placeOrder(<span style="color:#e6db74">&#34;shandy,Dragon&#39;s Breath,5.91&#34;</span>)
</span></span><span style="display:flex;"><span> &lt;&lt; placeOrder(<span style="color:#e6db74">&#34;elixir,Shirley&#39;s Temple,4.12&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">performPurchase</span>() {
</span></span><span style="display:flex;"><span>&gt;&gt;      displayBalance()
</span></span><span style="display:flex;"><span>&gt;&gt;  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">displayBalance</span>() {
</span></span><span style="display:flex;"><span>&gt;&gt;      println(<span style="color:#e6db74">&#34;Player&#39;s purse balance: Gold: </span><span style="color:#e6db74">$playerGold</span><span style="color:#e6db74"> , Silver: </span><span style="color:#e6db74">$playerSilver</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">toDragonSpeak</span>(phrase: String) =
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">placeOrder</span>(menuData: String) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> indexOfApostrophe = <span style="color:#a6e22e">TAVERN_NAME</span>.indexOf(<span style="color:#e6db74">&#39;\&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> tavernMaster = <span style="color:#a6e22e">TAVERN_NAME</span>.substring(<span style="color:#ae81ff">0</span> until indexOfApostrophe)
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;Madrigal speaks with </span><span style="color:#e6db74">$tavernMaster</span><span style="color:#e6db74"> about their order.&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> <span style="color:#960050;background-color:#1e0010">(</span>type, name, price) = menuData.split(<span style="color:#e6db74">&#39;,&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> message = <span style="color:#e6db74">&#34;Madrigal buys a </span><span style="color:#e6db74">$name</span><span style="color:#e6db74"> (</span><span style="color:#e6db74">$type</span><span style="color:#e6db74">) for </span><span style="color:#e6db74">$price</span><span style="color:#e6db74">.&#34;</span>
</span></span><span style="display:flex;"><span>    println(message)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  performPurchase()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> phrase = <span style="color:#66d9ef">if</span> (name <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Dragon&#39;s Breath&#34;</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Madrigal exclaims </span><span style="color:#e6db74">${toDragonSpeak(&#34;Ah, delicious $name!&#34;)}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Madrigal says: Thanks for the </span><span style="color:#e6db74">$name</span><span style="color:#e6db74">.&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    println(phrase)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="decimal-numbers">Decimal numbers</h2>
<p>Numeric calues with decimal places are represented with the Float od Double type.</p>
<h3 id="listing-82-passing-the-price-information-tavernkt">Listing 8.2 Passing the price information (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#66d9ef">val</span> TAVERN_NAME = <span style="color:#e6db74">&#34;Taernyl&#39;s Folly&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">performPurchase</span>(price: Double) {
</span></span><span style="display:flex;"><span>    displayBalance()
</span></span><span style="display:flex;"><span>&gt;&gt;  println(<span style="color:#e6db74">&#34;Purchasing item for </span><span style="color:#e6db74">$price</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">placeOrder</span>(menuData: String) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> <span style="color:#960050;background-color:#1e0010">(</span>type, name, price) = menuData.split(<span style="color:#e6db74">&#39;,&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> message = <span style="color:#e6db74">&#34;Madrigal buys a </span><span style="color:#e6db74">$name</span><span style="color:#e6db74"> (</span><span style="color:#e6db74">$type</span><span style="color:#e6db74">) for </span><span style="color:#e6db74">$price</span><span style="color:#e6db74">.&#34;</span>
</span></span><span style="display:flex;"><span>    println(message)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    performPurchase(price)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="converting-a-string-to-a-numeric-type">Converting a String to a Numeric Type</h2>
<p>Kotlin includes functions that convert strings to different types - including numbers. Some of the most commonly used of these conversion functions are:</p>
<ul>
<li>toFloat</li>
<li>toDouble</li>
<li>toDoubleOrNull</li>
<li>toIntOrNull</li>
<li>toLong</li>
<li>toBigDecimal</li>
</ul>
<p>Attempting to convert a string of the wrong format will thrown an exception.</p>
<p>Kotlin also provides the safe conversion functions <strong>toDoubleOrNull</strong> and <strong>toIntOrNull</strong>. When the number does not convert correctly, a null values is returned instead of an exception. You could use the null coalescing operator with <strong>toIntOrNull</strong>, for example, to provide a default value:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> gold: Int =  <span style="color:#e6db74">&#34;5.91&#34;</span>.toIntOrNull() <span style="color:#f92672">?:</span> <span style="color:#ae81ff">0</span>
</span></span></code></pre></div><h3 id="listing-83-converting-the-price-argument-to-a-double-tavernkt">Listing 8.3 Converting the price argument to a double (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">placeOrder</span>(menuData: String) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> indexOfApostrophe = <span style="color:#a6e22e">TAVERN_NAME</span>.indexOf(<span style="color:#e6db74">&#39;\&#39;&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> tavernMaster = <span style="color:#a6e22e">TAVERN_NAME</span>.substring(<span style="color:#ae81ff">0</span> until indexOfApostrophe)
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;Madrigal speaks with </span><span style="color:#e6db74">$tavernMaster</span><span style="color:#e6db74"> about their order.&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> <span style="color:#960050;background-color:#1e0010">(</span>type, name, price) = menuData.split(<span style="color:#e6db74">&#39;,&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> message = <span style="color:#e6db74">&#34;Madrigal buys a </span><span style="color:#e6db74">$name</span><span style="color:#e6db74"> (</span><span style="color:#e6db74">$type</span><span style="color:#e6db74">) for </span><span style="color:#e6db74">$price</span><span style="color:#e6db74">.&#34;</span>
</span></span><span style="display:flex;"><span>    println(message)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    performPurchase(price.toDouble())
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="converting-an-int-to-a-double">Converting an Int to a Double</h2>
<h3 id="listing-84-subtracting-the-price-from-the-players-purse-tavernkt">Listing 8.4 Subtracting the price from the playerâ€™s purse (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">performPurchase</span>(price: Double) {
</span></span><span style="display:flex;"><span>    displayBalance()
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> totalPurse = playerGold + (playerSilver / <span style="color:#ae81ff">100.0</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  println(<span style="color:#e6db74">&#34;Total purse: </span><span style="color:#e6db74">$totalPurse</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;Purchasing item for </span><span style="color:#e6db74">$price</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> remainingBalance = totalPurse - price
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><h2 id="formatting-a-double">Formatting a Double</h2>
<p>Rather than working with 4.1899999999999995 pieces of goldm you will round the value up to 4.19. String&rsquo;s <strong>format</strong> function can be used to round a double to a precision that you define.</p>
<h3 id="listing-85-formatting-a-double-tavernkt">Listing 8.5 Formatting a double (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">performPurchase</span>(price: Double) {
</span></span><span style="display:flex;"><span>    displayBalance()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> totalPurse = playerGold + (playerSilver / <span style="color:#ae81ff">100.0</span>)
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;Total purse: </span><span style="color:#e6db74">$totalPurse</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;Purchasing item for </span><span style="color:#e6db74">$price</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> remainingBalance = totalPurse - price
</span></span><span style="display:flex;"><span>&gt;&gt;  println(<span style="color:#e6db74">&#34;Remaining balance: </span><span style="color:#e6db74">${&#34;%.2f&#34;.format(remainingBalance)}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>} <span style="color:#f92672">..</span>.
</span></span></code></pre></div><p>The gold remaining the purse is interpolated into the string using $, as you have seen before, But wht follows the $ is not simply the name of the variable - it is an expression in curly braces. Within th braces is a call to __format__with remainingBalance passed in as the argument.
The call to <strong>format</strong> also specifies a format string &ldquo;%.2f&rdquo;. A format string uses a special sequences if characters to define how you want to format data. The particular format string you defined specifies that you want to round the floating point number up to the second decimal place. Then you pass the value or values to format as an argument to the <strong>format</strong> function.</p>
<h2 id="converting-a-double-to-an-int">Converting a Double to an Int</h2>
<p>Here, you used two conversions functions available on Double. Calling <strong>toInt</strong> on a Double results in dropping any fractional value from the double. Another term for this is <em>loss of precision</em>. Some portion of the original data is lost, because you asked for an interger representation of a double that included a fractional quantity, and the integer representation is less precise.</p>
<h3 id="listing-86-converting-to-silver-and-gold-tavernkt">Listing 8.6 Converting to silver and gold (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>&gt;&gt;imports kotlin.math.roundToInt
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#66d9ef">val</span> TAVERN_NAME = <span style="color:#e6db74">&#34;Taernyl&#39;s Folly&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">performPurchase</span>(price: Double) {
</span></span><span style="display:flex;"><span>    displayBalance()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> totalPurse = playerGold + (playerSilver / <span style="color:#ae81ff">100.0</span>)
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;Total purse: </span><span style="color:#e6db74">$totalPurse</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;Purchasing item for </span><span style="color:#e6db74">$price</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> remainingBalance = totalPurse - price
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;Remaining balance: </span><span style="color:#e6db74">${&#34;%.2f&#34;.format(remainingBalance)}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> remainingGold = remainingBalance.toInt()
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> remainingSilver = (remainingBalance % <span style="color:#ae81ff">1</span> * <span style="color:#ae81ff">100</span>).roundToInt()
</span></span><span style="display:flex;"><span>&gt;&gt;  playerGold = remainingGold
</span></span><span style="display:flex;"><span>&gt;&gt;  playerSilver = remainingSilver
</span></span><span style="display:flex;"><span>&gt;&gt;  displayBalance()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><p>Here you use the <em>modulus operator</em> (%, also known as the <em>remainder operator</em>), which finds the remainder when one number is divided by another.</p>
<p>Kotlin includes functions for performing operations on the binary representations of valuem called bitwise operations - including operations you may be familiar from other languages, suchs as Java</p>
<h3 id="table-82-binary-operations">Table 8.2 Binary operations</h3>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td>Integer.toBinaryString</td>
<td>Converts an integer to binary representation.</td>
<td>Integer.toBinaryString(42)  // 101010</td>
</tr>
<tr>
<td>shl(bitcount)</td>
<td>Shifts bits left by bitcount</td>
<td>42.shl(2) // 10101000</td>
</tr>
<tr>
<td>shr(bitcount)</td>
<td>Shifts bits right by bitcount</td>
<td>42.shr(2) // 1010</td>
</tr>
<tr>
<td>inv()</td>
<td>Invert bits</td>
<td>42.inv() // 11111111111111111111111111010101</td>
</tr>
<tr>
<td>xor(number)</td>
<td>Compares two binary representations and performs a logical â€˜exclusive orâ€™ operation on the corresponding bit positions, returning 1 for each bit position that has a 1 in one input but not the other.</td>
<td>42.xor(33) // 001011</td>
</tr>
<tr>
<td>and(number)</td>
<td>Compares two binary representations and performs a logical â€˜andâ€™ operation on the corresponding bit positions, returning 1 for each bit position that has a 1 in both inputs.</td>
<td>42.and(10) // 1010</td>
</tr>
</tbody>
</table>
<h1 id="9-starndard-functions">9. Starndard Functions</h1>
<p>Standard functions are general utility functions in the kotlin standard library that accept lambdas to specify their work.</p>
<p>In this chapter we will refer to an instance of a tyoe using the term <em>receiver</em>. This is because Kotlin&rsquo;s standard functions are <em>extension functions</em> under the hood, an <em>receiver</em> is the term for the subject of an extension function.</p>
<h2 id="__apply__"><strong>apply</strong></h2>
<p>First on out tour of the standard functions is <strong>apply</strong>. <strong>apply</strong> can be thought of as a configuration function: It allows you to call a series of functions on a receiver to configure it for use. After the lambda provided to <strong>apply</strong> executes, <strong>apply</strong> returns the configured receiver.</p>
<p><strong>apply</strong> can be used to reduce tha mount of repetition when configuring an object for use.</p>
<p>Without <strong>apply</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> menuFile = Filer(<span style="color:#e6db74">&#34;menu-file.txt&#34;</span>)
</span></span><span style="display:flex;"><span>menuFile.setReadable(<span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>menuFile.setWritable(<span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>menuFile.setExecutable(<span style="color:#66d9ef">false</span>)
</span></span></code></pre></div><p>Using <strong>apply</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> menuFile = File(<span style="color:#e6db74">&#34;menu-file.txt&#34;</span>).apply{
</span></span><span style="display:flex;"><span>    setReadable(<span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>    setWritable(<span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>    setExecutable(<span style="color:#66d9ef">false</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>apply</strong> allows you do to drop the variable name from every function call performed to configure the receiver. This is because <strong>apply</strong> scopes each function call withon the lambda to the receiver it is called on.</p>
<p>This behavior is sometimes referred to as <strong>relative scoping</strong>, because all the function calls within the lambda are now called relative to the receiver. Another way to say this us that they are _<em>implicitly called</em> on the receiver.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> menuFile = File(<span style="color:#e6db74">&#34;menu-file.txt&#34;</span>).apply {
</span></span><span style="display:flex;"><span>        setReadable(<span style="color:#66d9ef">true</span>)  <span style="color:#75715e">// Implicitly, menuFile.setReadable(true)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        setWritable(<span style="color:#66d9ef">true</span>)  <span style="color:#75715e">// Implicitly, menuFile.setWritable(true)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        setExecutable(<span style="color:#66d9ef">false</span>)  <span style="color:#75715e">// Implicitly, menuFile.setExecutable(false)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><h2 id="__let__"><strong>let</strong></h2>
<p><strong>let</strong> scopes a variable to the lambda provided and makes the keyword <strong>it</strong>.</p>
<p>Using <strong>let</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> firstItemsquared = listOf(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>).first().let{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">it</span> * <span style="color:#66d9ef">it</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Without <strong>let</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> firstElement = listOf(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>).first()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">val</span> firstItemSquared = firstElement * firstElement
</span></span></code></pre></div><p><strong>let</strong> can be called on any kind of receiver and returns the result of evaluating the lambda you provided. the lambda passed to <strong>let</strong> accpets the receiver it is called on as its only argumetns. You therefore access the arguent using the it keyword.</p>
<p>Standard functions like <strong>let</strong> can also be used to reduce the risk of accidentally changing a variable, because the argument <strong>let</strong> passes to the lambda is a read-only function parameter.</p>
<h2 id="__run__"><strong>run</strong></h2>
<p><strong>run</strong> is similar to <strong>apply</strong> in that it provides the same relative scoping behavior. However, unlike <strong>apply</strong>, <strong>run</strong> does not return the receiver.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">nameIsLong</span>(name: String) = name.length <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;Mandrigal&#34;</span>.run(<span style="color:#f92672">::</span>nameIsLong)  <span style="color:#75715e">// false
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#e6db74">&#34;Polarcubis, Supreme Master of NyetHack&#34;</span>.run(<span style="color:#f92672">::</span>nameIsLong)  <span style="color:#75715e">// true
</span></span></span></code></pre></div><p>While the code like this is equivalen to nameIsLong(&ldquo;Mandrigal&rdquo;), the benefits of using <strong>run</strong> become clear when there are multiple functions calls: Chained calls using <strong>run</strong> are easier to read and follow then nested function calls like the next example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">nameIsLong</span>(name: String) = name.length <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">playerCreateMessage</span>(nameTooLong: Boolean): String {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">if</span> (nameTooLong) {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Name is too long. Please choose another name.&#34;</span>
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Welcome, adventurer&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;Polarcubis, Supreme Master of NyetHack&#34;</span>
</span></span><span style="display:flex;"><span>    .run(<span style="color:#f92672">::</span>nameIsLong)
</span></span><span style="display:flex;"><span>    .run(<span style="color:#f92672">::</span>playerCreateMessage)
</span></span><span style="display:flex;"><span>    .run(<span style="color:#f92672">::</span>println)
</span></span></code></pre></div><p>Compare the calls chined with <strong>run</strong> calling the three functions nested syntax</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>println(playerCreateMessage(nameIsLong(<span style="color:#e6db74">&#34;Polarcubis, Supreme Master of NyetHack&#34;</span>)))
</span></span></code></pre></div><p>Note that there is a second flavor of <strong>run</strong> that is not called on a receiver. This form is far less commonly seen, but we include it here for completeness:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> status = run {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span>(healthPoints <span style="color:#f92672">==</span> <span style="color:#ae81ff">100</span>) <span style="color:#e6db74">&#34;perfect health&#34;</span> <span style="color:#66d9ef">else</span> <span style="color:#e6db74">&#34;has injuries&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="__with__"><strong>with</strong></h2>
<p><strong>with</strong> is a variant of run. It behaves identically, but it uses a different calling convention. Unlike the standard functions you have seen so far, <strong>with</strong> requires its argument to be accepted as the first parameter ratherthan calling the standard function on reveiver type:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> nameTooLong  = with(<span style="color:#e6db74">&#34;Polarcubis, Supreme Master of NyeHack&#34;</span>){
</span></span><span style="display:flex;"><span>    length <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Instead of calling <strong>with</strong> on the string, as in &ldquo;Polarcubis, Supreme Master of NyeHack&rdquo;.run, the string is passed as the first (in this case, only) argument to <strong>with</strong>.</p>
<h2 id="__also__"><strong>also</strong></h2>
<p>The <strong>also</strong> function works very similarly to the <strong>let</strong> function. Just like <strong>let</strong>, <strong>also</strong> passes the receiver you call it on as an argument to a lambda you provide. But there is one major difference between <strong>let</strong> and <strong>also</strong>: <strong>also</strong> returns the receiver, rather than the result of the lambda.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> fileContents: List&lt;String&gt;
</span></span><span style="display:flex;"><span>File(<span style="color:#e6db74">&#34;file.txt&#34;</span>)
</span></span><span style="display:flex;"><span>    .also{
</span></span><span style="display:flex;"><span>        print(<span style="color:#66d9ef">it</span>.name)
</span></span><span style="display:flex;"><span>    }.also{
</span></span><span style="display:flex;"><span>        fileContents = <span style="color:#66d9ef">it</span>.readLines()
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>Sinse <strong>also</strong> returns the receiver instead of the result of the lambda, you can continue the chain additional function calls on to the original receiver.</p>
<h2 id="__takeif__"><strong>takeIf</strong></h2>
<p>__takeIf works a bit differently than the other standard functions: It evaluates a condition provided in a lambda, called a <em>predicate</em>, that returns either true or false depending on the conditions defines. If the condition evaluates as true, the receiver is returned from takeIf. If the condition is false, null is returned instead.
Consider the following example, which reads a file and only if it is readable and writable.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> fileContents = File(<span style="color:#e6db74">&#34;myfile.txt&#34;</span>)
</span></span><span style="display:flex;"><span>    .takeIf { <span style="color:#66d9ef">it</span>.canRead() <span style="color:#f92672">&amp;&amp;</span> <span style="color:#66d9ef">it</span>.canWrite() }
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">?.</span>readText()
</span></span></code></pre></div><p>Without <strong>takeIf</strong>, this would be more verbose:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> file = File(<span style="color:#e6db74">&#34;myfile.txt&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">val</span> fileContents = <span style="color:#66d9ef">if</span>(<span style="color:#66d9ef">file</span>.canRead() <span style="color:#f92672">&amp;&amp;</span> <span style="color:#66d9ef">file</span>.canWrite()){
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">file</span>.readText()
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">null</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>The <strong>takeIf</strong> version does not require the temporary variable fÃ­le, nor does it need to specify teh possibility of a null return. <strong>takeIf</strong> is useful for checking that some condition required for assigning a variable or proceeding with work is true before continuing. Conceptuallym <strong>takeIf</strong> is similar to an <em>if</em> statement, but with the advantage of begin directly callable on an instance, often allowing you remove a temporary variable assigment.</p>
<h2 id="__takeunless__"><strong>takeUnless</strong></h2>
<p>There is a complementary function to <strong>takeIf</strong> that we should mention. of only to warn you away from it: <strong>takeUnless</strong>. The <strong>takeUnless</strong> function is exactly like <strong>takeIf</strong> except that it returns the original value if the condition you define is <em>false</em>.</p>
<p>This example reads the file if it is no hidden (and return null otherwise)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> fileContents = File(<span style="color:#e6db74">&#34;myfile.txt&#34;</span>).takeUnless {<span style="color:#66d9ef">it</span>.isHidden}<span style="color:#f92672">?.</span>readText()
</span></span></code></pre></div><p>the book recommend that you limit the use of <strong>takeUnless</strong>, especially for more complicated condition-checking, because it takes longer for human readers of your program to interpret. Compaare the &ldquo;understandability&rdquo; of these two phrases:</p>
<ul>
<li>&ldquo;Return the value if the condition is true&rdquo; - <strong>takeIf</strong></li>
<li>&ldquo;Return the value unless the condition is true&rdquo; - <strong>takeUnless</strong></li>
</ul>
<h2 id="using-standard-library-functions">Using Standard Library Functions</h2>
<p>Table 9.1 Standard functions</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Passes receiver to lambda as argument?</th>
<th>Provides relative scoping?</th>
<th>Returns</th>
</tr>
</thead>
<tbody>
<tr>
<td>let</td>
<td>Yes</td>
<td>No</td>
<td>Lambda result</td>
</tr>
<tr>
<td>apply</td>
<td>No</td>
<td>Yes</td>
<td>Receiver</td>
</tr>
<tr>
<td>run</td>
<td>No</td>
<td>Yes</td>
<td>Lambda result</td>
</tr>
<tr>
<td>with</td>
<td>No</td>
<td>Yes</td>
<td>Lambda result</td>
</tr>
<tr>
<td>also</td>
<td>Yes</td>
<td>No</td>
<td>Receiver</td>
</tr>
<tr>
<td>takeIf</td>
<td>Yes</td>
<td>No</td>
<td>Nullable version of receiver</td>
</tr>
<tr>
<td>takeUnless</td>
<td>Yes</td>
<td>No</td>
<td>Nullable version of receiver</td>
</tr>
</tbody>
</table>
<h1 id="10-list-and-sets">10. List and Sets</h1>
<p>Working with a group of related values is an essential part of many programs. For example, your program might manage list of books, travel destinations, menu items, or tavern patron check balances. <em>Collections</em> allow you to coveniently work with those groups of values and pass them as arguments to functions.</p>
<h2 id="list">List</h2>
<p>Lists hold an ordered collection of values and allow duplicate values.</p>
<p><strong>listOf</strong> function returns a read-only list (more on that shortly) populated with the elements you provide for the argument</p>
<h3 id="listing-101-creating-a-list-of-patrons-tavernkt-import-kotlinmathroundtoint">Listing 10.1 Creating a list of patrons (Tavern.kt) import kotlin.math.roundToInt</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#66d9ef">val</span> TAVERN_NAME = <span style="color:#e6db74">&#34;Taernyl&#39;s Folly&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> playerGold = <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> playerSilver = <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> patronList: List&lt;String&gt; = listOf(<span style="color:#e6db74">&#34;Eli&#34;</span>, <span style="color:#e6db74">&#34;Mordoc&#34;</span>, <span style="color:#e6db74">&#34;Sophie&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>        placeOrder(<span style="color:#e6db74">&#34;shandy,Dragon&#39;s Breath,5.91&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;      println(patronList)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><p>Though type inference does work with list, you included the type information - val patronList: List<!-- raw HTML omitted --> - to make it invisible for discussion. Notice the diamond braces in List<!-- raw HTML omitted -->. <!-- raw HTML omitted --> is known as a <em>parameterized type</em>, and it tells the compiler about the type that teh contents of the list will be - in this case, Strings.</p>
<h3 id="listing-102-adding-an-integer-to-a-list-of-strings-tavernkt">Listing 10.2 Adding an integer to a list of strings (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> patronList: List&lt;String&gt; = listOf(<span style="color:#e6db74">&#34;Eli&#34;</span>, <span style="color:#e6db74">&#34;Mordoc&#34;</span>, <span style="color:#e6db74">&#34;Sophie&#34;</span>, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><p>IntelliJ warns you that the integer does not conform to the expected type, String. Type parameters are used with List because List is a <em>generic type</em>. This means that a list can hold any tyoe of data, including textual data like strings or characters, numeric data like integer or doubles, or even a new type that you define.</p>
<h3 id="listing-103-correcting-the-list-contents-tavernkt">Listing 10.3 Correcting the list contents (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">var</span> patronList: List&lt;String&gt; = listOf(<span style="color:#e6db74">&#34;Eli&#34;</span>, <span style="color:#e6db74">&#34;Mordoc&#34;</span>, <span style="color:#e6db74">&#34;Sophie&#34;</span>, <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">var</span> patronList: List&lt;String&gt; = listOf(<span style="color:#e6db74">&#34;Eli&#34;</span>, <span style="color:#e6db74">&#34;Mordoc&#34;</span>, <span style="color:#e6db74">&#34;Sophie&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><h2 id="accessing-a-lists-elements">Accessing a list&rsquo;s elements</h2>
<p>Recall from you work with the split function in Chapter 7 that you can access any element of a list using the element&rsquo;s index and the [] operator.</p>
<h3 id="listing-104-accessing-the-first-patron-tavernkt">Listing 10.4 Accessing the first patron (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>imports kotlin.math.roundToInt
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#66d9ef">val</span> TAVERN_NAME = <span style="color:#e6db74">&#34;Taernyl&#39;s Folly&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> playerGold = <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> playerSilver = <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span> &lt;&lt; <span style="color:#66d9ef">val</span> patronList: List&lt;String&gt; = listOf(<span style="color:#e6db74">&#34;Eli&#34;</span>, <span style="color:#e6db74">&#34;Mordoc&#34;</span>, <span style="color:#e6db74">&#34;Sophie&#34;</span>)
</span></span><span style="display:flex;"><span> &gt;&gt; <span style="color:#66d9ef">val</span> patronList = listOf(<span style="color:#e6db74">&#34;Eli&#34;</span>, <span style="color:#e6db74">&#34;Mordoc&#34;</span>, <span style="color:#e6db74">&#34;Sophie&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>        placeOrder(<span style="color:#e6db74">&#34;shandy,Dragon&#39;s Breath,5.91&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        println(patronList[<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><h2 id="index-boundaries-and-safe-index-access">Index boundaries and safe index access</h2>
<p>Accessing an element by index requires care, because attempting to access an element at an index that does not exits - say, the fourth item a list that contains only three - causes an ArrayIndexOutOfBoundsException exception.</p>
<h3 id="listing-105-accessing-a-nonexistent-index-repl">Listing 10.5 Accessing a nonexistent index (REPL)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> patronList = listOf(<span style="color:#e6db74">&#34;Eli&#34;</span>, <span style="color:#e6db74">&#34;Mordoc&#34;</span>, <span style="color:#e6db74">&#34;Sophie&#34;</span>)
</span></span><span style="display:flex;"><span>patronList[<span style="color:#ae81ff">4</span>]
</span></span></code></pre></div><p>The result is java.lang.ArrayIndexOutOfBoundsException: 4</p>
<p>The safe index access functions: <strong>getOrElse</strong>. takes two arguments: The first is the requested index (in parentheses, not square brackets). the second is a lambda that generates a default value, instead if an exception, if the requested index does no exist.</p>
<h3 id="listing-106-testing-getorelse-repl">Listing 10.6 Testing getOrElse (REPL)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> patronList = listOf(<span style="color:#e6db74">&#34;Eli&#34;</span>, <span style="color:#e6db74">&#34;Mordoc&#34;</span>, <span style="color:#e6db74">&#34;Sophie&#34;</span>)
</span></span><span style="display:flex;"><span>patronList.getOrElse(<span style="color:#ae81ff">4</span>) { <span style="color:#e6db74">&#34;Unknown Patron&#34;</span> }
</span></span></code></pre></div><p>This time, the result is Unknow Patron. The anonymous function was used to provide a default value, since the requested index does not exist.</p>
<p>Another safe index access function, <strong>getOrNull</strong>, returns null instead of throwing an exception. When you use <strong>getOrNull</strong>, you must decide what to do with the null value. One option is to coalesce the null value to a default. Try using <strong>getOrNull</strong> with the null coalescing operator.</p>
<h3 id="listing-107-testing-getornull-repl">Listing 10.7 Testing getOrNull (REPL)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> fifthPatron = patronList.getOrNull(<span style="color:#ae81ff">4</span>) <span style="color:#f92672">?:</span> <span style="color:#e6db74">&#34;Unknown Patron&#34;</span>
</span></span><span style="display:flex;"><span>fifthPatron
</span></span></code></pre></div><h2 id="checking-the-contents-of-a-list">Checking the contents of a list</h2>
<p>The <strong>contains</strong> function performs a structural comparison for the elements in the list, like the structural equality operator.</p>
<h3 id="listing-108-checking-for-a-patron-tavernkt">Listing 10.8 Checking for a patron (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (patronList.contains(<span style="color:#e6db74">&#34;Eli&#34;</span>)) {
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;The tavern master says: Eli&#39;s in the back playing cards.&#34;</span>)
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;The tavern master says: Eli isn&#39;t here.&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    placeOrder(<span style="color:#e6db74">&#34;shandy,Dragon&#39;s Breath,5.91&#34;</span>)
</span></span><span style="display:flex;"><span>    println(patronList[<span style="color:#ae81ff">0</span>])
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><h3 id="listing-109-checking-for-multiple-patrons-tavernkt">Listing 10.9 Checking for multiple patrons (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (patronList.contains(<span style="color:#e6db74">&#34;Eli&#34;</span>)) {
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;The tavern master says: Eli&#39;s in the back playing cards. &#34;</span>)
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;The tavern master says: Eli isn&#39;t here.&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">if</span> (patronList.containsAll(listOf(<span style="color:#e6db74">&#34;Sophie&#34;</span>, <span style="color:#e6db74">&#34;Mordoc&#34;</span>))) {
</span></span><span style="display:flex;"><span>&gt;&gt;      println(<span style="color:#e6db74">&#34;The tavern master says: Yea, they&#39;re seated by the stew kettle.&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>&gt;&gt;      println(<span style="color:#e6db74">&#34;The tavern master says: Nay, they departed hours ago.&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    placeOrder(<span style="color:#e6db74">&#34;shandy,Dragon&#39;s Breath,5.91&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><h2 id="changing-a-lists-contens">Changing a list&rsquo;s contens</h2>
<p>In kotlin, a modifiable list is known as a <em>mutable list</em>, and use the __mutableListOf__function to create one.</p>
<h3 id="listing-1010-making-the-patron-list-mutable-tavernkt">Listing 10.10 Making the patron list mutable (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">val</span> patronList = listOf(<span style="color:#e6db74">&#34;Eli&#34;</span>, <span style="color:#e6db74">&#34;Mordoc&#34;</span>, <span style="color:#e6db74">&#34;Sophie&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> patronList = mutableListOf(<span style="color:#e6db74">&#34;Eli&#34;</span>, <span style="color:#e6db74">&#34;Mordoc&#34;</span>, <span style="color:#e6db74">&#34;Sophie&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    placeOrder(<span style="color:#e6db74">&#34;shandy,Dragon&#39;s Breath,5.91&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  println(patronList)
</span></span><span style="display:flex;"><span>&gt;&gt;  patronList.remove(<span style="color:#e6db74">&#34;Eli&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  patronList.add(<span style="color:#e6db74">&#34;Alex&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  println(patronList)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><h3 id="listing-1011-adding-another-alex-tavernkt">Listing 10.11 Adding another Alex (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">val</span> patronList = mutableListOf(<span style="color:#e6db74">&#34;Eli&#34;</span>, <span style="color:#e6db74">&#34;Mordoc&#34;</span>, <span style="color:#e6db74">&#34;Sophie&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    placeOrder(<span style="color:#e6db74">&#34;shandy,Dragon&#39;s Breath,5.91&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    println(patronList)
</span></span><span style="display:flex;"><span>    patronList.remove(<span style="color:#e6db74">&#34;Eli&#34;</span>)
</span></span><span style="display:flex;"><span>    patronList.add(<span style="color:#e6db74">&#34;Alex&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  patronList.add(<span style="color:#ae81ff">0</span>, <span style="color:#e6db74">&#34;Alex&#34;</span>)
</span></span><span style="display:flex;"><span>    println(patronList)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><p>Run Tavern.kt again. You will see the following printed:</p>
<pre tabindex="0"><code>...
[Eli, Mordoc, Sophie]
[Alex, Mordoc, Sophie, Alex]
</code></pre><h3 id="listing-1012-modifying-a-mutable-list-using-the-set-operator-tavernkt">Listing 10.12 Modifying a mutable list using the set operator (Tavern.kt)</h3>
<p>&hellip;
val patronList = mutableListOf(&ldquo;Eli&rdquo;, &ldquo;Mordoc&rdquo;, &ldquo;Sophie&rdquo;)
fun main(args: Array<!-- raw HTML omitted -->) {
&hellip;
placeOrder(&ldquo;shandy,Dragon&rsquo;s Breath,5.91&rdquo;)
println(patronList)
patronList.remove(&ldquo;Eli&rdquo;)
patronList.add(&ldquo;Alex&rdquo;)
patronList.add(0, &ldquo;Alex&rdquo;)</p>
<blockquote>
<blockquote>
<p>patronList[0] = &ldquo;Alexis&rdquo;
println(patronList)
} &hellip;</p>
</blockquote>
</blockquote>
<p>Run Tavern.kt. You will see that patronList has been updated with Alexisâ€™ preferred name.</p>
<pre tabindex="0"><code>...
[Eli, Mordoc, Sophie]
[Alexis, Mordoc, Sophie, Alex]
</code></pre><p>Table 10.1 Mutable list mutator funtions</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
<th>Example(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td>[]= (set operator)</td>
<td>Sets the value at the inex, throws an exception if the index does not exists</td>
<td>val patronList = mutableListOf(&ldquo;Eli&rdquo;, &ldquo;Mordoc&rdquo;, &ldquo;Sophie&rdquo;) &ndash; patronList[4] = &ldquo;Reggie&rdquo; &ndash; <em>IndexOutOfBoundsException</em></td>
</tr>
<tr>
<td><strong>add</strong></td>
<td>Adds an element to the end of the list, resizing it by one element</td>
<td>val patronList = mutableListOf(&ldquo;Eli&rdquo;, &ldquo;Mordoc&rdquo;, &ldquo;Sophie&rdquo;) &ndash; patronList.add(&ldquo;Reggie&rdquo;) &ndash; [Eli, Mordoc, Sophie, Reggie] &ndash; patronList.size &ndash; 4</td>
</tr>
<tr>
<td><strong>add</strong> (at index)</td>
<td>Adds an element to the list at a particular index, resizing the list by one element. Throwns an exception if the index does not exist.</td>
<td>val patronList = mutableListOf(&ldquo;Eli&rdquo;, &ldquo;Mordoc&rdquo;,&ldquo;Sophie&rdquo;) &ndash; patronList.add(0, &ldquo;Reggie&rdquo;) &ndash; [Reggie, Eli, Mordoc, Sophie] &ndash; patronList.add(5, &ldquo;Sophie&rdquo;) &ndash; IndexOutOfBoundsException</td>
</tr>
<tr>
<td><strong>addAll</strong></td>
<td>Adds all of another collection with contents of the same type to the list</td>
<td>val patronList = mutableListOf(&ldquo;Eli&rdquo;, &ldquo;Mordoc&rdquo;,&ldquo;Sophie&rdquo;) &ndash; patronList.addAll(listOf(&ldquo;Reginald&rdquo;, &ldquo;Alex&rdquo;)) &ndash; [Eli, Mordoc, Sophie, Reginald, Alex]</td>
</tr>
<tr>
<td>+= (plus assign operator)</td>
<td>Adds an element or collection of elements to the list</td>
<td>mutableListOf(&ldquo;Eli&rdquo;, &ldquo;Mordoc&rdquo;, &ldquo;Sophie&rdquo;) += &ldquo;Reginald&rdquo; &ndash; [Eli, Mordoc, Sophie, Reginald] &ndash; mutableListOf(&ldquo;Eli&rdquo;,&ldquo;Mordoc&rdquo;,&ldquo;Sophie&rdquo;) += listOf(&ldquo;Alex&rdquo;, &ldquo;Shruti&rdquo;) &ndash; [Eli, Mordoc, Sophie, Alex, Shruti]</td>
</tr>
<tr>
<td>-= (minus assign operator)</td>
<td>Removes an element of collection of the elements from the list</td>
<td>mutableListOf(&ldquo;Eli&rdquo;,&ldquo;Mordoc&rdquo;,&ldquo;Sophie&rdquo;) -= &ldquo;Eli&rdquo; &ndash; [Mordoc, Sophie] &ndash; val patronList = mutableListOf(&ldquo;Eli&rdquo;,&ldquo;Mordoc&rdquo;,&ldquo;Sophie&rdquo;) &ndash; patronList -= listOf(&ldquo;Eli&rdquo;, Mordoc&rdquo;) &ndash; [Sophie]</td>
</tr>
<tr>
<td><strong>clear</strong></td>
<td>Removes all the elements from the list</td>
<td>mutableListOf(&ldquo;Eli&rdquo;, &ldquo;Mordoc&rdquo;, Sophie&quot;).clear() &ndash; []</td>
</tr>
<tr>
<td><strong>removeIf</strong></td>
<td>Removes elements from the list based on a predicate lambda</td>
<td>val patronList = mutableListOf(&ldquo;Eli&rdquo;,&ldquo;Mordoc&rdquo;,&ldquo;Sophie&rdquo;) &ndash; patronList.removeIf { it.contains(&ldquo;o&rdquo;) } &ndash; [Eli]</td>
</tr>
</tbody>
</table>
<h2 id="iteration">Iteration</h2>
<p>List include built-in support for a variety of functions that allow you to perform an action for each element og their contents. This concept is called <em>iteration</em></p>
<h2 id="__for__"><strong>for</strong></h2>
<p>One way to iterate through a list is a <em>for</em> loop. Its logic is, &ldquo;for each element in the list, do something&rdquo;</p>
<h3 id="listing-1013-iterating-over-the-patronlist-with-fortavernkt">Listing 10.13 Iterating over the patronList with for(Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    placeOrder(<span style="color:#e6db74">&#34;shandy,Dragon&#39;s Breath,5.91&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;&lt;  println(patronList)
</span></span><span style="display:flex;"><span>&lt;&lt;  patronList.remove(<span style="color:#e6db74">&#34;Eli&#34;</span>)
</span></span><span style="display:flex;"><span>&lt;&lt;  patronList.add(<span style="color:#e6db74">&#34;Alex&#34;</span>)
</span></span><span style="display:flex;"><span>&lt;&lt;  patronList.add(<span style="color:#ae81ff">0</span>, <span style="color:#e6db74">&#34;Alex&#34;</span>)
</span></span><span style="display:flex;"><span>&lt;&lt;  patronList[<span style="color:#ae81ff">0</span>] = <span style="color:#e6db74">&#34;Alexis&#34;</span>
</span></span><span style="display:flex;"><span>&lt;&lt;  println(patronList)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">for</span> (patron <span style="color:#66d9ef">in</span> patronList) {
</span></span><span style="display:flex;"><span>&gt;&gt;      println(<span style="color:#e6db74">&#34;Good evening, </span><span style="color:#e6db74">$patron</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><h2 id="__foreach__"><strong>forEach</strong></h2>
<p>The <strong>forEach</strong> function trsverses each element in teh list  &ndash; one by one, from the left to right &ndash; and passes each element to the anonymous function you provide as an argument.</p>
<h3 id="listing-1014-iterating-over-the-patronlist-with-foreach-tavernkt">Listing 10.14 Iterating over the patronList with forEach (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    placeOrder(<span style="color:#e6db74">&#34;shandy,Dragon&#39;s Breath,5.91&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">for</span> (patron <span style="color:#66d9ef">in</span> patronList) {
</span></span><span style="display:flex;"><span>&lt;&lt;      println(<span style="color:#e6db74">&#34;Good evening, </span><span style="color:#e6db74">$patron</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>&lt;&lt;  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  patronList.forEach { patron <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;      println(<span style="color:#e6db74">&#34;Good evening, </span><span style="color:#e6db74">$patron</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><h2 id="__foreachindexed__"><strong>forEachIndexed</strong></h2>
<p>Kotlin&rsquo;s <strong>for</strong> loop and <strong>foreach</strong> function handle indexing behind the scenes, If you also want access to the index of each element in a list as you iterate, use <strong>forEachIndexed</strong>.</p>
<h3 id="listing-1015-displaying-line-position-with-__foreachindexed__-tavernkt">Listing 10.15 Displaying line position with <strong>forEachIndexed</strong> (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    placeOrder(<span style="color:#e6db74">&#34;shandy,Dragon&#39;s Breath,5.91&#34;</span>)
</span></span><span style="display:flex;"><span>    patronList.forEachIndexed { index, patron <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;Good evening, </span><span style="color:#e6db74">$patron</span><span style="color:#e6db74"> - you&#39;re #</span><span style="color:#e6db74">${index + 1}</span><span style="color:#e6db74"> in line.&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><p>The <strong>forEach</strong> and <strong>forEachIndexed</strong> functions are also available on certain other types in kotlin.this category of types is called <em>Iterable</em>, and <em>List</em>, <em>Set</em>, <em>Map</em>, <em>IntRange</em>, and other collections type belong to the Iterable category. An iterable supports iteration - in other wotds, it allows trversing the elements it holds, performing some action for each element.</p>
<h2 id="reading-a-file-into-a-list">Reading a File into a List.</h2>
<h3 id="listing-1017-reading-menu-data-from-a-file-tavernkt">Listing 10.17 Reading menu data from a file (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">import</span> java.io.File
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> patronList = mutableListOf(<span style="color:#e6db74">&#34;Eli&#34;</span>, <span style="color:#e6db74">&#34;Mordoc&#34;</span>, <span style="color:#e6db74">&#34;Sophie&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> menuList = File(<span style="color:#e6db74">&#34;data/tavern-menu-items.txt&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;                     .readText()
</span></span><span style="display:flex;"><span>&gt;&gt;                     .split(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><h3 id="listing-1018-printing-the-diversified-menu-tavernkt">Listing 10.18 Printing the diversified menu (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    patronList.forEachIndexed { index, patron <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;Good evening, </span><span style="color:#e6db74">$patron</span><span style="color:#e6db74"> - you&#39;re #</span><span style="color:#e6db74">${index + 1}</span><span style="color:#e6db74"> in line.&#34;</span>)
</span></span><span style="display:flex;"><span>        placeOrder(patron, <span style="color:#e6db74">&#34;shandy,Dragon&#39;s Breath,5.91&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  menuList.forEachIndexed { index, <span style="color:#66d9ef">data</span> <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;      println(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">$index</span><span style="color:#e6db74"> : </span><span style="color:#e6db74">$data</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><h2 id="destructuring">Destructuring</h2>
<p>Alist offers the ability to destructure up to the first five elements it contains. Destructuring, allow you to declare an assign multiple variables in a single expression. You are using this destructuring declaration to separate the elements of the menu data:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> <span style="color:#960050;background-color:#1e0010">(</span>type, name , price) = menuData.split(<span style="color:#e6db74">&#39;,&#39;</span>)
</span></span></code></pre></div><p>By the way, you can also selectively destructure elements from a list by using the symbol _ to skip un wanted elements. Say, from example, that the tavern master would like to hand out medals to the best sword jugglers in the realm but gas misplaced the silver medal. If you wanted to destructure only the firts and third value in the result from splitting the patron list, you could do so with:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> <span style="color:#960050;background-color:#1e0010">(</span>goldMedal, _, bronzeMedal) = patronList
</span></span></code></pre></div><h2 id="sets">Sets</h2>
<p>List, as you have seen, allow deplicate elements (and are ordered, so duplicates - and other elements - can be identifies by their position). but sometimes you want a collection that guarantees that its items are unique.</p>
<p>But there are two major differences between lists and sets: The elements of a set are unique, and a set does not provided index. based mutators, because the iterms in a set not guarenteed to be in any particular order.</p>
<h2 id="creating-a-set">Creating a set</h2>
<p>Just as you can create a list using the <strong>listOf</strong> function, you can create a Set using the <strong>setOf</strong> function.</p>
<h3 id="listing-1020-creating-a-set-repl">Listing 10.20 Creating a set (REPL)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> planets = setOf(<span style="color:#e6db74">&#34;Mercury&#34;</span>, <span style="color:#e6db74">&#34;Venus&#34;</span>, <span style="color:#e6db74">&#34;Earth&#34;</span>)
</span></span><span style="display:flex;"><span>planets
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">[&#34;Mercury&#34;, &#34;Venus&#34;, &#34;Earth&#34;]</span>
</span></span></code></pre></div><h3 id="listing-1021-trying-to-create-a-set-with-a-duplicate-repl">Listing 10.21 Trying to create a set with a duplicate (REPL)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> planets = setOf(<span style="color:#e6db74">&#34;Mercury&#34;</span>, <span style="color:#e6db74">&#34;Venus&#34;</span>, <span style="color:#e6db74">&#34;Earth&#34;</span>, <span style="color:#e6db74">&#34;Earth&#34;</span>)
</span></span><span style="display:flex;"><span>planets
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">[&#34;Mercury&#34;, &#34;Venus&#34;, &#34;Earth&#34;]</span>
</span></span></code></pre></div><h3 id="listing-1022-checking-planets-repl">Listing 10.22 Checking planets (REPL)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>planets.contains(<span style="color:#e6db74">&#34;Earth&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt; <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>planets.contains(<span style="color:#e6db74">&#34;Pluto&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt; <span style="color:#66d9ef">false</span>
</span></span></code></pre></div><p>Set does not index its contests - meaning it provides no built-in [] operator to access alements using an index. However, you can still request an element at a particular index, using function that use iteration to accomplish the task.</p>
<h3 id="listing-1023-finding-the-third-planet-repl">Listing 10.23 Finding the third planet (REPL)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> planets = setOf(<span style="color:#e6db74">&#34;Mercury&#34;</span>, <span style="color:#e6db74">&#34;Venus&#34;</span>, <span style="color:#e6db74">&#34;Earth&#34;</span>)
</span></span><span style="display:flex;"><span>planets.elementAt(<span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>Earth
</span></span></code></pre></div><h2 id="add-elements-to-a-set">Add elements to a set</h2>
<h3 id="listing-1024-generating-10-random-patrons-tavernkt">Listing 10.24 Generating 10 random patrons (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> patronList = mutableListOf(<span style="color:#e6db74">&#34;Eli&#34;</span>, <span style="color:#e6db74">&#34;Mordoc&#34;</span>, <span style="color:#e6db74">&#34;Sophie&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> lastName = listOf(<span style="color:#e6db74">&#34;Ironfoot&#34;</span>, <span style="color:#e6db74">&#34;Fernsworth&#34;</span>, <span style="color:#e6db74">&#34;Baggins&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> menuList = File(<span style="color:#e6db74">&#34;data/tavern-menu-items.txt&#34;</span>)
</span></span><span style="display:flex;"><span>                                    .readText()
</span></span><span style="display:flex;"><span>                                    .split(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>&lt;&lt;    patronList.forEachIndexed { index, patron <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>&lt;&lt;        println(<span style="color:#e6db74">&#34;Good evening, </span><span style="color:#e6db74">$patron</span><span style="color:#e6db74"> - you&#39;re #</span><span style="color:#e6db74">${index + 1}</span><span style="color:#e6db74"> in line.&#34;</span>)
</span></span><span style="display:flex;"><span>&lt;&lt;        placeOrder(patron, menuList.shuffled().first())
</span></span><span style="display:flex;"><span>&lt;&lt;    }
</span></span><span style="display:flex;"><span>&lt;&lt;    menuList.forEachIndexed { index, <span style="color:#66d9ef">data</span> <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>&lt;&lt;        println(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">$index</span><span style="color:#e6db74"> : </span><span style="color:#e6db74">$data</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>&lt;&lt;    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;   (<span style="color:#ae81ff">0.</span>.<span style="color:#ae81ff">9</span>).forEach {
</span></span><span style="display:flex;"><span>&gt;&gt;        <span style="color:#66d9ef">val</span> first = patronList.shuffled().first()
</span></span><span style="display:flex;"><span>&gt;&gt;        <span style="color:#66d9ef">val</span> last = lastName.shuffled().first()
</span></span><span style="display:flex;"><span>&gt;&gt;        <span style="color:#66d9ef">val</span> name = <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">$first</span><span style="color:#e6db74"> </span><span style="color:#e6db74">$last</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;        println(name)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><h3 id="listing-1025-ensuring-uniqueness-using-a-set-tavernkt">Listing 10.25 Ensuring uniqueness using a set (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> lastName = listOf(<span style="color:#e6db74">&#34;Ironfoot&#34;</span>, <span style="color:#e6db74">&#34;Fernsworth&#34;</span>, <span style="color:#e6db74">&#34;Baggins&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> uniquePatrons = mutableSetOf&lt;String&gt;()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> menuList = File(<span style="color:#e6db74">&#34;data/tavern-menu-items.txt&#34;</span>)
</span></span><span style="display:flex;"><span>                                    .readText()
</span></span><span style="display:flex;"><span>                                    .split(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>(<span style="color:#ae81ff">0.</span>.<span style="color:#ae81ff">9</span>).forEach {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> first = patronList.shuffled().first() <span style="color:#66d9ef">val</span> last = lastName.shuffled().first() <span style="color:#66d9ef">val</span> name = <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">$first</span><span style="color:#e6db74"> </span><span style="color:#e6db74">$last</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>&lt;&lt;  println(name)
</span></span><span style="display:flex;"><span>&gt;&gt;  uniquePatrons <span style="color:#f92672">+=</span> name
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>&gt;&gt;  println(uniquePatrons)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><p>Table 10.2 Mutable set mutator functions</p>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
<th>Example(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>add</strong></td>
<td>Adds the value to the set</td>
<td>mutableSetOf(1,2).add(3) &ndash; [1,2,3]</td>
</tr>
<tr>
<td><strong>addAll</strong></td>
<td>Adds all elements from another collections to set</td>
<td>mutableSetOf(1,2).addAll(listOf(1,5,6)) &ndash; [1,2,3]</td>
</tr>
<tr>
<td>+= (plus assign operator)</td>
<td>Add the value(s) to the set</td>
<td>mutableSetOf(1,2) -= 3 &ndash; [1,2,3]</td>
</tr>
<tr>
<td>-= (minus assign operator)</td>
<td>Removes the value to the set</td>
<td>mutableSetOf((1,2,3)) -= 3 &ndash; [1,2] &ndash; mutableSetOf(1,2,3) -= listOf(2,3) &ndash; [1]</td>
</tr>
<tr>
<td><strong>remove</strong></td>
<td>Removes the element from the set</td>
<td>mutableSetOf(1,2,3).remove(1) &ndash; [2,3]</td>
</tr>
<tr>
<td><strong>removeAll</strong></td>
<td>Removes all elements in another collection from the set</td>
<td>mutableSetOF(1,2).removeAll(listOf(1,5,6)) &ndash; [2]</td>
</tr>
<tr>
<td><strong>clear</strong></td>
<td>Removes all elemtns from the set</td>
<td>mutableSetOf(1,2).clear() &ndash; []</td>
</tr>
</tbody>
</table>
<h2 id="while-loops">While Loops.</h2>
<p>A while loop&rsquo;s logic is &ldquo;While some condition is truem execute the code in this block&rdquo;.</p>
<h3 id="listing-1026-unique-patrons-placing-random-orders-tavernkt">Listing 10.26 Unique patrons placing random orders (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    println(uniquePatrons)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">var</span> orderCount = <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">while</span> (orderCount <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">9</span>) {
</span></span><span style="display:flex;"><span>&gt;&gt;      placeOrder(uniquePatrons.shuffled().first(),
</span></span><span style="display:flex;"><span>&gt;&gt;              menuList.shuffled().first())
</span></span><span style="display:flex;"><span>&gt;&gt;      orderCount<span style="color:#f92672">++</span>
</span></span><span style="display:flex;"><span>&gt;&gt;  }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><p>The <em>increment operator</em> (++) adds 1 to the calue of orderCount during each iteration.</p>
<p>A while loop requires you to maintain your own counter manager its state. You start with an orderCount calue of 0 and increment time that you loop. white loops are more flexible than for loops in that they can represent state that is not purely based on iteration.</p>
<h2 id="the-break-expression">The break Expression</h2>
<p>One way to exit a white loop es by changing the state it depeneds on. Another way to break out of a loop is the break expression.</p>
<h2 id="collection-conversion">Collection Conversion</h2>
<p>You can also convert a list to a set, or vise versa, using the <strong>toSet</strong> and <strong>toList</strong> functions (or their mutabke cousins: to <strong>MutableSet</strong> and <strong>toMutableList</strong>).</p>
<h3 id="listing-1027-converting-a-list-to-a-set-repl">Listing 10.27 Converting a list to a set (REPL)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>listOf(<span style="color:#e6db74">&#34;Eli Baggins&#34;</span>, <span style="color:#e6db74">&#34;Eli Baggins&#34;</span>, <span style="color:#e6db74">&#34;Eli Ironfoot&#34;</span>).toSet()
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">[Eli Baggins, Eli Ironfoot]</span>
</span></span></code></pre></div><h3 id="listing-1028-converting-a-set-back-to-a-list-repl">Listing 10.28 Converting a set back to a list (REPL)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> patrons = listOf(<span style="color:#e6db74">&#34;Eli Baggins&#34;</span>, <span style="color:#e6db74">&#34;Eli Baggins&#34;</span>, <span style="color:#e6db74">&#34;Eli Ironfoot&#34;</span>)
</span></span><span style="display:flex;"><span>            .toSet()
</span></span><span style="display:flex;"><span>            .toList()
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">[Eli Baggins, Eli Ironfoot]</span>
</span></span><span style="display:flex;"><span>patrons[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>Eli Baggins
</span></span></code></pre></div><p>the need to remove duplicates and resume index-based access is so common that kotlin provides a function on List called <strong>distinct</strong> that calls <strong>toSet</strong> and <strong>toList</strong> internally</p>
<h3 id="listing-1029-calling-__distinct__-repl">Listing 10.29 Calling <strong>distinct</strong> (REPL)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> patrons = listOf(<span style="color:#e6db74">&#34;Eli Baggins&#34;</span>, <span style="color:#e6db74">&#34;Eli Baggins&#34;</span>, <span style="color:#e6db74">&#34;Eli Ironfoot&#34;</span>).distinct()
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">[Eli Baggins, Eli Ironfoot]</span>
</span></span><span style="display:flex;"><span>patrons[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>Eli Baggins
</span></span></code></pre></div><p>Set are useful for representing series of data where each element is unique.</p>
<h1 id="11-maps">11. Maps</h1>
<p>Where Map is defferent from List and Set is that its elements consist of key-value pairs that you define and instead of index-based access using an intenger, a map provides key-based acces using a type that you specify. Keys are unique and identify the values in the map; the values, on the other hand, do not need to be unique. In this way, Map shares another feature with Set; The keys of a mao are guaranteed to be unique, just like elements of a set.</p>
<h2 id="creating-a-map">Creating a Map</h2>
<p>Like list and sets, maps are created using functions: <strong>mapOf</strong> and <strong>mutableMapOf</strong></p>
<h3 id="listing-111-creating-a-read-only-map-tavernkt">Listing 11.1 Creating a read-only map (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> uniquePatrons = mutableSetOf&lt;String&gt;()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> menuList = File(<span style="color:#e6db74">&#34;data/tavern-menu-items.txt&#34;</span>)
</span></span><span style="display:flex;"><span>                                    .readText()
</span></span><span style="display:flex;"><span>                                    .split(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> patronGold = mapOf(<span style="color:#e6db74">&#34;Eli&#34;</span> to <span style="color:#ae81ff">10.5</span>, <span style="color:#e6db74">&#34;Mordoc&#34;</span> to <span style="color:#ae81ff">8.0</span>, <span style="color:#e6db74">&#34;Sophie&#34;</span> to <span style="color:#ae81ff">5.5</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>        println(uniquePatrons)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> orderCount = <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> (orderCount <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">9</span>) {
</span></span><span style="display:flex;"><span>            placeOrder(uniquePatrons.shuffled().first(),
</span></span><span style="display:flex;"><span>                    menuList.shuffled().first())
</span></span><span style="display:flex;"><span>            orderCount<span style="color:#f92672">++</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>&gt;&gt;  println(patronGold)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><p>While teh keys in a map must all be of the same tyoe, and the values must be of the same type, the keys and values can be of different types. Here you have a map with string keys and double values. You are using type onference, but if you had wanted to include explicit type information, it would look like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> patronGold: Map&lt;String, Double&gt;
</span></span></code></pre></div><p>You used <strong>to</strong> to define each entry (key am value) in the map.</p>
<h3 id="listing112-defining-a-map-using-the-pair-type-repl">Listing11.2 Defining a map using the Pair type (REPL)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> patronGold = mapOf(Pair(<span style="color:#e6db74">&#34;Eli&#34;</span>, <span style="color:#ae81ff">10.75</span>),
</span></span><span style="display:flex;"><span>    Pair(<span style="color:#e6db74">&#34;Mordoc&#34;</span>, <span style="color:#ae81ff">8.00</span>),
</span></span><span style="display:flex;"><span>    Pair(<span style="color:#e6db74">&#34;Sophie&#34;</span>, <span style="color:#ae81ff">5.50</span>))
</span></span></code></pre></div><p>However, building a map using the <strong>to</strong> function is cleaner than this sintax</p>
<h3 id="listing-113-adding-a-duplicate-key-repl">Listing 11.3 Adding a duplicate key (REPL)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> patronGold = mutableMapOf(<span style="color:#e6db74">&#34;Eli&#34;</span> to <span style="color:#ae81ff">5.0</span>, <span style="color:#e6db74">&#34;Sophie&#34;</span> to <span style="color:#ae81ff">1.0</span>) patronGold <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34;Sophie&#34;</span> to <span style="color:#ae81ff">6.0</span>
</span></span><span style="display:flex;"><span>println(patronGold)
</span></span><span style="display:flex;"><span>{Eli=<span style="color:#ae81ff">5.0</span>, Sophie=<span style="color:#ae81ff">6.0</span>}
</span></span></code></pre></div><h2 id="accessing-map-values">Accessing Map Values</h2>
<p>You acceess a value in a map using its key. For the partronGold map, you will use the string key to access the patron&rsquo;s gold balances</p>
<h3 id="listing-114-accessing-individual-gold-balances-tavernkt">Listing 11.4 Accessing individual gold balances (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    println(uniquePatrons)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> orderCount = <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (orderCount <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">9</span>) {
</span></span><span style="display:flex;"><span>        placeOrder(uniquePatrons.shuffled().first(),
</span></span><span style="display:flex;"><span>                menuList.shuffled().first())
</span></span><span style="display:flex;"><span>        orderCount<span style="color:#f92672">++</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    println(patronGold)
</span></span><span style="display:flex;"><span>&gt;&gt;  println(patronGold[<span style="color:#e6db74">&#34;Eli&#34;</span>])
</span></span><span style="display:flex;"><span>&gt;&gt;  println(patronGold[<span style="color:#e6db74">&#34;Mordoc&#34;</span>])
</span></span><span style="display:flex;"><span>&gt;&gt;  println(patronGold[<span style="color:#e6db74">&#34;Sophie&#34;</span>])
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="table-111-map-access-functions">Table 11.1 Map access functions</h3>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td>[] (get/index operator)</td>
<td>Gets  the value for a key; returns null if the key does not exists</td>
<td>patronGold[&ldquo;Reginald&rdquo;] &ndash; null</td>
</tr>
<tr>
<td><strong>getValue</strong></td>
<td>Gets the value for a key; throwsan exception if the key provided is not in the map</td>
<td>patronGold.getValue(&ldquo;Reggie&rdquo;) &ndash; NoSuchElementException</td>
</tr>
<tr>
<td><strong>getOrElse</strong></td>
<td>Gets the value for the key or return a default using an anonymous function</td>
<td>patronGold.getOrElse(&ldquo;Reggie&rdquo;) {&ldquo;No such patron&rdquo;} &ndash; No such patron</td>
</tr>
<tr>
<td><strong>getOrDefault</strong></td>
<td>Gets the value for the key or return a default using a value you provide</td>
<td>patronGold.getOrDefault(&ldquo;Reginald&rdquo;, 0.0) &ndash; 0.0</td>
</tr>
</tbody>
</table>
<h2 id="adding-entries-to-a-map">Adding entries to a map</h2>
<h3 id="listing-115-populating-the-mutable-map-tavernkt">Listing 11.5 Populating the mutable map (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>    importx java.io.File
</span></span><span style="display:flex;"><span>    importx kotlin.math.roundToInt
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">val</span> TAVERN_NAME: String = <span style="color:#e6db74">&#34;Taernyl&#39;s Folly&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> playerGold = <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> playerSilver = <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> patronList = mutableListOf(<span style="color:#e6db74">&#34;Eli&#34;</span>, <span style="color:#e6db74">&#34;Mordoc&#34;</span>, <span style="color:#e6db74">&#34;Sophie&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> lastName = listOf(<span style="color:#e6db74">&#34;Ironfoot&#34;</span>, <span style="color:#e6db74">&#34;Fernsworth&#34;</span>, <span style="color:#e6db74">&#34;Baggins&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> uniquePatrons = mutableSetOf&lt;String&gt;()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> menuList = File(<span style="color:#e6db74">&#34;data/tavern-menu-items.txt&#34;</span>)
</span></span><span style="display:flex;"><span>            .readText()
</span></span><span style="display:flex;"><span>            .split(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">val</span> patronGold = mapOf(<span style="color:#e6db74">&#34;Eli&#34;</span> to <span style="color:#ae81ff">10.5</span>, <span style="color:#e6db74">&#34;Mordoc&#34;</span> to <span style="color:#ae81ff">8.0</span>, <span style="color:#e6db74">&#34;Sophie&#34;</span> to <span style="color:#ae81ff">5.5</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> patronGold = mutableMapOf&lt;String, Double&gt;()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>&lt;&lt;      println(uniquePatrons)
</span></span><span style="display:flex;"><span>&gt;&gt;      uniquePatrons.forEach {
</span></span><span style="display:flex;"><span>&gt;&gt;          patronGold[<span style="color:#66d9ef">it</span>] = <span style="color:#ae81ff">6.0</span>
</span></span><span style="display:flex;"><span>&gt;&gt;      }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> orderCount = <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> (orderCount <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">9</span>) {
</span></span><span style="display:flex;"><span>            placeOrder(uniquePatrons.shuffled().first(),
</span></span><span style="display:flex;"><span>                    menuList.shuffled().first())
</span></span><span style="display:flex;"><span>            orderCount<span style="color:#f92672">++</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;&lt;      println(patronGold)
</span></span><span style="display:flex;"><span>&lt;&lt;      println(patronGold[<span style="color:#e6db74">&#34;Eli&#34;</span>])
</span></span><span style="display:flex;"><span>&lt;&lt;      println(patronGold[<span style="color:#e6db74">&#34;Mordoc&#34;</span>])
</span></span><span style="display:flex;"><span>&lt;&lt;      println(patronGold[<span style="color:#e6db74">&#34;Sophie&#34;</span>])
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><h3 id="table-112-mutable-map-mutator-functions">Table 11.2 Mutable map mutator functions</h3>
<table>
<thead>
<tr>
<th>Function</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td>= (assigment operator)</td>
<td>Adds or updates the value in the map for the key specified</td>
<td>val patronGold = mutableMapOf(&ldquo;Mordoc&rdquo; to 6.0) &ndash; patronGold[&ldquo;Mordoc&rdquo;] = 5.0 &ndash; {Mordoc=5.0}</td>
</tr>
<tr>
<td>+= (plus assign operator)</td>
<td>Adds or updates an entry or entries in the map based on the entry or map specified</td>
<td>val patronGold = mutableMapOf(&ldquo;Mordoc&rdquo; to 6.0) &ndash; patronGold += &ldquo;Eli&rdquo; to 5.0 &ndash; {Mordoc=6.0, Eli=5.0} &ndash; val patronGold = mutableMapOf(&ldquo;Mordoc&rdquo; to 6.0) &ndash; patronGold += mapOf(&ldquo;Eli&rdquo; to 7.0,&ldquo;Mordoc&rdquo; to 1.0,&ldquo;Jebediah&rdquo; to 4.5) &ndash; {Mordoc=1.0, Eli=7.0, Jebediah=4.5}</td>
</tr>
<tr>
<td><strong>put</strong></td>
<td>Adds or update the value in the map for the key specifies</td>
<td>val patronGold = mutableMapOf(&ldquo;Mordoc&rdquo; to 6.0) &ndash; patronGold.put(&ldquo;Mordoc&rdquo;, 5.0) &ndash; {Mordoc=5.0}</td>
</tr>
<tr>
<td><strong>putAll</strong></td>
<td>Adds all of the key-value pairs provided to the map</td>
<td>val patronGold = mutableMapOf(&ldquo;Mordoc&rdquo; to 6.0) &ndash; patronGold.putAll(listOf(&ldquo;Jebediah&rdquo; to 5.0,&ldquo;Sahara&rdquo; to 6.0)) &ndash; patronGold[&ldquo;Jebediah&rdquo;] &ndash; 5.0 &ndash; patronGold[&ldquo;Sahara&rdquo;] &ndash; 6.0</td>
</tr>
<tr>
<td><strong>getOrPut</strong></td>
<td>Adds an entry for the key if it does not exist already and returns the result; otherwise returns the existing entry</td>
<td>val patronGold = mutableMapOf&lt;String, Double&gt;() &ndash; patronGold.getOrPut(&ldquo;Randy&rdquo;){5.0} &ndash; 5.0 &ndash;patronGold.getOrPut(&ldquo;Randy&rdquo;){10.0} &ndash; 5.0</td>
</tr>
<tr>
<td><strong>remove</strong></td>
<td>Removes an entry from the map and returns the value.</td>
<td>val patronGold = mutableMapOf(&ldquo;Mordoc&rdquo; to 5.0) &ndash; val mordocBalance = patronGold.remove(&ldquo;Mordoc&rdquo;) &ndash; {} &ndash; print(mordocBalance) &ndash; 5.0</td>
</tr>
<tr>
<td>- (minus operator)</td>
<td>Returns a new map, excluding the entries specified</td>
<td>val newPatrons = mutableMapOf(&ldquo;Mordoc&rdquo; to 6.0,&ldquo;Jebediah&rdquo; to 1.0) - &ldquo;Mordoc&rdquo; &ndash; {Jebediah=1.0}</td>
</tr>
<tr>
<td>-= (minus assign operator)</td>
<td>Removes antry or map of entries from the map</td>
<td>mutableMapOf(&ldquo;Mordoc&rdquo; to 6.0,&ldquo;Jebediah&rdquo; to 1.0) -= &ldquo;Mordoc&rdquo; &ndash; {Jebediah=1.0}</td>
</tr>
<tr>
<td><strong>clear</strong></td>
<td>Removes all entries from the map</td>
<td>mutableMapOf(&ldquo;Mordoc&rdquo; to 6.0,&ldquo;Jebediah&rdquo; to 1.0).clear() &ndash; {}</td>
</tr>
</tbody>
</table>
<h2 id="modifying-map-values">Modifying Map Values</h2>
<h3 id="listing-116-updating-the-values-in-patrongold-tavernkt">Listing 11.6 Updating the values in patronGold (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>importx java.io.File
</span></span><span style="display:flex;"><span>importx kotlin.math.roundToInt
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#66d9ef">val</span> TAVERN_NAME: String = <span style="color:#e6db74">&#34;Taernyl&#39;s Folly&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">var</span> playerGold = <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">var</span> playerSilver = <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> patronList = mutableListOf(<span style="color:#e6db74">&#34;Eli&#34;</span>, <span style="color:#e6db74">&#34;Mordoc&#34;</span>, <span style="color:#e6db74">&#34;Sophie&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">performPurchase</span>(price: Double) {
</span></span><span style="display:flex;"><span>&lt;&lt;      displayBalance()
</span></span><span style="display:flex;"><span>&lt;&lt;      <span style="color:#66d9ef">val</span> totalPurse = playerGold + (playerSilver / <span style="color:#ae81ff">100.0</span>)
</span></span><span style="display:flex;"><span>&lt;&lt;      println(<span style="color:#e6db74">&#34;Total purse: </span><span style="color:#e6db74">$totalPurse</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>&lt;&lt;      println(<span style="color:#e6db74">&#34;Purchasing item for </span><span style="color:#e6db74">$price</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>&lt;&lt;      <span style="color:#66d9ef">val</span> remainingBalance = totalPurse - price
</span></span><span style="display:flex;"><span>&lt;&lt;      println(<span style="color:#e6db74">&#34;Remaining balance: </span><span style="color:#e6db74">${&#34;%.2f&#34;.format(remainingBalance)}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>&lt;&lt;      <span style="color:#66d9ef">val</span> remainingGold = remainingBalance.toInt()
</span></span><span style="display:flex;"><span>&lt;&lt;      <span style="color:#66d9ef">val</span> remainingSilver = (remainingBalance % <span style="color:#ae81ff">1</span> * <span style="color:#ae81ff">100</span>).roundToInt()
</span></span><span style="display:flex;"><span>&lt;&lt;      playerGold = remainingGold
</span></span><span style="display:flex;"><span>&lt;&lt;      playerSilver = remainingSilver
</span></span><span style="display:flex;"><span>&lt;&lt;      displayBalance()
</span></span><span style="display:flex;"><span>&lt;&lt;  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">displayBalance</span>() {
</span></span><span style="display:flex;"><span>&lt;&lt;      println(<span style="color:#e6db74">&#34;Player&#39;s purse balance: Gold: </span><span style="color:#e6db74">$playerGold</span><span style="color:#e6db74"> , Silver: </span><span style="color:#e6db74">$playerSilver</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>&lt;&lt;  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">performPurchase</span>(price: Double, patronName: String) {
</span></span><span style="display:flex;"><span>&gt;&gt;      <span style="color:#66d9ef">val</span> totalPurse = patronGold.getValue(patronName)
</span></span><span style="display:flex;"><span>&gt;&gt;      patronGold[patronName] = totalPurse - price
</span></span><span style="display:flex;"><span>&gt;&gt;  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">toDragonSpeak</span>(phrase: String) =
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">placeOrder</span>(patronName: String, menuData: String) {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    println(message)
</span></span><span style="display:flex;"><span>&lt;&lt;      <span style="color:#75715e">// performPurchase(price.toDouble(), patronName)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>&gt;&gt;      performPurchase(price.toDouble(), patronName)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> phrase = <span style="color:#66d9ef">if</span> (name <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Dragon&#39;s Breath&#34;</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span></code></pre></div><h3 id="listing-117-displaying-patron-balances-tavernkt">Listing 11.7 Displaying patron balances (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> orderCount = <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (orderCount <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">9</span>) {
</span></span><span style="display:flex;"><span>        placeOrder(uniquePatrons.shuffled().first(),
</span></span><span style="display:flex;"><span>                menuList.shuffled().first())
</span></span><span style="display:flex;"><span>        orderCount<span style="color:#f92672">++</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>&gt;&gt;  displayPatronBalances()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">displayPatronBalances</span>() {
</span></span><span style="display:flex;"><span>&gt;&gt;      patronGold.forEach { patron, balance <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;          println(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">$patron</span><span style="color:#e6db74">, balance: </span><span style="color:#e6db74">${&#34;%.2f&#34;.format(balance)}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;      }
</span></span><span style="display:flex;"><span>&gt;&gt;  }
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><p>Table 11.3 Kotlin Collections summary</p>
<table>
<thead>
<tr>
<th>Collection Type</th>
<th>Ordered?</th>
<th>Unique?</th>
<th>Store</th>
<th>Support destructuring?</th>
</tr>
</thead>
<tbody>
<tr>
<td>List</td>
<td>Yes</td>
<td>No</td>
<td>Elements</td>
<td>Yes</td>
</tr>
<tr>
<td>Set</td>
<td>No</td>
<td>Yes</td>
<td>Elements</td>
<td>No</td>
</tr>
<tr>
<td>Map</td>
<td>No</td>
<td>Keys</td>
<td>Key-value pairs</td>
<td>No</td>
</tr>
</tbody>
</table>
<h1 id="12-defining-classes">12. Defining Classes</h1>
<p>The object-oriented programming paradigm has been around since the 1960s and continues to be popular because it provides a set of useful tools for simplifying the structure of a program. Central to the object-oriented style are <em>clasess</em>, definitions of the unique categories of &ldquo;things&rdquo; your code represents.</p>
<h2 id="defining-a-class">Defining a Class</h2>
<p>A class can be deined in its own file or alongside other elements, like functions or variables</p>
<p>###Listing 12.1 Defining the Playerclass (Player.kt)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Player</span>
</span></span></code></pre></div><p>You can define multiple classes in the same file - and you may want to if you have multiple classes usedfor a similiar purpose.</p>
<h2 id="constructing-instances">Constructing Instances</h2>
<h3 id="listing-122-instantiating-a-player-gamekt">Listing 12.2 Instantiating a Player (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> name = <span style="color:#e6db74">&#34;Madrigal&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> healthPoints = <span style="color:#ae81ff">89</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> isBlessed = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> isImmortal = <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> player = Player()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Aura
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">val</span> auraColor = auraColor(isBlessed, healthPoints, isImmortal)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Player status
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">val</span> healthStatus = formatHealthStatus(healthPoints, isBlessed)
</span></span><span style="display:flex;"><span>    printPlayerStatus(auraColor, isBlessed, name, healthStatus)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    castFireball()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><p>When you start a new game, the <strong>main</strong> function is called, and one of the first things that you will want to do is create a player character to play the game.</p>
<p>You called <strong>Player&rsquo;s</strong> <em>primary constructor</em> by suffixing the <strong>Player</strong> class name with parentheses. The player variable is now said to &ldquo;contains an instance of the <strong>Player</strong> class&rdquo;</p>
<h2 id="class-function">Class Function</h2>
<p>Class definition can be specify two types of content: <em>behavior</em> and <em>data</em></p>
<h3 id="listing-123-defining-a-class-function-playerkt">Listing 12.3 Defining a class function (Player.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Player</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">castFireball</span>(numFireballs: Int = <span style="color:#ae81ff">2</span>) = println(<span style="color:#e6db74">&#34;A glass of Fireball springs into existence. (x</span><span style="color:#e6db74">$numFireballs</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Here you define a <em>class body</em> for <strong>Player</strong> with curly braces. The class body holds definitions for the class&rsquo;s behavior and data, much like the actions of a function are defines within the function body.</p>
<h3 id="listing-124-calling-a-class-function-gamekt">Listing 12.4 Calling a class function (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> healthPoints = <span style="color:#ae81ff">89</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> isBlessed = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> isImmortal = <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> player = Player()
</span></span><span style="display:flex;"><span>&gt;&gt;  player.castFireball()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Aura
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">val</span> auraColor = auraColor(isBlessed, healthPoints, isImmortal)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Player status
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">val</span> healthStatus = formatHealthStatus(healthPoints, isBlessed)
</span></span><span style="display:flex;"><span>    printPlayerStatus(auraColor, isBlessed, player.name, healthStatus)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;&lt;  castFireball()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">castFireball</span>(numFireballs: Int = <span style="color:#ae81ff">2</span>) =
</span></span><span style="display:flex;"><span>&lt;&lt;              println(<span style="color:#e6db74">&#34;A glass of Fireball springs into existence. (x</span><span style="color:#e6db74">$numFireballs</span><span style="color:#e6db74">)&#34;</span>)
</span></span></code></pre></div><h2 id="visibility-and-encapsulation">Visibility and Encapsulation</h2>
<p>Encapsulation says that a class should selectively expose funtions and properties to define how other objects interact with it. Anything that is not essential to expose, including implementations details of exposed functions and properties, should be kept private.</p>
<h3 id="table-122-visibility-modifiers">Table 12.2 Visibility modifiers.</h3>
<table>
<thead>
<tr>
<th>Modifier</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>public (default)</td>
<td>The function or property will be accessible by code outside of the class, By default, functions and properties without  a visibility modifier are public</td>
</tr>
<tr>
<td>private</td>
<td>The function or property will be accessible only within the same class</td>
</tr>
<tr>
<td>protected</td>
<td>The function or property will be accessible only within the same class ot its subclass</td>
</tr>
<tr>
<td>internal</td>
<td>The function or property will be accessible within the same module</td>
</tr>
</tbody>
</table>
<h2 id="class-properties">Class Properties</h2>
<p>Class function definitions describe the behavior associated with a class, Data definitions, better known as <em>class properties</em>, are the attribbutes required to represent the specific state or characteristics of a class.</p>
<h3 id="listing-125-defining-the-name-property-playerkt">Listing 12.5 Defining the name property (Player.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Player</span> {
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> name = <span style="color:#e6db74">&#34;madrigal&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">castFireball</span>(numFireballs: Int = <span style="color:#ae81ff">2</span>) =
</span></span><span style="display:flex;"><span>            println(<span style="color:#e6db74">&#34;A glass of Fireball springs into existence. (x</span><span style="color:#e6db74">$numFireballs</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-127-resolving-the-reference-to-players-name-property-gamekt">Listing 12.7 Resolving the reference to Playerâ€™s name property (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Player status
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>&lt;&lt;  printPlayerStatus(auraColor, isBlessed, player, healthStatus)
</span></span><span style="display:flex;"><span>&gt;&gt;  printPlayerStatus(auraColor, isBlessed, player.name, healthStatus)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><h2 id="property-getters-and-setters">Property getters and setters</h2>
<p>For eache property you define, kotlin will generate a <em>field</em>, a <em>getter</em>, and, if needed, a setter. A field is where the data for a proeprty is stored, you cannot directly define a filed on a class. Kotlin encapsulates the field for you, protecting the data in the field and exposing it via getters and setters. A property&rsquo;s getter specifies how the property is read. Getter are generated for every property.</p>
<h3 id="listing-128-defining-a-custom-getter-playerkt">Listing 12.8 Defining a custom getter (Player.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Player</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> name = <span style="color:#e6db74">&#34;madrigal&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;      <span style="color:#66d9ef">get</span>() = <span style="color:#66d9ef">field</span>.capitalize()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">castFireball</span>(numFireballs: Int = <span style="color:#ae81ff">2</span>) =
</span></span><span style="display:flex;"><span>            println(<span style="color:#e6db74">&#34;A glass of Fireball springs into existence. (x</span><span style="color:#e6db74">$numFireballs</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-129-defining-a-custom-setter-playerkt">Listing 12.9 Defining a custom setter (Player.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Player</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> name = <span style="color:#e6db74">&#34;madrigal&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span>() = <span style="color:#66d9ef">field</span>.capitalize()
</span></span><span style="display:flex;"><span>&gt;&gt;      <span style="color:#66d9ef">set</span>(<span style="color:#66d9ef">value</span>) {
</span></span><span style="display:flex;"><span>&gt;&gt;          <span style="color:#66d9ef">field</span> = <span style="color:#66d9ef">value</span>.trim()
</span></span><span style="display:flex;"><span>&gt;&gt;      }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">castFireball</span>(numFireballs: Int = <span style="color:#ae81ff">2</span>) =
</span></span><span style="display:flex;"><span>            println(<span style="color:#e6db74">&#34;A glass of Fireball springs into existence. (x</span><span style="color:#e6db74">$numFireballs</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="property-visibility">Property visibility</h2>
<p>Properties are different from variables defined locally within a function. When a property is defined, it is defined at the class level. As such, it may be accessible to other classes, it its visibility allows.</p>
<p>The peroperties provide fine-grained control around reading and modifying data through their getters and setters. All properties have getters - and all var properties have setters - whether you define custom behavior for them or not.</p>
<h3 id="listing-1212-hiding-namessetter-playerkt">Listing 12.12 Hiding nameâ€™ssetter (Player.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Player</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> name = <span style="color:#e6db74">&#34;madrigal&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">get</span>() = <span style="color:#66d9ef">field</span>.capitalize()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">set</span>(<span style="color:#66d9ef">value</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">field</span> = <span style="color:#66d9ef">value</span>.trim()
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">castFireball</span>(numFireballs: Int = <span style="color:#ae81ff">2</span>) =
</span></span><span style="display:flex;"><span>            println(<span style="color:#e6db74">&#34;A glass of Fireball springs into existence. (x</span><span style="color:#e6db74">$numFireballs</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="computed-properties">Computed properties</h2>
<p>Earlier, we said that when you define a property,a field is always generated to store the value the property encapsulates. That is true&hellip; except in a particular case: <em>computer properties</em>. A computed property is a property that is specified with an overridden <strong>get</strong> and /or <strong>set</strong> operator in a way that makes a field unnecessary.</p>
<h3 id="listing-1213-defining-a-computed-property-repl">Listing 12.13 Defining a computed property (REPL)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Dice</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> rolledValue
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span>() = (<span style="color:#ae81ff">1.</span>.<span style="color:#ae81ff">6</span>).shuffled().first()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-1214-accessing-the-computed-property-repl">Listing 12.14 Accessing the computed property (REPL)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> myD6 = Dice()
</span></span><span style="display:flex;"><span>myD6.rolledValue
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span>myD6.rolledValue
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>myD6.rolledValue
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">4</span>
</span></span></code></pre></div><h3 id="listing-1216-adding-properties-to-player-playerkt">Listing 12.16 Adding properties to Player (Player.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Player</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> name = <span style="color:#e6db74">&#34;madrigal&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span>() = <span style="color:#66d9ef">field</span>.capitalize()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">set</span>(<span style="color:#66d9ef">value</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">field</span> = <span style="color:#66d9ef">value</span>.trim()
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">var</span> healthPoints = <span style="color:#ae81ff">89</span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> isBlessed = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> isImmortal = <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">castFireball</span>(numFireballs: Int = <span style="color:#ae81ff">2</span>) =
</span></span><span style="display:flex;"><span>            println(<span style="color:#e6db74">&#34;A glass of Fireball springs into existence. (x</span><span style="color:#e6db74">$numFireballs</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-1217-encapsulating-isimmortal-within-player-playerkt">Listing 12.17 Encapsulating isImmortal within Player (Player.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Player</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> name = <span style="color:#e6db74">&#34;madrigal&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span>() = <span style="color:#66d9ef">field</span>.capitalize()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">set</span>(<span style="color:#66d9ef">value</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">field</span> = <span style="color:#66d9ef">value</span>.trim()
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> healthPoints = <span style="color:#ae81ff">89</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> isBlessed = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> isImmortal = <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">castFireball</span>(numFireballs: Int = <span style="color:#ae81ff">2</span>) =
</span></span><span style="display:flex;"><span>            println(<span style="color:#e6db74">&#34;A glass of Fireball springs into existence. (x</span><span style="color:#e6db74">$numFireballs</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-1219-adding-class-functions-to-player-playerkt">Listing 12.19 Adding class functions to Player (Player.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Player</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> name = <span style="color:#e6db74">&#34;madrigal&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span>() = <span style="color:#66d9ef">field</span>.capitalize()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">set</span>(<span style="color:#66d9ef">value</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">field</span> = <span style="color:#66d9ef">value</span>.trim()
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> healthPoints = <span style="color:#ae81ff">89</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> isBlessed = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> isImmortal = <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">auraColor</span>(isBlessed: Boolean,
</span></span><span style="display:flex;"><span>&gt;&gt;                        healthPoints: Int,
</span></span><span style="display:flex;"><span>&gt;&gt;                        isImmortal: Boolean): String {
</span></span><span style="display:flex;"><span>&gt;&gt;      <span style="color:#66d9ef">val</span> auraVisible = isBlessed <span style="color:#f92672">&amp;&amp;</span> healthPoints &gt; <span style="color:#ae81ff">50</span> <span style="color:#f92672">||</span> isImmortal
</span></span><span style="display:flex;"><span>&gt;&gt;      <span style="color:#66d9ef">val</span> auraColor = <span style="color:#66d9ef">if</span> (auraVisible) <span style="color:#e6db74">&#34;GREEN&#34;</span> <span style="color:#66d9ef">else</span> <span style="color:#e6db74">&#34;NONE&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;      <span style="color:#66d9ef">return</span> auraColor
</span></span><span style="display:flex;"><span>&gt;&gt;  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">formatHealthStatus</span>(healthPoints: Int, isBlessed: Boolean) =
</span></span><span style="display:flex;"><span>&gt;&gt;          <span style="color:#66d9ef">when</span> (healthPoints) {
</span></span><span style="display:flex;"><span>&gt;&gt;              <span style="color:#ae81ff">100</span> <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;is in excellent condition!&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;              <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">90.</span>.<span style="color:#ae81ff">99</span> <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;has a few scratches.&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;              <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">75.</span>.<span style="color:#ae81ff">89</span> <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">if</span> (isBlessed) {
</span></span><span style="display:flex;"><span>&gt;&gt;                  <span style="color:#e6db74">&#34;has some minor wounds, but is healing quite quickly!&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;              } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>&gt;&gt;                  <span style="color:#e6db74">&#34;has some minor wounds.&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;              }
</span></span><span style="display:flex;"><span>&gt;&gt;              <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">15.</span>.<span style="color:#ae81ff">74</span> <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;looks pretty hurt.&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;              <span style="color:#66d9ef">else</span> <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;is in awful condition!&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;          }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">castFireball</span>(numFireballs: Int = <span style="color:#ae81ff">2</span>) =
</span></span><span style="display:flex;"><span>            println(<span style="color:#e6db74">&#34;A glass of Fireball springs into existence. (x</span><span style="color:#e6db74">$numFireballs</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-1220-removing-unnecessary-parameters-from-class-functions-playerkt">Listing 12.20 Removing unnecessary parameters from class functions (Player.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Player</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> name = <span style="color:#e6db74">&#34;madrigal&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span>() = <span style="color:#66d9ef">field</span>.capitalize()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">set</span>(<span style="color:#66d9ef">value</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">field</span> = <span style="color:#66d9ef">value</span>.trim()
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> healthPoints = <span style="color:#ae81ff">89</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> isBlessed = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> isImmortal = <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">auraColor</span>(isBlessed: Boolean, healthPoints: Int, isImmortal: Boolean): String {
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">auraColor</span>(): String {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> auraVisible = isBlessed <span style="color:#f92672">&amp;&amp;</span> healthPoints &gt; <span style="color:#ae81ff">50</span> <span style="color:#f92672">||</span> isImmortal
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> auraColor = <span style="color:#66d9ef">if</span> (auraVisible) <span style="color:#e6db74">&#34;GREEN&#34;</span> <span style="color:#66d9ef">else</span> <span style="color:#e6db74">&#34;NONE&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> auraColor
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">formatHealthStatus</span>(healthPoints: Int, isBlessed: Boolean) =
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">formatHealthStatus</span>() =
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">when</span> (healthPoints) {
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">100</span> <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;is in excellent condition!&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">90.</span>.<span style="color:#ae81ff">99</span> <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;has a few scratches.&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">75.</span>.<span style="color:#ae81ff">89</span> <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">if</span> (isBlessed) {
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;has some minor wounds, but is healing quite quickly!&#34;</span>
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;has some minor wounds.&#34;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">in</span> <span style="color:#ae81ff">15.</span>.<span style="color:#ae81ff">74</span> <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;looks pretty hurt.&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">else</span> <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;is in awful condition!&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">castFireball</span>(numFireballs: Int = <span style="color:#ae81ff">2</span>) =
</span></span><span style="display:flex;"><span>            println(<span style="color:#e6db74">&#34;A glass of Fireball springs into existence. (x</span><span style="color:#e6db74">$numFireballs</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-1221-making-class-functions-public-playerkt">Listing 12.21 Making class functions public (Player.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Player</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> name = <span style="color:#e6db74">&#34;madrigal&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span>() = <span style="color:#66d9ef">field</span>.capitalize()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">set</span>(<span style="color:#66d9ef">value</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">field</span> = <span style="color:#66d9ef">value</span>.trim()
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> healthPoints = <span style="color:#ae81ff">89</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> isBlessed = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> isImmortal = <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">auraColor</span>(): String {
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">auraColor</span>(): String {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">formatHealthStatus</span>() = <span style="color:#66d9ef">when</span> (healthPoints) {
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">formatHealthStatus</span>() = <span style="color:#66d9ef">when</span> (healthPoints) {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">castFireball</span>(numFireballs: Int = <span style="color:#ae81ff">2</span>) =
</span></span><span style="display:flex;"><span>            println(<span style="color:#e6db74">&#34;A glass of Fireball springs into existence. (x</span><span style="color:#e6db74">$numFireballs</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-1222-calling-class-functions-gamekt">Listing 12.22 Calling class functions (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> player = Player()
</span></span><span style="display:flex;"><span>    player.castFireball()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Aura
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>&lt;&lt;  <span style="color:#66d9ef">val</span> auraColor = player.auraColor(isBlessed, healthPoints, isImmortal)
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> auraColor = player.auraColor()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Player status
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>&lt;&lt;  <span style="color:#66d9ef">val</span> healthStatus = formatHealthStatus(healthPoints, isBlessed)
</span></span><span style="display:flex;"><span>&lt;&lt;    printPlayerStatus(playerauraColor, isBlessed, player.name, healthStatus)
</span></span><span style="display:flex;"><span>&gt;&gt;    printPlayerStatus(player)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Aura
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>&lt;&lt;  player.auraColor(isBlessed, healthPoints, isImmortal)
</span></span><span style="display:flex;"><span>&gt;&gt;  player.auraColor()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;&lt;<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">printPlayerStatus</span>(player: PlayerauraColor: String, isBlessed: Boolean, name: String,healthStatus: String) {
</span></span><span style="display:flex;"><span>&gt;&gt;<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">printPlayerStatus</span>(player: Player) {
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;(Aura: </span><span style="color:#e6db74">${player.auraColor()}</span><span style="color:#e6db74">) &#34;</span> +
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;(Blessed: </span><span style="color:#e6db74">${if (player.isBlessed) &#34;YES&#34; else &#34;NO&#34;}</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${player.name}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">${player.formatHealthStatus()}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h1 id="13-initialization">13. Initialization.</h1>
<p>When yoy initialize a variable, property, or class instancem you assign it an initial value to make it ready for use.</p>
<p>An object is <em>instantiated</em> when memory is allocated for it, and it is <em>initialized</em> when it is assigned a value. However, in practice the terms are often used slightly differently. Often, <em>initialization</em> is used to mean &ldquo;everything required to amke a variable, property, or class instance ready to use&rdquo; while <em>instatiation</em> tends to be limited to &ldquo;creating an instance of a class&rdquo;.</p>
<h2 id="constructors">Constructors</h2>
<p>A constructor allows its caller to specify the initial calues that an instance of a class will require in order to be constructed, Those values are then available for assignment to the properties defined within the class.</p>
<h2 id="primary-contrsuctors">Primary Contrsuctors</h2>
<p>Like a function, a contructor defines expected parameters that must be provided as argument.</p>
<h3 id="listing-131-defining-a-primary-constructor-playertk">Listing 13.1 Defining a primary constructor (Player.tk)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Player</span>(_name: String,
</span></span><span style="display:flex;"><span>             _healthPoints: Int,
</span></span><span style="display:flex;"><span>             _isBlessed: Boolean,
</span></span><span style="display:flex;"><span>             _isImmortal: Boolean){
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> name = _name
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span>() = <span style="color:#66d9ef">field</span>.capitalize()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">set</span>(<span style="color:#66d9ef">value</span>){
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">field</span> = <span style="color:#66d9ef">value</span>.trim()
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> healthPoints = _healthPoints
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> isBlessed = _isBlessed
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> isImmortal = _isImmortal
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-132-calling-the-primary-constructor-gametk">Listing 13.2 Calling the primary constructor (Game.tk)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;){
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> player = Player(<span style="color:#e6db74">&#34;Madrigal&#34;</span>, <span style="color:#ae81ff">89</span>, <span style="color:#66d9ef">true</span>, <span style="color:#66d9ef">false</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="defining-properties-in-a-primery-constructor">Defining properties in a primery constructor</h2>
<h3 id="listing-133-defining-properties-in-the-primery-constructor-playertk">Listing 13.3 Defining properties in the primery constructor (Player.tk)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Player</span>(_name: String,
</span></span><span style="display:flex;"><span>&lt;&lt;           _healthPoints: Int,
</span></span><span style="display:flex;"><span>&gt;&gt;           <span style="color:#66d9ef">var</span> healthPoints: Int,
</span></span><span style="display:flex;"><span>&lt;&lt;           _isBlessed: Boolean,
</span></span><span style="display:flex;"><span>&gt;&gt;           <span style="color:#66d9ef">val</span> isBlessed: Boolean,
</span></span><span style="display:flex;"><span>&lt;&lt;           _isImmortal: Boolean
</span></span><span style="display:flex;"><span>&gt;&gt;           <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> isImmortal: Boolean){
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> name = _name
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span>() = <span style="color:#66d9ef">field</span>.capitalize()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">set</span>(<span style="color:#66d9ef">value</span>){
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">field</span> = <span style="color:#66d9ef">value</span>.trim()
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">var</span> healthPoints = _healthPoints
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">val</span> isBlessed = _isBlessed
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> isImmortal = _isImmortal
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="secondary-constructors">Secondary constructors</h2>
<p>Constructors come in two flavors: primary and secondary. When you specify a primary constructor, you say, &ldquo;These parameters are required for any instance of this class&rdquo;. When you specify a secondary constructor, you provide alternative ways to construct the class (while still meeting the requirements of the primary constructor)</p>
<p>A secondary constructor must either call the primary constructor, providing it all of the arguments it requires, or call through to another secondary constructor.</p>
<h3 id="listing-134-defining-a-secondary-constructor-playerkt">Listing 13.4 Defining a secondary constructor (Player.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Player</span>(_name: String,
</span></span><span style="display:flex;"><span>             <span style="color:#66d9ef">var</span> healthPoints: Int,
</span></span><span style="display:flex;"><span>             <span style="color:#66d9ef">val</span> isBlessed: Boolean,
</span></span><span style="display:flex;"><span>             <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> isImmortal: Boolean){
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> name = _name
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span>() = <span style="color:#66d9ef">field</span>.capitalize()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">set</span>(<span style="color:#66d9ef">value</span>){
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">field</span> = <span style="color:#66d9ef">value</span>.trim()
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">constructor</span>(name: String) : <span style="color:#66d9ef">this</span>(namem,
</span></span><span style="display:flex;"><span>                                     healthPoints = <span style="color:#ae81ff">100</span>,
</span></span><span style="display:flex;"><span>                                     isBlessed = <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>                                     isImmortal = <span style="color:#66d9ef">false</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>You can define multiple secondary constructors for different combinations of parameters. This secondary constructor calls through to the primary constructor with a certain set of paramters. The <em>this</em> keyword in this case refers to the instance of the class for which this constructor is defined, Specifically, <em>this</em> is calling into another constructor defined in the class - the primary constructor.</p>
<h3 id="listing-135-calling-a-secondary-constructor-gametk">Listing 13.5 Calling a secondary constructor (Game.tk)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;){
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">val</span> player = Player(<span style="color:#e6db74">&#34;Mandrigal&#34;</span>, <span style="color:#ae81ff">89</span>, <span style="color:#66d9ef">true</span>, <span style="color:#66d9ef">false</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> player = Player(<span style="color:#e6db74">&#34;Mandrigal&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>You can also use a secondary constructor to define initialization logic - code that will run when your class is instantied.</p>
<h3 id="listing--136-adding-logic-to-a-secondary-constructor-playerkt">Listing  13.6 Adding logic to a secondary constructor (Player.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Player</span>(_name: String,
</span></span><span style="display:flex;"><span>             <span style="color:#66d9ef">var</span> healthPoints: Int,
</span></span><span style="display:flex;"><span>             <span style="color:#66d9ef">val</span> isBlessed: Boolean,
</span></span><span style="display:flex;"><span>             <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> isImmortal: Boolean){
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> name = _name
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span>() = <span style="color:#66d9ef">field</span>.capitalize()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">set</span>(<span style="color:#66d9ef">value</span>){
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">field</span> = <span style="color:#66d9ef">value</span>.trim()
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">constructor</span>(name: String) : <span style="color:#66d9ef">this</span>(namem,
</span></span><span style="display:flex;"><span>                                     healthPoints = <span style="color:#ae81ff">100</span>,
</span></span><span style="display:flex;"><span>                                     isBlessed = <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>                                     isImmortal = <span style="color:#66d9ef">false</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(name.toLowerCase() <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;kar&#34;</span>) healthPoints = <span style="color:#ae81ff">40</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span></code></pre></div><h2 id="default-arguments-1">Default arguments</h2>
<p>When defining a constructorm you can also specify default values that should be assigned if an argument is not provided for a specific paramter.</p>
<h3 id="listing-137-defining-a-default-argument-in-a-constructor-playerkt">Listing 13.7 Defining a default argument in a constructor (Player.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Player</span>(_name: String,
</span></span><span style="display:flex;"><span>&gt;&gt;           <span style="color:#66d9ef">var</span> healthPoints: Int = <span style="color:#ae81ff">100</span>,
</span></span><span style="display:flex;"><span>             <span style="color:#66d9ef">val</span> isBlessed: Boolean,
</span></span><span style="display:flex;"><span>             <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> isImmortal: Boolean){
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> name = _name
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span>() = <span style="color:#66d9ef">field</span>.capitalize()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">set</span>(<span style="color:#66d9ef">value</span>){
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">field</span> = <span style="color:#66d9ef">value</span>.trim()
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">constructor</span>(name: String) : <span style="color:#66d9ef">this</span>(namem,
</span></span><span style="display:flex;"><span>&lt;&lt;                                   healthPoints = <span style="color:#ae81ff">100</span>,
</span></span><span style="display:flex;"><span>                                     isBlessed = <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>                                     isImmortal = <span style="color:#66d9ef">false</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(name.toLowerCase() <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;kar&#34;</span>) healthPoints = <span style="color:#ae81ff">40</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span></code></pre></div><h2 id="named-arguments">Named arguments</h2>
<p>The more default arguments you use, the more options you have for calling your contructor, More options can open the door for more ambiguity, si kotlin provides named constructor arguments, just like the named arguments that you have used to call functions.</p>
<p>You may have notice that the secondary constructor you wrote for Player used named arguments.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">constructor</span>(name: String) :  <span style="color:#66d9ef">this</span>(name,
</span></span><span style="display:flex;"><span>                                  healthPoints = <span style="color:#ae81ff">100</span>,
</span></span><span style="display:flex;"><span>                                  isBlessed = <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>                                  isImmortal = <span style="color:#66d9ef">false</span>)
</span></span></code></pre></div><p>When you have more than a few arguments to provide to a constructor or function, we recommend using named paramters.</p>
<h2 id="initializer-blocks">Initializer Blocks</h2>
<p>In addition to the primary and secondary constructors you can also specify an <em>initializer block</em> for a class in kotlin. The initializer block is a way to set up variables or calues as well as perform validation - like checking to make sure that the argument to the constructor are valid ones.</p>
<p>Use an initializer block, denoted by the <strong>init</strong> keyword, to enforce there requirements with preconditions.</p>
<h3 id="listing-138-defining-an-initializar-block-playerkt">Listing 13.8 Defining an initializar block (Player.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Player</span>(_name: String,
</span></span><span style="display:flex;"><span>             <span style="color:#66d9ef">var</span> healthPoints: Int = <span style="color:#ae81ff">100</span>,
</span></span><span style="display:flex;"><span>             <span style="color:#66d9ef">val</span> isBlessed: Boolean,
</span></span><span style="display:flex;"><span>             <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> isImmortal: Boolean){
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> name = _name
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span>() = <span style="color:#66d9ef">field</span>.capitalize()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">set</span>(<span style="color:#66d9ef">value</span>){
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">field</span> = <span style="color:#66d9ef">value</span>.trim()
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">init</span>{
</span></span><span style="display:flex;"><span>&gt;&gt;      require(healthPoints &gt; <span style="color:#ae81ff">0</span>, {<span style="color:#e6db74">&#34;healthPoints must be greater than zero.&#34;</span>})
</span></span><span style="display:flex;"><span>&gt;&gt;      require(name.usNotBlank(), {<span style="color:#e6db74">&#34;Player must have a name.&#34;</span>})
</span></span><span style="display:flex;"><span>&gt;&gt;  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">constructor</span>(name: String) : <span style="color:#66d9ef">this</span>(namem,
</span></span><span style="display:flex;"><span>                                     isBlessed = <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>                                     isImmortal = <span style="color:#66d9ef">false</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(name.toLowerCase() <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;kar&#34;</span>) healthPoints = <span style="color:#ae81ff">40</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span></code></pre></div><h2 id="property-initialization">Property initialization.</h2>
<p>So far, you have seen a property initialized in two ways  - either assigned to a value passed as an argument, or defined _inline_in a primary constructor.
A property can (and must) be initialized with any value of its type, including function return values.</p>
<h3 id="listing-139-defining-the-hometown-property-playerkt">Listing 13.9 Defining the hometown property (Player.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Player</span>(_name: String,
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">var</span> healthPoints: Int = <span style="color:#ae81ff">100</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">val</span> isBlessed: Boolean,
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> isImmortal: Boolean){
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">var</span> name = _name
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">get</span>() = <span style="color:#66d9ef">field</span>.capitalize()
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">set</span>(<span style="color:#66d9ef">value</span>){
</span></span><span style="display:flex;"><span>           <span style="color:#66d9ef">field</span> = <span style="color:#66d9ef">value</span>.trim()
</span></span><span style="display:flex;"><span>       }
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">val</span> hometown : String
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">init</span>{
</span></span><span style="display:flex;"><span>       require(healthPoints &gt; <span style="color:#ae81ff">0</span>, {<span style="color:#e6db74">&#34;healthPoints must be greater than zero.&#34;</span>})
</span></span><span style="display:flex;"><span>       require(name.usNotBlank(), {<span style="color:#e6db74">&#34;Player must have a name.&#34;</span>})
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">constructor</span>(name: String) : <span style="color:#66d9ef">this</span>(namem,
</span></span><span style="display:flex;"><span>                                    isBlessed = <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>                                    isImmortal = <span style="color:#66d9ef">false</span>) {
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">if</span>(name.toLowerCase() <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;kar&#34;</span>) healthPoints = <span style="color:#ae81ff">40</span>
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">..</span>.
</span></span></code></pre></div><p>In this case you have defined hometown, but you not yet satisfied the kotlin compiler. You must assign an initial value when defining a property.</p>
<h3 id="listing-1310-defining-the-__selecthometown__-function-playerkt">Listing 13.10 Defining the <strong>selectHometown</strong> function (Player.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>importz java.io.File
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Player</span>(_name: String,
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">var</span> healthPoints: Int = <span style="color:#ae81ff">100</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">val</span> isBlessed: Boolean,
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> isImmortal: Boolean){
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">var</span> name = _name
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">get</span>() = <span style="color:#66d9ef">field</span>.capitalize()
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">set</span>(<span style="color:#66d9ef">value</span>){
</span></span><span style="display:flex;"><span>           <span style="color:#66d9ef">field</span> = <span style="color:#66d9ef">value</span>.trim()
</span></span><span style="display:flex;"><span>       }
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">val</span> hometown : String
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">init</span>{
</span></span><span style="display:flex;"><span>       require(healthPoints &gt; <span style="color:#ae81ff">0</span>, {<span style="color:#e6db74">&#34;healthPoints must be greater than zero.&#34;</span>})
</span></span><span style="display:flex;"><span>       require(name.usNotBlank(), {<span style="color:#e6db74">&#34;Player must have a name.&#34;</span>})
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">constructor</span>(name: String) : <span style="color:#66d9ef">this</span>(namem,
</span></span><span style="display:flex;"><span>                                    isBlessed = <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>                                    isImmortal = <span style="color:#66d9ef">false</span>) {
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">if</span>(name.toLowerCase() <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;kar&#34;</span>) healthPoints = <span style="color:#ae81ff">40</span>
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">selectHometown</span>() = File(<span style="color:#e6db74">&#34;data/towns.txt&#34;</span>)
</span></span><span style="display:flex;"><span>       .readText()
</span></span><span style="display:flex;"><span>       .split(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>       .shuffled()
</span></span><span style="display:flex;"><span>       .first()
</span></span><span style="display:flex;"><span>   <span style="color:#f92672">..</span>.
</span></span></code></pre></div><h3 id="listing-1311-using-the-hometown-property-playerkt">Listing 13.11 Using the hometown property (Player.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span> importz java.io.File
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Player</span>(_name: String,
</span></span><span style="display:flex;"><span>             <span style="color:#66d9ef">var</span> healthPoints: Int = <span style="color:#ae81ff">100</span>,
</span></span><span style="display:flex;"><span>             <span style="color:#66d9ef">val</span> isBlessed: Boolean,
</span></span><span style="display:flex;"><span>             <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> isImmortal: Boolean){
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> name = _name
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span>() = <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${field.capitalize()}</span><span style="color:#e6db74"> of </span><span style="color:#e6db74">$hometown</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">set</span>(<span style="color:#66d9ef">value</span>){
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">field</span> = <span style="color:#66d9ef">value</span>.trim()
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> hometown : String
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">init</span>{
</span></span><span style="display:flex;"><span>        require(healthPoints &gt; <span style="color:#ae81ff">0</span>, {<span style="color:#e6db74">&#34;healthPoints must be greater than zero.&#34;</span>})
</span></span><span style="display:flex;"><span>        require(name.usNotBlank(), {<span style="color:#e6db74">&#34;Player must have a name.&#34;</span>})
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">constructor</span>(name: String) : <span style="color:#66d9ef">this</span>(namem,
</span></span><span style="display:flex;"><span>                                     isBlessed = <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>                                     isImmortal = <span style="color:#66d9ef">false</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span>(name.toLowerCase() <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;kar&#34;</span>) healthPoints = <span style="color:#ae81ff">40</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">selectHometown</span>() = File(<span style="color:#e6db74">&#34;data/towns.txt&#34;</span>)
</span></span><span style="display:flex;"><span>        .readText()
</span></span><span style="display:flex;"><span>        .split(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        .shuffled()
</span></span><span style="display:flex;"><span>        .first()
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span></code></pre></div><h2 id="late-initialization">Late Initialization</h2>
<p><em>late initialization</em> becomes importan - and more than just a simple bending of kotlin&rsquo;s rule on initializacion</p>
<p>Any <em>var</em> property declaration can be appendedwith the <strong>lateinit</strong> keyword, and the kotlin compiler will let you put off initializing the property until you assign it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Player</span>{
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">lateinit</span> <span style="color:#66d9ef">var</span> aligment: String
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">determineFate</span>(){
</span></span><span style="display:flex;"><span>       aligment = <span style="color:#e6db74">&#34;Good&#34;</span>
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">proclaimFate</span>(){
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">if</span>(<span style="color:#f92672">::</span>aligment.isInitialized) println(aligment)
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>The <em>lateinit</em> keywordfunctions as acontract that you make with yourself: &ldquo;I take the responsibility for initializing this variable before it is accessed&rdquo;. You can check <strong>isInitialized</strong> when there is any uncertainty about whether the lateinit variable is initialized to avoid an <em>UnitializedPropertyAccessException</em>.</p>
<h2 id="lazy-initialization">Lazy initialization</h2>
<p>Lazy initialization is implemented in kotlin using a mechanism known as a <em>delegate</em>. Delegate define templates for how a property is initialized.</p>
<p>You use a delegate with the keyboard. The kotlin standard library includes some delegates that are alredy implemented for you, and __lazy__is one of them.
Lazy initialization takes a lambda in wich you define any code that you wish to execute when your property is initialized.</p>
<h3 id="listing-1312-lazily-initializing-hometown-playerkt">Listing 13.12 Lazily initializing hometown (Player.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Player</span>(_name: String,
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">var</span> healthPoints: Int = <span style="color:#ae81ff">100</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">val</span> isBlessed: Boolean
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> isImmortal: Boolean) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> name = _name
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span>() = <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${field.capitalize()}</span><span style="color:#e6db74"> of </span><span style="color:#e6db74">$hometown</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">set</span>(<span style="color:#66d9ef">value</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">field</span> = <span style="color:#66d9ef">value</span>.trim()
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">val</span> hometown = selectHometown()
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> hometown <span style="color:#66d9ef">by</span> lazy { selectHometown() }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">selectHometown</span>() = File(<span style="color:#e6db74">&#34;towns.txt&#34;</span>)
</span></span><span style="display:flex;"><span>            .readText()
</span></span><span style="display:flex;"><span>            .split(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>            .shuffled()
</span></span><span style="display:flex;"><span>            .first()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>In this lambda, the result of <strong>selectHometown</strong> is implicity returned and assigned to hometown.</p>
<p>hometown remains unitialized until it is reference for the first time. At that point, all of the code in <strong>lazy</strong>&rsquo;s lambda is executed. Importantly, this code is only execute once - on the first time that the delefate property (hometown, here) us accessed in name&rsquo;s getter. Future access to the lazy property will use a cached result instead of performing the expinsuce computation again.</p>
<p>Late initialization is useful, but it can be a bit verbose, so stick to using lazy initializacion for more computationally need tasks.</p>
<h1 id="14-inhertance">14. Inhertance</h1>
<p><em>Inheritance</em> is an object-oriented principle you can use to define hierarchical relation ships between types.</p>
<h2 id="defining-the-room-class">Defining the Room Class</h2>
<h3 id="listing-141-declaring-the-room-class-roomkt">Listing 14.1 Declaring the Room class (Room.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Room</span>(<span style="color:#66d9ef">val</span> name: String) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">description</span>() = <span style="color:#e6db74">&#34;Room: </span><span style="color:#e6db74">$name</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">load</span>() = <span style="color:#e6db74">&#34;Nothing much to see here...&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-142-printing-the-room-description-gamekt">Listing 14.2 Printing the room description (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> player = Player(<span style="color:#e6db74">&#34;Madrigal&#34;</span>)
</span></span><span style="display:flex;"><span>    player.castFireball()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> currentRoom = Room(<span style="color:#e6db74">&#34;Foyer&#34;</span>)
</span></span><span style="display:flex;"><span>    println(currentRoom.description())
</span></span><span style="display:flex;"><span>    println(currentRoom.load())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Player status
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    printPlayerStatus(player)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><h2 id="creating-a-subclass">Creating a Subclass</h2>
<p>A <em>subclass</em> share all properties wuth the class it inherits from, commonly known as the parent class or <em>superclass</em></p>
<p>Add open keyword to <strong>Room</strong> so that can be subclassed</p>
<h3 id="listing-143-making-the-room-class-open-for-subclassing-roomkt">Listing 14.3 Making the Room class open for subclassing (Room.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">open</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Room</span>(<span style="color:#66d9ef">val</span> name: String) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">description</span>() = <span style="color:#e6db74">&#34;Room: </span><span style="color:#e6db74">$name</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">load</span>() = <span style="color:#e6db74">&#34;Nothing much to see here...&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-144-declaring-the-townsquare-class-roomkt">Listing 14.4 Declaring the TownSquare class (Room.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">open</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Room</span>(<span style="color:#66d9ef">val</span> name: String) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">description</span>() = <span style="color:#e6db74">&#34;Room: </span><span style="color:#e6db74">$name</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">load</span>() = <span style="color:#e6db74">&#34;Nothing much to see here...&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TownSquare</span> : Room(<span style="color:#e6db74">&#34;Town Square&#34;</span>)
</span></span></code></pre></div><p>The class declaration includes the class name to the left : <strong>operator</strong> and constructor invocation to the right.</p>
<p>Override load in the class using the override keyword</p>
<h3 id="listing-145-declaring-the-townsquare-class-roomkt">Listing 14.5 Declaring the TownSquare class (Room.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">open</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Room</span>(<span style="color:#66d9ef">val</span> name: String) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">description</span>() = <span style="color:#e6db74">&#34;Room: </span><span style="color:#e6db74">$name</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">load</span>() = <span style="color:#e6db74">&#34;Nothing much to see here...&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TownSquare</span> : Room(<span style="color:#e6db74">&#34;Town Square&#34;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">load</span>() = <span style="color:#e6db74">&#34;The villagers rally and cheer as you enter!&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-146-declaring-an-open-function-roomkt">Listing 14.6 Declaring an open function (Room.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">open</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Room</span>(<span style="color:#66d9ef">val</span> name: String) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">description</span>() = <span style="color:#e6db74">&#34;Room: </span><span style="color:#e6db74">$name</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">open</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">load</span>() = <span style="color:#e6db74">&#34;Nothing much to see here...&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TownSquare</span> : Room(<span style="color:#e6db74">&#34;Town Square&#34;</span>) {
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">load</span>() = <span style="color:#e6db74">&#34;The villagers rally and cheer as you enter!&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Protected visibility is a third option the restricts visibility to the class in which property or function is defined or to any subclasses of that class.</p>
<h3 id="listing-147-declaring-a-protected-property-roomkt">Listing 14.7 Declaring a protected property (Room.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">open</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Room</span>(<span style="color:#66d9ef">val</span> name: String) {
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">open</span> <span style="color:#66d9ef">val</span> dangerLevel = <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">description</span>() = <span style="color:#e6db74">&#34;Room: </span><span style="color:#e6db74">$name</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span> +
</span></span><span style="display:flex;"><span>&gt;&gt;                      <span style="color:#e6db74">&#34;Danger level: </span><span style="color:#e6db74">$dangerLevel</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">open</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">load</span>() = <span style="color:#e6db74">&#34;Nothing much to see here...&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TownSquare</span> : Room(<span style="color:#e6db74">&#34;Town Square&#34;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">load</span>() = <span style="color:#e6db74">&#34;The villagers rally and cheer as you enter!&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>This scenario is perfect for the <em>protected</em> keyword: you want to expose a property only to the class where the property is defined and its subclasses.</p>
<p>You can reference a class&rsquo;s superclass using the <strong>super</strong> keyword. From therem you have access to any public or protected properties or functions, including, in this case, <em>dangerLevel</em>.</p>
<h3 id="listing-148-overriding-dangerlevel-roomkt">Listing 14.8 Overriding dangerLevel (Room.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">open</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Room</span>(<span style="color:#66d9ef">val</span> name: String) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">open</span> <span style="color:#66d9ef">val</span> dangerLevel = <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">description</span>() = <span style="color:#e6db74">&#34;Room: </span><span style="color:#e6db74">$name</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span> +
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;Danger level: </span><span style="color:#e6db74">$dangerLevel</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">open</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">load</span>() = <span style="color:#e6db74">&#34;Nothing much to see here...&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TownSquare</span> : Room(<span style="color:#e6db74">&#34;Town Square&#34;</span>) {
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">val</span> dangerLevel = <span style="color:#66d9ef">super</span>.dangerLevel - <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">load</span>() = <span style="color:#e6db74">&#34;The villagers rally and cheer as you enter!&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-149-adding-a-new-property-and-function-to-a-subclass-roomkt">Listing 14.9 Adding a new property and function to a subclass (Room.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">open</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Room</span>(<span style="color:#66d9ef">val</span> name: String) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">open</span> <span style="color:#66d9ef">val</span> dangerLevel = <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">description</span>() = <span style="color:#e6db74">&#34;Room: </span><span style="color:#e6db74">$name</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span> +
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;Danger level: </span><span style="color:#e6db74">$dangerLevel</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">open</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">load</span>() = <span style="color:#e6db74">&#34;Nothing much to see here...&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TownSquare</span> : Room(<span style="color:#e6db74">&#34;Town Square&#34;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">val</span> dangerLevel = <span style="color:#66d9ef">super</span>.dangerLevel - <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">var</span> bellSound = <span style="color:#e6db74">&#34;GWONG&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">load</span>() = <span style="color:#e6db74">&#34;The villagers rally and cheer as you enter!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">${ringBell()}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">ringBell</span>() = <span style="color:#e6db74">&#34;The bell tower announces your arrival. </span><span style="color:#e6db74">$bellSound</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-1410-calling-subclass-function-implementation-gamekt">Listing 14.10 Calling subclass function implementation (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> player = Player(<span style="color:#e6db74">&#34;Madrigal&#34;</span>)
</span></span><span style="display:flex;"><span>    player.castFireball()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">var</span> currentRoom: Room = Room(<span style="color:#e6db74">&#34;Foyer&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">var</span> currentRoom: Room = TownSquare()
</span></span><span style="display:flex;"><span>    println(currentRoom.description())
</span></span><span style="display:flex;"><span>    println(currentRoom.load())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Player status
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    printPlayerStatus(player)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><p>Polymorphism is a strategy for simplifying the structure of your program. It allows you to reuse functions for common sets of features across groups of classes and also to customize the behavior for unique needs of a class.</p>
<h3 id="listing-1411-declaring-a-function-to-be-final-roomkt">Listing 14.11 Declaring a function to be final (Room.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">open</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Room</span>(<span style="color:#66d9ef">val</span> name: String) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">open</span> <span style="color:#66d9ef">val</span> dangerLevel = <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">description</span>() = <span style="color:#e6db74">&#34;Room: </span><span style="color:#e6db74">$name</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span> +
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;Danger level: </span><span style="color:#e6db74">$dangerLevel</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">open</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">load</span>() = <span style="color:#e6db74">&#34;Nothing much to see here...&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;<span style="color:#66d9ef">open</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TownSquare</span> : Room(<span style="color:#e6db74">&#34;Town Square&#34;</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">val</span> dangerLevel = <span style="color:#66d9ef">super</span>.dangerLevel - <span style="color:#ae81ff">3</span> <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">var</span> bellSound = <span style="color:#e6db74">&#34;GWONG&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">load</span>() =
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;The villagers rally and cheer as you enter!</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">${ringBell()}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">ringBell</span>() = <span style="color:#e6db74">&#34;The bell tower announces your arrival. </span><span style="color:#e6db74">$bellSound</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="type-checking">Type Checking</h2>
<h3 id="listing-1412-instantiating-a-room-repl">Listing 14.12 Instantiating a Room (REPL)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> room = Room(<span style="color:#e6db74">&#34;Foyer&#34;</span>)
</span></span><span style="display:flex;"><span>room <span style="color:#66d9ef">is</span> Room
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">true</span>
</span></span></code></pre></div><h3 id="listing-1414-checking-room-is-townsquare-repl">Listing 14.14 Checking room is TownSquare (REPL)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>room <span style="color:#66d9ef">is</span> TownSquare
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">false</span>
</span></span></code></pre></div><h3 id="listing-1415-checking-townsquare-is-townsquare-repl">Listing 14.15 Checking townSquare is TownSquare (REPL)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> townSquare = TownSquare() townSquare <span style="color:#66d9ef">is</span> TownSquare
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">true</span>
</span></span></code></pre></div><h3 id="listing-1416-checking-townsquare-is-room-repl">Listing 14.16 Checking townSquare is Room (REPL)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>townSquare <span style="color:#66d9ef">is</span> Room
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">true</span>
</span></span></code></pre></div><h3 id="listing-1417-type-checking-as-a-branching-condition-repl">Listing 14.17 Type checking as a branching condition (REPL)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> townSquare = TownSquare()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> className = <span style="color:#66d9ef">when</span>(townSquare) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">is</span> TownSquare <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;TownSquare&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">is</span> Room <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;Room&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">else</span> <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">throw</span> IllegalArgumentException()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>print(className)
</span></span></code></pre></div><h2 id="the-kotlin-type-hierarchy">The kotlin Type Hierarchy</h2>
<p>Every class in kotlin descends from a common superclass, known as <strong>Any</strong>, without ypu having to explicitly subclass it in your code</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>    Any <span style="color:#f92672">-&gt;</span> Room <span style="color:#f92672">-&gt;</span> TownSquare
</span></span></code></pre></div><h2 id="type-casting">Type casting</h2>
<p>Type casting allows you to treat an object as if it were an instance of a different type. This gives you the power to do anything with an object that you would of the type ypu specify (such as call functions on it).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">printIsSourceOfBlessings</span>(any: Any) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> isSourceOfBlessings = <span style="color:#66d9ef">if</span> (any <span style="color:#66d9ef">is</span> Player) {
</span></span><span style="display:flex;"><span>        any.isBlessed
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>&gt;&gt;      (any <span style="color:#66d9ef">as</span> Room).name <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Fount of Blessings&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">$any</span><span style="color:#e6db74"> is a source of blessings: </span><span style="color:#e6db74">$isSourceOfBlessings</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>The <strong>as</strong> operator denotes a type cast. This cast says, &ldquo;Treat any as if it were of type <strong>Room</strong> for the purpose of this expression&rdquo;.</p>
<h1 id="15-objects">15. Objects</h1>
<p>This chapter introduces <em>object declarations</em> as well as other types of classes: <em>nested classes</em>, <em>data classes</em> and <em>enum classes</em>.</p>
<h2 id="the-object-keyword">The object keyword</h2>
<p>If you need to hold on to a single instance with state is consistent throughout the time that your program is running, consider defining a <em>singleton</em>. With the object keyword, you specify thta a class will be limited to a single instance - a singleton. The first time you access an object, it is instantiated for you. That same instance will persist as long as your program is running, and each subsequent access will then return original instance.</p>
<p>There are three ways to use the object keyword: <em>object declarations</em>, <em>objects expressions</em> and <em>companion objects</em></p>
<h2 id="objects-declarations">Objects declarations</h2>
<p>Objects declarations are useful for organization and state management, especially when you need to maintain some state consistently theroughout the lifespam of your program.</p>
<h3 id="listing-151-declaring-game-object-gamekt">Listing 15.1 Declaring Game object (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">printPlayerStatus</span>(player: Player) {
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;(Aura: </span><span style="color:#e6db74">${player.auraColor()}</span><span style="color:#e6db74">) &#34;</span> +
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;(Blessed: </span><span style="color:#e6db74">${if (player.isBlessed) &#34;YES&#34; else &#34;NO&#34;}</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${player.name}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">${player.formatHealthStatus()}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">object</span> <span style="color:#a6e22e">Game</span> {
</span></span><span style="display:flex;"><span>&gt;&gt;  }
</span></span></code></pre></div><p>The main function in Game.kt should now serve exclisively to kick off gameplay. All game logic will be encapsulated in the <strong>Game</strong> object, of which there will be only one instance.</p>
<p>Beacause an object declaration is instantiated for you, you do not add a custom with code to be called at initialization. Instead, you need an initializer block for any code that you want to be called when your object is initialized. Add one to the Game object with a greeting to be printed to the console when the object in instantiated.</p>
<h3 id="listing-152-adding-an-init-block-to-game-gamekt">Listing 15.2 Adding an init block to Game (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">printPlayerStatus</span>(player: Player) {
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;(Aura: </span><span style="color:#e6db74">${player.auraColor()}</span><span style="color:#e6db74">) &#34;</span> +
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;(Blessed: </span><span style="color:#e6db74">${if (player.isBlessed) &#34;YES&#34; else &#34;NO&#34;}</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${player.name}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">${player.formatHealthStatus()}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">object</span> <span style="color:#a6e22e">Game</span> {
</span></span><span style="display:flex;"><span>&gt;&gt;    <span style="color:#66d9ef">init</span> {
</span></span><span style="display:flex;"><span>&gt;&gt;        println(<span style="color:#e6db74">&#34;Welcome, adventurer.&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Your welcome message does not print, because <strong>Game</strong> has not been initialized. And <strong>Game</strong> has not been initialized because it has not been referenced yet.</p>
<p>Add <strong>play</strong> to <strong>Game</strong> and call it from <strong>main</strong>. When you call a function defined in an object declaration, you call it using the name of the object in which it is defined - not on an instance of a class, as you do for other class functions.</p>
<h3 id="listing-153-calling-a-function-defined-on-an-object-declaration-gamekt">Listing 15.3 Calling a function defined on an object declaration (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Player status
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    printPlayerStatus(player)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Game</span>.play()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">printPlayerStatus</span>(player: Player) {
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;(Aura: </span><span style="color:#e6db74">${player.auraColor()}</span><span style="color:#e6db74">) &#34;</span> +
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;(Blessed: </span><span style="color:#e6db74">${if (player.isBlessed) &#34;YES&#34; else &#34;NO&#34;}</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${player.name}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">${player.formatHealthStatus()}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">object</span> <span style="color:#a6e22e">Game</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">init</span> {
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;Welcome, adventurer.&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">play</span>() {
</span></span><span style="display:flex;"><span>&gt;&gt;        <span style="color:#66d9ef">while</span> (<span style="color:#66d9ef">true</span>) {
</span></span><span style="display:flex;"><span>&gt;&gt;            <span style="color:#75715e">// Play NyetHack
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>&gt;&gt;        }
</span></span><span style="display:flex;"><span>&gt;&gt;    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-154-encapsulating-properties-and-functions-within-the-object-declaration-gamekt">Listing 15.4 Encapsulating properties and functions within the object declaration (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">val</span> player = Player(<span style="color:#e6db74">&#34;Madrigal&#34;</span>)
</span></span><span style="display:flex;"><span>&lt;&lt;  player.castFireball()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">var</span> currentRoom: Room = TownSquare()
</span></span><span style="display:flex;"><span>    println(currentRoom.description())
</span></span><span style="display:flex;"><span>    println(currentRoom.load())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Player status
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    printPlayerStatus(player)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Game</span>.play()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">printPlayerStatus</span>(player: Player) {
</span></span><span style="display:flex;"><span>&lt;&lt;      println(<span style="color:#e6db74">&#34;(Aura: </span><span style="color:#e6db74">${player.auraColor()}</span><span style="color:#e6db74">) &#34;</span> +
</span></span><span style="display:flex;"><span>&lt;&lt;              <span style="color:#e6db74">&#34;(Blessed: </span><span style="color:#e6db74">${if (player.isBlessed) &#34;YES&#34; else &#34;NO&#34;}</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>&lt;&lt;      println(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${player.name}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">${player.formatHealthStatus()}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>&lt;&lt;  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">object</span> <span style="color:#a6e22e">Game</span> {
</span></span><span style="display:flex;"><span>&gt;&gt;      <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> player = Player(<span style="color:#e6db74">&#34;Madrigal&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;      <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">var</span> currentRoom: Room = TownSquare()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">init</span> {
</span></span><span style="display:flex;"><span>            println(<span style="color:#e6db74">&#34;Welcome, adventurer.&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;          player.castFireball()
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">play</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> (<span style="color:#66d9ef">true</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Play NyetHack
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">printPlayerStatus</span>(player: Player) {
</span></span><span style="display:flex;"><span>&gt;&gt;        println(<span style="color:#e6db74">&#34;(Aura: </span><span style="color:#e6db74">${player.auraColor()}</span><span style="color:#e6db74">) &#34;</span> +
</span></span><span style="display:flex;"><span>&gt;&gt;                <span style="color:#e6db74">&#34;(Blessed: </span><span style="color:#e6db74">${if (player.isBlessed) &#34;YES&#34; else &#34;NO&#34;}</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;        println(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${player.name}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">${player.formatHealthStatus()}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-155-printing-status-in-the-game-loop-gamekt">Listing 15.5 Printing status in the game loop (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>&lt;&lt;  println(currentRoom.description())
</span></span><span style="display:flex;"><span>&lt;&lt;  println(currentRoom.load())
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#75715e">// Player status
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>&lt;&lt;  printPlayerStatus(player)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Game</span>.play()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">object</span> <span style="color:#a6e22e">Game</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> player = Player(<span style="color:#e6db74">&#34;Madrigal&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">var</span> currentRoom: Room = TownSquare()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">init</span> {
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;Welcome, adventurer.&#34;</span>)
</span></span><span style="display:flex;"><span>        player.castFireball()
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">play</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> (<span style="color:#66d9ef">true</span>) {
</span></span><span style="display:flex;"><span>&lt;&lt;          <span style="color:#75715e">// Play NyetHack
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>&gt;&gt;          println(currentRoom.description())
</span></span><span style="display:flex;"><span>&gt;&gt;          println(currentRoom.load())
</span></span><span style="display:flex;"><span>&gt;&gt;          <span style="color:#75715e">// Player status
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>&gt;&gt;          printPlayerStatus(player)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">printPlayerStatus</span>(player: Player) {
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;(Aura: </span><span style="color:#e6db74">${player.auraColor()}</span><span style="color:#e6db74">) &#34;</span> +
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;(Blessed: </span><span style="color:#e6db74">${if (player.isBlessed) &#34;YES&#34; else &#34;NO&#34;}</span><span style="color:#e6db74">)&#34;</span>)
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${player.name}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">${player.formatHealthStatus()}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>If you were to run Game.kt, it would loop indefinitely, as there is nothing to stop the loop. The last step for the game loop, at least for now</p>
<h3 id="listing-156-accepting-user-input-gamekt">Listing 15.6 Accepting user input (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">object</span> <span style="color:#a6e22e">Game</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">play</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> (<span style="color:#66d9ef">true</span>) {
</span></span><span style="display:flex;"><span>            println(currentRoom.description())
</span></span><span style="display:flex;"><span>            println(currentRoom.load())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Player status
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            printPlayerStatus(player)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;          print(<span style="color:#e6db74">&#34;&gt; Enter your command: &#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;          println(<span style="color:#e6db74">&#34;Last command: </span><span style="color:#e6db74">${readLine()}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="companion-objects">Companion objects</h2>
<p>If you would like to the initialization of an object a class instancem there is another option for you: a <strong>companion object</strong>. A <strong>companion object</strong> es declared within another class declaration using the companion modifies. A class can have no more than more companion object.</p>
<p>There are two case in which a companion object will be initialized, First, a companion obect is initialized when its enclosing class is initialized. this makes it a good place for singleton data that has a contextual connection to a class definition. Second, a companion object is initialized when one of its properties or function is accessed directly</p>
<p>By example.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PremadeWorldMap</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">companion</span> <span style="color:#66d9ef">object</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">val</span> MAPS_FILEPATH = <span style="color:#e6db74">&#34;nyethack.maps&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">load</span>() = File(MAPS_FILEPATH).readBytes()
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>PremadeWorldMap</strong> has compaion object with one function called <strong>load</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>    <span style="color:#a6e22e">PremadeWorldMap</span>.load()
</span></span></code></pre></div><p>And no matter how many times <strong>PremadeWorldMap</strong> in instantiated, there will only ever be one instnace of its companion object.</p>
<p>Understanding the differences in how and when object declarations, object expressions, and companion objects are instantiated is key in understanding when to use each of them effectively.</p>
<h2 id="nested-classes">Nested Classes</h2>
<p>Not all classes defined within other classes are declared without a name. You can also use the class keyword to define a named class <em>nested</em> inside of another class.</p>
<p>Create a private class within the <strong>Game</strong> object to provide this abstraction.</p>
<h3 id="listing-157-defining-a-nested-class-gamekt">Listing 15.7 Defining a nested class (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">object</span> <span style="color:#a6e22e">Game</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">GameInput</span>(arg: String?) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> input = arg <span style="color:#f92672">?:</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">val</span> command = input.split(<span style="color:#e6db74">&#34; &#34;</span>)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">val</span> argument = input.split(<span style="color:#e6db74">&#34; &#34;</span>).getOrElse(<span style="color:#ae81ff">1</span>, { <span style="color:#e6db74">&#34;&#34;</span> })
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>The <strong>GameInput</strong> class is only relevant to <strong>Game</strong>; it does not need to be accessed from anywhere else in NyeHack, Making <strong>GameInput</strong> a private, nested class means that GameInput can be used <strong>Game</strong> but does not clutter the rest of your API.</p>
<h3 id="listing-158-defining-a-function-in-a-nested-class-gamekt">Listing 15.8 Defining a function in a nested class (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">object</span> <span style="color:#a6e22e">Game</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">GameInput</span>(arg: String?) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> input = arg <span style="color:#f92672">?:</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> command = input.split(<span style="color:#e6db74">&#34; &#34;</span>)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> argument = input.split(<span style="color:#e6db74">&#34; &#34;</span>).getOrElse(<span style="color:#ae81ff">1</span>, { <span style="color:#e6db74">&#34;&#34;</span> })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;      <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">commandNotFound</span>() = <span style="color:#e6db74">&#34;I&#39;m not quite sure what you&#39;re trying to do!&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-159-defining-the-__processcommand__-function-gamekt">Listing 15.9 Defining the <strong>processCommand</strong> function (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">object</span> <span style="color:#a6e22e">Game</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">GameInput</span>(arg: String?) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> input = arg <span style="color:#f92672">?:</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> command = input.split(<span style="color:#e6db74">&#34; &#34;</span>)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> argument = input.split(<span style="color:#e6db74">&#34; &#34;</span>).getOrElse(<span style="color:#ae81ff">1</span>, { <span style="color:#e6db74">&#34;&#34;</span> })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;      <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">processCommand</span>() = <span style="color:#66d9ef">when</span> (command.toLowerCase()) {
</span></span><span style="display:flex;"><span>&gt;&gt;          <span style="color:#66d9ef">else</span> <span style="color:#f92672">-&gt;</span> commandNotFound()
</span></span><span style="display:flex;"><span>&gt;&gt;      }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">commandNotFound</span>() = <span style="color:#e6db74">&#34;I&#39;m not quite sure what you&#39;re trying to do!&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-1510-using-__gameinput__-gamekt">Listing 15.10 Using <strong>GameInput</strong> (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">object</span> <span style="color:#a6e22e">Game</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">play</span>() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> (<span style="color:#66d9ef">true</span>) {
</span></span><span style="display:flex;"><span>            println(currentRoom.description())
</span></span><span style="display:flex;"><span>            println(currentRoom.load())
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Player status
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            printPlayerStatus(player)
</span></span><span style="display:flex;"><span>            print(<span style="color:#e6db74">&#34;&gt; Enter your command: &#34;</span>)
</span></span><span style="display:flex;"><span>&lt;&lt;          println(<span style="color:#e6db74">&#34;Last command: </span><span style="color:#e6db74">${readLine()}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;          println(GameInput(readLine()).processCommand())
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Run Game.tk</p>
<h2 id="data-classes">Data classes</h2>
<p>A data classes designed specifically for holding data, and they come with some powerful data manupulationbenefits.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>Listing <span style="color:#ae81ff">15.11</span> Defining a <span style="color:#66d9ef">data</span> <span style="color:#66d9ef">class</span> <span style="color:#960050;background-color:#1e0010">(</span><span style="color:#a6e22e">Navigation</span>.kt)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">data</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Coordinate</span>(<span style="color:#66d9ef">val</span> x: Int, <span style="color:#66d9ef">val</span> y: Int) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> isInBounds = x <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> y <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-1512-tracking-player-position-playerkt">Listing 15.12 Tracking player position (Player.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Player</span>(_name: String,
</span></span><span style="display:flex;"><span>             <span style="color:#66d9ef">var</span> healthPoints: Int = <span style="color:#ae81ff">100</span>,
</span></span><span style="display:flex;"><span>             <span style="color:#66d9ef">val</span> isBlessed: Boolean,
</span></span><span style="display:flex;"><span>             <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> isImmortal: Boolean) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> name = _name
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span>() = <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${field.capitalize()}</span><span style="color:#e6db74"> of </span><span style="color:#e6db74">$hometown</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">set</span>(<span style="color:#66d9ef">value</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">field</span> = <span style="color:#66d9ef">value</span>.trim()
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> hometown <span style="color:#66d9ef">by</span> lazy { selectHometown() }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> currentPosition = Coordinate(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Any provides default implementations for all of these functions, but, as you have before, they are often not very reader friendly. Data classes procide implementations for these functions that may work better for yo project. In this section, we will talk through two of those functions and some of the other benefits of using data classes to represent data in your codebase.</p>
<ul>
<li>toString</li>
<li>equals</li>
<li>copy</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> mortalPlayer = player.copy(isImmortal = <span style="color:#66d9ef">false</span>)
</span></span></code></pre></div><h2 id="destructuring-declaration">Destructuring declaration</h2>
<p>Another bemefit if data classes is that they automatically enable your class&rsquo;s data to be destrcutured.</p>
<p>The example of destructuring you have seen up to this point have involved things like the list output from split.</p>
<p>Under the hood, destructuring depend on the declaration of functions with names like <strong>component1</strong>, <strong>component2</strong>, etc., each declared for some piece of data that you would like to return. Data classes automatically add these functions for you each property defined in their primary constructor.</p>
<p>There is nothing magic about a class supporting destructoring; a data class simply does tje extra work required to make the class &ldquo;destructurable&rdquo; for you. You can make any class support destructuring by adding component operator functions to it, like so</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PlayerScore</span>(<span style="color:#66d9ef">val</span> experience: Int, <span style="color:#66d9ef">val</span> level:Int ){
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">operator</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">component1</span>() = experience
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">operator</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">component2</span>() = level
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> <span style="color:#960050;background-color:#1e0010">(</span>experience, level) = PlayerScore(<span style="color:#ae81ff">1250</span>, <span style="color:#ae81ff">5</span>)
</span></span></code></pre></div><p>However, there are also some limitations and requirements on data classes.</p>
<ul>
<li>must have a primary constructor with at least one parameter.</li>
<li>require their primary constructor parameters to be marked wither <code>val</code> or <code>var</code></li>
<li>cannot be abstract, open, sealed, or inner.</li>
</ul>
<h2 id="enumerated-classes">Enumerated Classes</h2>
<p><em>Enumerated classes</em>, or &ldquo;enums&rdquo;, are specual type of class useful for defining a collection od constants, known as <em>enumerated types</em></p>
<h3 id="listing-1513-defining-an-enum-navigationkt">Listing 15.13 Defining an enum (Navigation.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">enum</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Direction</span> {
</span></span><span style="display:flex;"><span>    NORTH,
</span></span><span style="display:flex;"><span>    EAST,
</span></span><span style="display:flex;"><span>    SOUTH,
</span></span><span style="display:flex;"><span>    WEST
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">data</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Coordinate</span>(<span style="color:#66d9ef">val</span> x: Int, <span style="color:#66d9ef">val</span> y: Int) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> isInBounds = x <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> y <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-1514-defining-an-enum-constructor-navigationkt">Listing 15.14 Defining an enum constructor (Navigation.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">enum</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Direction</span>(<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> coordinate: Coordinate) {
</span></span><span style="display:flex;"><span>    NORTH(Coordinate(<span style="color:#ae81ff">0</span>, -<span style="color:#ae81ff">1</span>)),
</span></span><span style="display:flex;"><span>    EAST(Coordinate(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>)),
</span></span><span style="display:flex;"><span>    SOUTH(Coordinate(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>)),
</span></span><span style="display:flex;"><span>    WEST(Coordinate(-<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>))
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">data</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Coordinate</span>(<span style="color:#66d9ef">val</span> x: Int, <span style="color:#66d9ef">val</span> y: Int) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> isInBounds = x <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> y <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Add a function called updateCoordinate to Directionto change the player&rsquo;s location based on their movement.</p>
<h3 id="listing-1515-defining-a-function-in-an-enum-navigationkt">Listing 15.15 Defining a function in an enum (Navigation.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">enum</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Direction</span>(<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> coordinate: Coordinate) {
</span></span><span style="display:flex;"><span>    NORTH(Coordinate(<span style="color:#ae81ff">0</span>, -<span style="color:#ae81ff">1</span>)),
</span></span><span style="display:flex;"><span>    EAST(Coordinate(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>)),
</span></span><span style="display:flex;"><span>    SOUTH(Coordinate(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>)),
</span></span><span style="display:flex;"><span>    WEST(Coordinate(-<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">updateCoordinate</span>(playerCoordinate: Coordinate) =
</span></span><span style="display:flex;"><span>&gt;&gt;          Coordinate(playerCoordinate.x + coordinate.x, playerCoordinate.y + coordinate.y)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">data</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Coordinate</span>(<span style="color:#66d9ef">val</span> x: Int, <span style="color:#66d9ef">val</span> y: Int) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> isInBounds = x <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> y <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="operator-overloading">Operator Overloading</h2>
<p>When you want to use built-in operators with your custom types, you have to override the operators functions to tell the compiler how ti implement them for you type. This is known as <em>operator overloading</em></p>
<h3 id="listing1516-overloadingtheplusoperatornavigationkt">Listing15.16 Overloadingtheplusoperator(Navigation.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">enum</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Direction</span>(<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> coordinate: Coordinate) {
</span></span><span style="display:flex;"><span>    NORTH(Coordinate(<span style="color:#ae81ff">0</span>, -<span style="color:#ae81ff">1</span>)),
</span></span><span style="display:flex;"><span>    EAST(Coordinate(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>)),
</span></span><span style="display:flex;"><span>    SOUTH(Coordinate(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>)),
</span></span><span style="display:flex;"><span>    WEST(Coordinate(-<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">updateCoordinate</span>(playerCoordinate: Coordinate) =
</span></span><span style="display:flex;"><span>            Coordinate(playerCoordinate.x + coordinate.x, playerCoordinate.y + coordinate.y)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">data</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Coordinate</span>(<span style="color:#66d9ef">val</span> x: Int, <span style="color:#66d9ef">val</span> y: Int) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> isInBounds = x <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> y <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">operator</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">plus</span>(other: Coordinate) = Coordinate(x + other.x, y + other.y)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Now , you can simply use the addition operator <code>(x)</code> to add two Coordinate instances together.</p>
<h3 id="listing-1517-using-an-overloaded-operator-navigationkt">Listing 15.17 Using an overloaded operator (Navigation.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">enum</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Direction</span>(<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> coordinate: Coordinate) {
</span></span><span style="display:flex;"><span>    NORTH(Coordinate(<span style="color:#ae81ff">0</span>, -<span style="color:#ae81ff">1</span>)),
</span></span><span style="display:flex;"><span>    EAST(Coordinate(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>)),
</span></span><span style="display:flex;"><span>    SOUTH(Coordinate(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>)),
</span></span><span style="display:flex;"><span>    WEST(Coordinate(-<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">updateCoordinate</span>(playerCoordinate: Coordinate) =
</span></span><span style="display:flex;"><span>&lt;&lt;      Coordinate(playerCoordinate.x + coordinate.x, playerCoordinate.y + coordinate.y)
</span></span><span style="display:flex;"><span>&gt;&gt;      coordinate + playerCoordinate
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">data</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Coordinate</span>(<span style="color:#66d9ef">val</span> x: Int, <span style="color:#66d9ef">val</span> y: Int) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> isInBounds = x <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> y <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">operator</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">plus</span>(other: Coordinate) = Coordinate(x + other.x, y + other.y)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Come commonly used operators you can override.</p>
<h3 id="table-151-common-operators">Table 15.1 Common operators</h3>
<table>
<thead>
<tr>
<th>Operator</th>
<th>Function name</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td>+</td>
<td><strong>plus</strong></td>
<td>Adds an object to another</td>
</tr>
<tr>
<td>+=</td>
<td><strong>plussAssign</strong></td>
<td>Adds an object to another and assign the result to the first</td>
</tr>
<tr>
<td>==</td>
<td><strong>equals</strong></td>
<td>Returns true if two objects are equal, false otherwise</td>
</tr>
<tr>
<td>&gt;</td>
<td><strong>compareTo</strong></td>
<td>Returns true if the object on the lefthand side is greaterthan the object on the righthand side, false otherwise</td>
</tr>
<tr>
<td>[]</td>
<td><strong>get</strong></td>
<td>Returns the element in a collection at a give index</td>
</tr>
<tr>
<td>..</td>
<td><strong>rangeTo</strong></td>
<td>Creates a range object</td>
</tr>
<tr>
<td>in</td>
<td><strong>contains</strong></td>
<td>Returs true if an object exists within a collection</td>
</tr>
</tbody>
</table>
<h2 id="aditional-exploring-the-world-of-nyethack">Aditional, exploring the world of NyetHack</h2>
<h3 id="listing-1518-defining-a-world-map-in-nyethack-gamekt">Listing 15.18 Defining a world map in NyetHack (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">object</span> <span style="color:#a6e22e">Game</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> player = Player(<span style="color:#e6db74">&#34;Madrigal&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">var</span> currentRoom: Room = TownSquare()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">var</span> worldMap = listOf(
</span></span><span style="display:flex;"><span>&gt;&gt;      listOf(currentRoom, Room(<span style="color:#e6db74">&#34;Tavern&#34;</span>), Room(<span style="color:#e6db74">&#34;Back Room&#34;</span>)),
</span></span><span style="display:flex;"><span>&gt;&gt;      listOf(Room(<span style="color:#e6db74">&#34;Long Corridor&#34;</span>), Room(<span style="color:#e6db74">&#34;Generic Room&#34;</span>)))
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-1519-defining-the-move-function-gamekt">Listing 15.19 Defining the move function (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">object</span> <span style="color:#a6e22e">Game</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">var</span> currentRoom: Room = TownSquare()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> player = Player(<span style="color:#e6db74">&#34;Madrigal&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">var</span> worldMap = listOf(
</span></span><span style="display:flex;"><span>        listOf(currentRoom, Room(<span style="color:#e6db74">&#34;Tavern&#34;</span>), Room(<span style="color:#e6db74">&#34;Back Room&#34;</span>)),
</span></span><span style="display:flex;"><span>        listOf(Room(<span style="color:#e6db74">&#34;Long Corridor&#34;</span>), Room(<span style="color:#e6db74">&#34;Generic Room&#34;</span>)))
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">move</span>(directionInput: String) =
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">val</span> direction = <span style="color:#a6e22e">Direction</span>.valueOf(directionInput.toUpperCase())
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">val</span> newPosition = direction.updateCoordinate(player.currentPosition)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (!newPosition.isInBounds) {
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">throw</span> IllegalStateException(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">$direction</span><span style="color:#e6db74"> is out of bounds.&#34;</span>)
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">val</span> newRoom = worldMap[newPosition.y][newPosition.x]
</span></span><span style="display:flex;"><span>            player.currentPosition = newPosition
</span></span><span style="display:flex;"><span>            currentRoom = newRoom
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;OK, you move </span><span style="color:#e6db74">$direction</span><span style="color:#e6db74"> to the </span><span style="color:#e6db74">${newRoom.name}</span><span style="color:#e6db74">.</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">${newRoom.load()}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">catch</span> (e: Exception) {
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;Invalid direction: </span><span style="color:#e6db74">$directionInput</span><span style="color:#e6db74">.&#34;</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-1520-defining-the-processcommand-function-gamekt">Listing 15.20 Defining the processCommand function (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">object</span> <span style="color:#a6e22e">Game</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">GameInput</span>(arg: String?) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> input = arg <span style="color:#f92672">?:</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> command = input.split(<span style="color:#e6db74">&#34; &#34;</span>)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> argument = input.split(<span style="color:#e6db74">&#34; &#34;</span>).getOrElse(<span style="color:#ae81ff">1</span>, { <span style="color:#e6db74">&#34;&#34;</span> })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">processCommand</span>() = <span style="color:#66d9ef">when</span> (command.toLowerCase()) {
</span></span><span style="display:flex;"><span>&gt;&gt;          <span style="color:#e6db74">&#34;move&#34;</span> <span style="color:#f92672">-&gt;</span> move(argument)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">else</span> <span style="color:#f92672">-&gt;</span> commandNotFound()
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">commandNotFound</span>() = <span style="color:#e6db74">&#34;I&#39;m not quite sure what you&#39;re trying to do!&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h1 id="16-interfaces-and-abstract-classes">16. Interfaces and Abstract Classes</h1>
<p>an interface allows you to specify common properties and beahvior that are supported by a subset of classes in your program - without being required to specify how they will be implemented. This capability - the <em>what</em> without <em>the how</em> - is useful when inheritance is not the right relationship for classes in a program. Using an interface, a group of classes can have properties or functions in common without sharing a superclass or sublcasing one other.</p>
<h2 id="defining-an-interface">Defining an Interface</h2>
<p>You will first create an interface that specifies the functions and properties used for entities.</p>
<h3 id="listing-161-defining-an-interface-creaturekt">Listing 16.1 Defining an interface (Creature.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Fightable</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> healthPoints: Int
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> diceCount: Int
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> diceSides: Int
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> damageRoll: Int
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">attack</span>(opponent: Fightable): Int
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Your interface declaration defines  things that are common to eny entity.</p>
<h2 id="implementing-an-interface">Implementing an Interface</h2>
<p>To use an interface, we say that you &ldquo;implemnt&rdquo; it on a class. There two parts to this: First, you declare that the class implements the interface. Then, you must ensure that the class provides implementations for all the properties and functions specified in the interface</p>
<p>Use the <code>:</code> operator to implemnt an interface.</p>
<h3 id="listing-162-implementing-an-interface-playerkt">Listing 16.2 Implementing an interface (Player.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Player</span>(_name: String,
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">var</span> healthPoints: Int = <span style="color:#ae81ff">100</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> isBlessed: Boolean = <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">var</span> isImmortal: Boolean) : Fightable {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>When you add the interface to the main class, IntelliJ indicates that functions and properties are missing.</p>
<h3 id="listing-163-stubbing-out-an-interface-implementation-playerkt">Listing 16.3 Stubbing out an interface implementation (Player.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Player</span>(_name: String,
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">var</span> healthPoints: Int = <span style="color:#ae81ff">100</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">var</span> isBlessed: Boolean = <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">var</span> isImmortal: Boolean) : Fightable {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">val</span> diceCount: Int = <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>&lt;&lt;          <span style="color:#66d9ef">get</span>() = TODO(<span style="color:#e6db74">&#34;not implemented&#34;</span>)
</span></span><span style="display:flex;"><span>&lt;&lt;          <span style="color:#75715e">//To change initializer of created properties use
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>&lt;&lt;          <span style="color:#75715e">//File | Settings | File Templates.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">val</span> diceSides: Int = <span style="color:#ae81ff">6</span>
</span></span><span style="display:flex;"><span>&lt;&lt;          <span style="color:#66d9ef">get</span>() = TODO(<span style="color:#e6db74">&#34;not implemented&#34;</span>)
</span></span><span style="display:flex;"><span>&lt;&lt;          <span style="color:#75715e">//To change initializer of created properties use
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>&lt;&lt;          <span style="color:#75715e">//File | Settings | File Templates.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">attack</span>(opponent: Fightable): Int {
</span></span><span style="display:flex;"><span>&lt;&lt;          TODO(<span style="color:#e6db74">&#34;not implemented&#34;</span>)
</span></span><span style="display:flex;"><span>&lt;&lt;          <span style="color:#75715e">//To change body of created functions use
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>&lt;&lt;          <span style="color:#75715e">//File | Settings | File Templates.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>&gt;&gt;          <span style="color:#66d9ef">val</span> damageDealt = <span style="color:#66d9ef">if</span> (isBlessed) {
</span></span><span style="display:flex;"><span>&gt;&gt;              damageRoll * <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>&gt;&gt;          } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>&gt;&gt;              damageRoll
</span></span><span style="display:flex;"><span>&gt;&gt;          }
</span></span><span style="display:flex;"><span>&gt;&gt;          opponent.healthPoints <span style="color:#f92672">-=</span> damageDealt
</span></span><span style="display:flex;"><span>&gt;&gt;          <span style="color:#66d9ef">return</span> damageDealt
</span></span><span style="display:flex;"><span>&gt;&gt;      }
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="default-implementations">Default Implementations</h2>
<p>We said several times now that interface focus on the what and not the how. You can, however provide a default implementation for property getters and functions in an interface. Classes that implement the interface then have option of using the default of defining their own implementation.</p>
<h3 id="listing-164-defining-a-default-getter-implementation-creaturekt">Listing 16.4 Defining a default getter implementation (Creature.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Fightable</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> healthPoints: Int
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> diceCount: Int
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> diceSides: Int
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> damageRoll: Int
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span>() = (<span style="color:#ae81ff">0</span> until diceCount).map {
</span></span><span style="display:flex;"><span>            Random().nextInt(diceSides + <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        }.sum()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">attack</span>(opponent: Fightable): Int
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="abstract-classes">Abstract Classes</h2>
<p>Abstract classes provide another way to enforce structure in your classes. An abstract class is never instantiated. Its purpose is to provide function implementations throughinheritance to subclasses that are instantiated.</p>
<p>An abstract class is defined by prepending the abstract keyword to a class definition. In addition to function implementations, abstract classes can include <em>abstract functions</em> - function declarations without implementations.</p>
<h3 id="listing-165-defining-an-abstract-class-creaturekt">Listing 16.5 Defining an abstract class (Creature.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Fightable</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> healthPoints: Int
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> diceCount: Int
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> diceSides: Int
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> damageRoll: Int
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">get</span>() = (<span style="color:#ae81ff">0</span> until diceCount).map {
</span></span><span style="display:flex;"><span>            Random().nextInt(diceSides + <span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>        }.sum()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">attack</span>(opponent: Fightable): Int
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;    <span style="color:#66d9ef">abstract</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Monster</span>(<span style="color:#66d9ef">val</span> name: String,
</span></span><span style="display:flex;"><span>&gt;&gt;                           <span style="color:#66d9ef">val</span> description: String,
</span></span><span style="display:flex;"><span>&gt;&gt;                           <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">var</span> healthPoints: Int) : Fightable {
</span></span><span style="display:flex;"><span>&gt;&gt;
</span></span><span style="display:flex;"><span>&gt;&gt;        <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">attack</span>(opponent: Fightable): Int {
</span></span><span style="display:flex;"><span>&gt;&gt;            <span style="color:#66d9ef">val</span> damageDealt = damageRoll
</span></span><span style="display:flex;"><span>&gt;&gt;            opponent.healthPoints <span style="color:#f92672">-=</span> damageDealt
</span></span><span style="display:flex;"><span>&gt;&gt;            <span style="color:#66d9ef">return</span> damageDealt
</span></span><span style="display:flex;"><span>&gt;&gt;        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-166-subclassing-an-abstract-class-creaturekt">Listing 16.6 Subclassing an abstract class (Creature.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Fightable</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">abstract</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Monster</span>(<span style="color:#66d9ef">val</span> name: String,
</span></span><span style="display:flex;"><span>                       <span style="color:#66d9ef">val</span> description: String,
</span></span><span style="display:flex;"><span>                       <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">var</span> healthPoints: Int) : Fightable {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">attack</span>(opponent: Fightable): Int {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> damageDealt = damageRoll
</span></span><span style="display:flex;"><span>        opponent.healthPoints <span style="color:#f92672">-=</span> damageDealt
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> damageDealt
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;    <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Goblin</span>(name: String = <span style="color:#e6db74">&#34;Goblin&#34;</span>,
</span></span><span style="display:flex;"><span>&gt;&gt;                 description: String = <span style="color:#e6db74">&#34;A nasty-looking goblin&#34;</span>,
</span></span><span style="display:flex;"><span>&gt;&gt;                 healthPoints: Int = <span style="color:#ae81ff">30</span>) : Monster(name, description, healthPoints) {
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-167-implementing-properties-in-the-subclass-of-an-abstract-class-creaturekt">Listing 16.7 Implementing properties in the subclass of an abstract class (Creature.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">Fightable</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">abstract</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Monster</span>(<span style="color:#66d9ef">val</span> name: String,
</span></span><span style="display:flex;"><span>                       <span style="color:#66d9ef">val</span> description: String,
</span></span><span style="display:flex;"><span>                       <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">var</span> healthPoints: Int) : Fightable {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Goblin</span>(name: String = <span style="color:#e6db74">&#34;Goblin&#34;</span>,
</span></span><span style="display:flex;"><span>             description: String = <span style="color:#e6db74">&#34;A nasty-looking goblin&#34;</span>,
</span></span><span style="display:flex;"><span>             healthPoints: Int = <span style="color:#ae81ff">30</span>) : Monster(name, description, healthPoints) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">val</span> diceCount = <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">val</span> diceSides = <span style="color:#ae81ff">8</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="combat-in-nyethack">Combat in NyetHack</h2>
<p>Add a monster proeprty of nullable type __Monter?__to the <strong>Room</strong> class, and initialize it by assigning it a <strong>Goblin</strong>. Update <strong>Room&rsquo;s</strong> description to let the player know whether the room has a monster to fight.</p>
<h3 id="listing-168-adding-a-monster-to-each-room-roomkt">Listing 16.8 Adding a monster to each room (Room.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">open</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Room</span>(<span style="color:#66d9ef">val</span> name: String) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> <span style="color:#66d9ef">open</span> <span style="color:#66d9ef">val</span> dangerLevel = <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">var</span> monster: Monster? = Goblin()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">description</span>() = <span style="color:#e6db74">&#34;Room: </span><span style="color:#e6db74">$name</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span> +
</span></span><span style="display:flex;"><span>                        <span style="color:#e6db74">&#34;Danger level: </span><span style="color:#e6db74">$dangerLevel</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span> +
</span></span><span style="display:flex;"><span>&gt;&gt;                      <span style="color:#e6db74">&#34;Creature: </span><span style="color:#e6db74">${monster?.description ?: &#34;none.&#34;}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">open</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">load</span>() = <span style="color:#e6db74">&#34;Nothing much to see here...&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-169-defining-the-__fight__-functiongamekt">Listing 16.9 Defining the <strong>fight</strong> function(Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">object</span> <span style="color:#a6e22e">Game</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">move</span>(directionInput: String) = <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">fight</span>() = currentRoom.monster<span style="color:#f92672">?.</span>let {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">while</span> (player.healthPoints &gt; <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#66d9ef">it</span>.healthPoints &gt; <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Thread</span>.sleep(<span style="color:#ae81ff">1000</span>)
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;Combat complete.&#34;</span>
</span></span><span style="display:flex;"><span>        } <span style="color:#f92672">?:</span> <span style="color:#e6db74">&#34;There&#39;s nothing here to fight.&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">GameInput</span>(arg: String?) {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-1610-defining-the-__slay__-function-gamekt">Listing 16.10 Defining the <strong>slay</strong> function (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">object</span> <span style="color:#a6e22e">Game</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">fight</span>() = <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">slay</span>(monster: Monster) {
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${monster.name}</span><span style="color:#e6db74"> did </span><span style="color:#e6db74">${monster.attack(player)}</span><span style="color:#e6db74"> damage!&#34;</span>)
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${player.name}</span><span style="color:#e6db74"> did </span><span style="color:#e6db74">${player.attack(monster)}</span><span style="color:#e6db74"> damage!&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (player.healthPoints <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>            println(<span style="color:#e6db74">&#34;&gt;&gt;&gt;&gt; You have been defeated! Thanks for playing. &lt;&lt;&lt;&lt;&#34;</span>)
</span></span><span style="display:flex;"><span>            exitProcess(<span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (monster.healthPoints <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>            println(<span style="color:#e6db74">&#34;&gt;&gt;&gt;&gt; </span><span style="color:#e6db74">${monster.name}</span><span style="color:#e6db74"> has been defeated! &lt;&lt;&lt;&lt;&#34;</span>)
</span></span><span style="display:flex;"><span>            currentRoom.monster = <span style="color:#66d9ef">null</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">GameInput</span>(arg: String?) {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Call slay from fight.</p>
<h3 id="listing-1611-calling-the-slay-function-gamekt">Listing 16.11 Calling the slay function (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">object</span> <span style="color:#a6e22e">Game</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">move</span>(directionInput: String) = <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">fight</span>() = currentRoom.monster<span style="color:#f92672">?.</span>let {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> (player.healthPoints &gt; <span style="color:#ae81ff">0</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#66d9ef">it</span>.healthPoints &gt; <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>            slay(<span style="color:#66d9ef">it</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">Thread</span>.sleep(<span style="color:#ae81ff">1000</span>)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#e6db74">&#34;Combat complete.&#34;</span>
</span></span><span style="display:flex;"><span>    } <span style="color:#f92672">?:</span> <span style="color:#e6db74">&#34;There&#39;s nothing here to fight.&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">slay</span>(monster: Monster) {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">GameInput</span>(arg: String?) {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-1612-adding-the-fight-command-gamekt">Listing 16.12 Adding the fight command (Game.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">object</span> <span style="color:#a6e22e">Game</span> {
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">GameInput</span>(arg: String?) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">val</span> input = arg <span style="color:#f92672">?:</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> command = input.split(<span style="color:#e6db74">&#34; &#34;</span>)[<span style="color:#ae81ff">0</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> argument = input.split(<span style="color:#e6db74">&#34; &#34;</span>).getOrElse(<span style="color:#ae81ff">1</span>, { <span style="color:#e6db74">&#34;&#34;</span> })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">processCommand</span>() = <span style="color:#66d9ef">when</span> (command.toLowerCase()) {
</span></span><span style="display:flex;"><span>&gt;&gt;          <span style="color:#e6db74">&#34;fight&#34;</span> <span style="color:#f92672">-&gt;</span> fight()
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;move&#34;</span> <span style="color:#f92672">-&gt;</span> move(argument)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">else</span> <span style="color:#f92672">-&gt;</span> commandNotFound()
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">commandNotFound</span>() = <span style="color:#e6db74">&#34;I&#39;m not quite sure what you&#39;re trying to do!&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h1 id="17-generics">17. Generics</h1>
<p>List can hold any type because of <em>generics</em>, a type system feature that allows both functions and types to work types that are not yet known to you of the compiler.</p>
<p>Generics greatly expand the reusability of your class definitions, because they allow your definitions to work with many types.</p>
<h2 id="defining-generic-types">Defining Generic Types</h2>
<p>A <em>generic type</em> is a class that accepts an input of any type in its constructor.</p>
<h3 id="listing-171-creating-a-generic-type-genericskt">Listing 17.1 Creating a generic type (Generics.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LootBox</span>&lt;T&gt;(item: T) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">var</span> loot: T = item
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>You define the <strong>LootBox</strong> class an make it generic by specifying a generic type parameter for use with the class, written as <code>T</code> abd specified within diamon braces (&lt; &gt;) like other type parameters. The generic type parameter, <code>T</code>, is a placeholder for the item&rsquo;s type.</p>
<p>Note that the generic type parameter is usually represented with a single leyyer T, short for &ldquo;type&rdquo; though any letter or word can be used. The book suggest generally stick with T, since it is what is commonly used in other lenguages that support generics and is therefore teh most readable choice.</p>
<h3 id="listing-172-defining-loot-boxes-genericskt">Listing 17.2 Defining loot boxes (Generics.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LootBox</span>&lt;T&gt;(item: T) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">var</span> loot: T = item
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Fedora</span>(<span style="color:#66d9ef">val</span> name: String, <span style="color:#66d9ef">val</span> value: Int)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Coin</span>(<span style="color:#66d9ef">val</span> value: Int)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> lootBoxOne: LootBox&lt;Fedora&gt; = LootBox(Fedora(<span style="color:#e6db74">&#34;a generic-looking fedora&#34;</span>, <span style="color:#ae81ff">15</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> lootBoxTwo: LootBox&lt;Coin&gt; = LootBox(Coin(<span style="color:#ae81ff">15</span>))
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Notice thr type signature for each LootBox variable:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> lootBoxOne: LootBox&lt;Fedora&gt; = LootBox(Fedora(<span style="color:#e6db74">&#34;a generic-looking fedora&#34;</span>, <span style="color:#ae81ff">15</span>))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">val</span> lootBoxTwo: LootBox&lt;Coin&gt; = LootBox(Coin(<span style="color:#ae81ff">15</span>))
</span></span></code></pre></div><p>The diamond braces on the type signature for the variable show what type of loot a particular <strong>LootBox</strong> instance is capable of holding.</p>
<h2 id="generic-functions">Generic Functions</h2>
<p>Generic type parameters also work with functions. That is good news, since there is currently no way for a player to retrieve loot from a loot box.</p>
<h3 id="listing-173-adding-a-__fetch__-function-genericskt">Listing 17.3 Adding a <strong>fetch</strong> function (Generics.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LootBox</span>&lt;T&gt;(item: T) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> open = <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">var</span> loot: T = item
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">fetch</span>(): T? {
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">return</span> loot.takeIf { <span style="color:#66d9ef">open</span> }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Here you define a generic function, <strong>fetch</strong>, that return T - the generic type parameter specified on the <strong>LootBox</strong> class, which is a placeholder for the type of item.</p>
<h3 id="listing-174-testing-the-generic-fetch-function-genericskt">Listing 17.4 Testing the generic fetch function (Generics.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> lootBoxOne: LootBox&lt;Fedora&gt; = LootBox(Fedora(<span style="color:#e6db74">&#34;a generic-looking fedora&#34;</span>, <span style="color:#ae81ff">15</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> lootBoxTwo: LootBox&lt;Coin&gt; = LootBox(Coin(<span style="color:#ae81ff">15</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    lootBoxOne.fetch()<span style="color:#f92672">?.</span>run {
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;You retrieve </span><span style="color:#e6db74">$name</span><span style="color:#e6db74"> from the box!&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-175-opening-the-box-genericskt">Listing 17.5 Opening the box (Generics.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> lootBoxOne: LootBox&lt;Fedora&gt; = LootBox(Fedora(<span style="color:#e6db74">&#34;a generic-looking fedora&#34;</span>, <span style="color:#ae81ff">15</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> lootBoxTwo: LootBox&lt;Coin&gt; = LootBox(Coin(<span style="color:#ae81ff">15</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  lootBoxOne.<span style="color:#66d9ef">open</span> = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    lootBoxOne.fetch()<span style="color:#f92672">?.</span>run {
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;You retrieve a </span><span style="color:#e6db74">$name</span><span style="color:#e6db74"> from the box!&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="multiple-generic-type-paramters">Multiple Generic Type Paramters.</h2>
<p>A generic function or type can also support multiple generic type parameters, Suppose you want a second <strong>fetch</strong> function that accepts a loot-modification function, allowing you to convert the loot to a some other new type, perhaps a coin, when you fetch it. The value of the coin returned depends on the value of the original loot - and a lootModFunction higher-order function that us passed to <strong>fetch</strong> will determinate that.</p>
<h3 id="listing-176-using-multiple-generic-type-parameters-genericskt">Listing 17.6 Using multiple generic type parameters (Generics.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LootBox</span>&lt;T&gt;(item: T) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> open = <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">var</span> loot: T = item
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">fetch</span>(): T? {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> loot.takeIf { <span style="color:#66d9ef">open</span> }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> &lt;<span style="color:#a6e22e">R</span>&gt; <span style="color:#a6e22e">fetch</span>(lootModFunction: (T) <span style="color:#f92672">-&gt;</span> R): R? {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> lootModFunction(loot).takeIf { <span style="color:#66d9ef">open</span> }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><p>Here, you add a new generic type parameter to the function R, short for the &ldquo;return&rdquo;, since the generic type parameter will be used for fetch&rsquo;s return type. You place the generic type parameter in diamond braces directly before the function name: <code>fun &lt;R&gt; fetch</code>. <strong>fetch</strong> returns a value of type <code>R?</code>, anullable version of R.</p>
<p>You also specify that the lootModFunction (via its function type declaration, (T) -&gt; R ) accepts an argument of type T and returns a result of type R. Try out the new <strong>fetch</strong> function that you defined - this time, apssing a loot-modification function as an argument.</p>
<h3 id="listing-177-passing-the-loot-modification-function-as-an-argument-genericskt">Listing 17.7 Passing the loot-modification function as an argument (Generics.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> lootBoxOne: LootBox&lt;Fedora&gt; = LootBox(Fedora(<span style="color:#e6db74">&#34;a generic-looking fedora&#34;</span>, <span style="color:#ae81ff">15</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> lootBoxTwo: LootBox&lt;Coin&gt; = LootBox(Coin(<span style="color:#ae81ff">15</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    lootBoxOne.<span style="color:#66d9ef">open</span> = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    lootBoxOne.fetch()<span style="color:#f92672">?.</span>run {
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;You retrieve </span><span style="color:#e6db74">$name</span><span style="color:#e6db74"> from the box!&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> coin = lootBoxOne.fetch() {
</span></span><span style="display:flex;"><span>&gt;&gt;      Coin(<span style="color:#66d9ef">it</span>.<span style="color:#66d9ef">value</span> * <span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  coin<span style="color:#f92672">?.</span>let { println(<span style="color:#66d9ef">it</span>.<span style="color:#66d9ef">value</span>) }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="generic-constraints">Generic Constraints</h2>
<p>What if you wanted to ensure that the loot box was only used to hold loot, and not something else? You can specify a generic type constraint to enforce exactly that.</p>
<h3 id="listing-178-adding-a-superclass-genericskt">Listing 17.8 Adding a superclass (Generics.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LootBox</span>&lt;T&gt;(item: T) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> open = <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">var</span> loot: T = item
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">fetch</span>(): T? {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> loot.takeIf { <span style="color:#66d9ef">open</span> }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> &lt;<span style="color:#a6e22e">R</span>&gt; <span style="color:#a6e22e">fetch</span>(lootModFunction: (T) <span style="color:#f92672">-&gt;</span> R): R? {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> lootModFunction(loot).takeIf { <span style="color:#66d9ef">open</span> }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">open</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Loot</span>(<span style="color:#66d9ef">val</span> value: Int)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Fedora</span>(<span style="color:#66d9ef">val</span> name: String, <span style="color:#66d9ef">val</span> value: Int) : Loot(<span style="color:#66d9ef">value</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Coin</span>(<span style="color:#66d9ef">val</span> value: Int) : Loot(<span style="color:#66d9ef">value</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><p>Now, add a generic type constraint to LootBox&rsquo;s generic type paramter to allow only descendants of the Loot class to be used with <strong>LootBox</strong></p>
<h3 id="listing-179-constraining-the-generic-parameter-to-__loot__-only-genericskt">Listing 17.9 Constraining the generic parameter to <strong>Loot</strong> only (Generics.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LootBox</span>&lt;T : Loot&gt;(item: T) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><h2 id="vararg-and-get">vararg and get</h2>
<p>you <strong>LootBox</strong> can now hold any kind of <strong>Loot</strong>, but it cannot hold more that one item at a time. What if you want to hols multiple items of Loot in you <strong>LootBox</strong>?</p>
<p>To do so, modify <strong>lootBox</strong>&rsquo;s primary constructor with the vararg keyword, which allows a variable number of arguments to be passed to the constructor.</p>
<h3 id="listing-1710-adding-vararg-genericskt">Listing 17.10 Adding vararg (Generics.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LootBox</span>&lt;T : Loot&gt;(<span style="color:#66d9ef">vararg</span> item: T) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><p>Now that you have added  the <code>vararg</code> keyword to <strong>LootBot</strong>, its item cariable will be treated as an Array of elements instead of a single element when it is initialized, and <strong>LootBox</strong> can accpet multiple items passed into the contructor.</p>
<h3 id="listing-1711-indexing-into-the-loot-array-genericskt">Listing 17.11 Indexing into the loot array (Generics.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LootBox</span>&lt;T : Loot&gt;(<span style="color:#66d9ef">vararg</span> item: T) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> open = <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">var</span> loot: TArray&lt;<span style="color:#66d9ef">out</span> T&gt; = item
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">fetch</span>(item: Int): T? {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> loot[item].takeIf { <span style="color:#66d9ef">open</span> }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> &lt;<span style="color:#a6e22e">R</span>&gt; <span style="color:#a6e22e">fetch</span>(item: Int, lootModFunction: (T) <span style="color:#f92672">-&gt;</span> R): R? {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> lootModFunction(loot[item]).takeIf { <span style="color:#66d9ef">open</span> } }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><p>Notice the <code>out</code> keyword thta you add for the new loot variable&rsquo;s type signature. The out keyword is required here because it is part of the return type for any cariable marked as <code>vararg</code>.</p>
<p>Try out the new and improved  <strong>LootBox</strong> in <strong>main</strong>. Pass another fedora into the loot box.</p>
<h3 id="listing-1712-testing-the-new-lootbox-genericskt">Listing 17.12 Testing the new LootBox (Generics.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">val</span> lootBoxOne: LootBox&lt;Fedora&gt; = LootBox(Fedora(<span style="color:#e6db74">&#34;a generic-looking fedora&#34;</span>, <span style="color:#ae81ff">15</span>), Fedora(<span style="color:#e6db74">&#34;a dazzling magenta fedora&#34;</span>, <span style="color:#ae81ff">25</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> lootBoxTwo: LootBox&lt;Coin&gt; = LootBox(Coin(<span style="color:#ae81ff">15</span>))
</span></span><span style="display:flex;"><span>lootBoxOne.<span style="color:#66d9ef">open</span> = <span style="color:#66d9ef">true</span> lootBoxOne.fetch(<span style="color:#ae81ff">1</span>)<span style="color:#f92672">?.</span>run {
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;You retrieve </span><span style="color:#e6db74">$name</span><span style="color:#e6db74"> from the box!&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">val</span> coin = lootBoxOne.fetch(<span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>        Coin(<span style="color:#66d9ef">it</span>.<span style="color:#66d9ef">value</span> * <span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    coin<span style="color:#f92672">?.</span>let { println(<span style="color:#66d9ef">it</span>.<span style="color:#66d9ef">value</span>) }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Another way to provide index access to the loot array is to have <strong>LootBox</strong> implement an operator function: the <code>get</code> function, which enables the <code>[]</code> operator.</p>
<p>Update <strong>LootBox</strong> to include a <strong>get</strong> operator implementation.</p>
<h3 id="listing-1713-adding-a-get-operator-to-__lootbox__-genericskt">Listing 17.13 Adding a get operator to <strong>LootBox</strong> (Generics.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LootBox</span>&lt;T : Loot&gt;(<span style="color:#66d9ef">vararg</span> item: T) {
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">var</span> open = <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">var</span> loot: Array&lt;<span style="color:#66d9ef">out</span> T&gt; = item
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">operator</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">get</span>(index: Int): T? = loot[index].takeIf { <span style="color:#66d9ef">open</span> }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">fetch</span>(item: Int): T? {
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">return</span> loot[item].takeIf { <span style="color:#66d9ef">open</span> }
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">fun</span> &lt;<span style="color:#a6e22e">R</span>&gt; <span style="color:#a6e22e">fetch</span>(item: Int, lootModFunction: (T) <span style="color:#f92672">-&gt;</span> R): R? {
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">return</span> lootModFunction(loot[item]).takeIf { <span style="color:#66d9ef">open</span> }
</span></span><span style="display:flex;"><span>   }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><p>Now use the new <strong>get</strong> operator in your <strong>main</strong> function</p>
<h3 id="listing-1714-using-get-genericskt">Listing 17.14 Using get (Generics.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    coin<span style="color:#f92672">?.</span>let { println(<span style="color:#66d9ef">it</span>.<span style="color:#66d9ef">value</span>) }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> fedora = lootBoxOne[<span style="color:#ae81ff">1</span>]
</span></span><span style="display:flex;"><span>&gt;&gt;  fedora<span style="color:#f92672">?.</span>let { println(<span style="color:#66d9ef">it</span>.name) }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="__in__-and-__out__"><strong>in</strong> and <strong>out</strong></h2>
<p>To further customize your generic type parameter. Kotlin provides the keywords <code>in</code> and <code>out</code></p>
<h3 id="listing-1715-defining-barrel-variancekt">Listing 17.15 Defining Barrel (Variance.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Barrel</span>&lt;T&gt;(<span style="color:#66d9ef">var</span> item: T)
</span></span></code></pre></div><h3 id="listing-1716-defining-barrels-in-main-variancekt">Listing 17.16 Defining Barrels in main (Variance.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Barrel</span>&lt;T&gt;(<span style="color:#66d9ef">var</span> item: T)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> fedoraBarrel: Barrel&lt;Fedora&gt; = Barrel(Fedora(<span style="color:#e6db74">&#34;a generic-looking fedora&#34;</span>, <span style="color:#ae81ff">15</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> lootBarrel: Barrel&lt;Loot&gt; = Barrel(Coin(<span style="color:#ae81ff">15</span>))
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-1717-attempting-to-reassign-lootbarrel-variancekt">Listing 17.17 Attempting to reassign lootBarrel (Variance.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Barrel</span>&lt;T&gt;(<span style="color:#66d9ef">var</span> item: T)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> fedoraBarrel: Barrel&lt;Fedora&gt; = Barrel(Fedora(<span style="color:#e6db74">&#34;a generic-looking fedora&#34;</span>, <span style="color:#ae81ff">15</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> lootBarrel: Barrel&lt;Loot&gt; = Barrel(Coin(<span style="color:#ae81ff">15</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  lootBarrel = fedoraBarrel
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing1718-assigning-a-coin-to-lootbarrelitem-variancekt">Listing17.18 Assigning a coin to lootBarrel.item (Variance.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Barrel</span>&lt;T&gt;(<span style="color:#66d9ef">var</span> item: T)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> fedoraBarrel: Barrel&lt;Fedora&gt; = Barrel(Fedora(<span style="color:#e6db74">&#34;a generic-looking fedora&#34;</span>, <span style="color:#ae81ff">15</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> lootBarrel: Barrel&lt;Loot&gt; = Barrel(Coin(<span style="color:#ae81ff">15</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    lootBarrel = fedoraBarrel
</span></span><span style="display:flex;"><span>&gt;&gt;  lootBarrel.item = Coin(<span style="color:#ae81ff">15</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing1719-accessing-fedorabarrelitem-variancekt">Listing17.19 Accessing fedoraBarrel.item (Variance.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Barrel</span>&lt;T&gt;(<span style="color:#66d9ef">var</span> item: T)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> fedoraBarrel: Barrel&lt;Fedora&gt; = Barrel(Fedora(<span style="color:#e6db74">&#34;a generic-looking fedora&#34;</span>, <span style="color:#ae81ff">15</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> lootBarrel: Barrel&lt;Loot&gt; = Barrel(Coin(<span style="color:#ae81ff">15</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    lootBarrel = fedoraBarrel
</span></span><span style="display:flex;"><span>    lootBarrel.item = Coin(<span style="color:#ae81ff">15</span>)
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> myFedora: Fedora = fedoraBarrel.item
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-1720-adding-out-variancekt">Listing 17.20 Adding out (Variance.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Barrel</span>&lt;<span style="color:#66d9ef">out</span> T&gt;(varval item: T)
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><h3 id="listing-1721-changing-the-assignment-variancekt">Listing 17.21 Changing the assignment (Variance.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Barrel</span>&lt;<span style="color:#66d9ef">out</span> T&gt;(<span style="color:#66d9ef">val</span> item: T)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> fedoraBarrel: Barrel&lt;Fedora&gt; = Barrel(Fedora(<span style="color:#e6db74">&#34;a generic-looking fedora&#34;</span>, <span style="color:#ae81ff">15</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> lootBarrel: Barrel&lt;Loot&gt; = Barrel(Coin(<span style="color:#ae81ff">15</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    lootBarrel = fedoraBarrel
</span></span><span style="display:flex;"><span>&lt;&lt;  lootBarrel.item = Coin(<span style="color:#ae81ff">15</span>)
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">val</span> myFedora: Fedora = fedoraBarrel.item
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">val</span> myFedora: Fedora = lootBarrel.item
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-1722-marking-barrel-within-variancekt">Listing 17.22 Marking Barrel within (Variance.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Barrel</span>&lt;inout T&gt;(<span style="color:#66d9ef">val</span> item: T)
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><h3 id="listing-1723-reversing-the-assignment-variancekt">Listing 17.23 Reversing the assignment (Variance.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> fedoraBarrel: Barrel&lt;Fedora&gt; = Barrel(Fedora(<span style="color:#e6db74">&#34;a generic-looking fedora&#34;</span>, <span style="color:#ae81ff">15</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> lootBarrel: Barrel&lt;Loot&gt; = Barrel(Coin(<span style="color:#ae81ff">15</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;&lt;  lootBarrel = fedoraBarrel
</span></span><span style="display:flex;"><span>&gt;&gt;  fedoraBarrel = lootBarrel
</span></span><span style="display:flex;"><span>&lt;&lt;  <span style="color:#66d9ef">val</span> myFedora: Fedora = lootBarrel.item
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h1 id="18-extensions">18. Extensions</h1>
<p><strong>Extensions</strong> allow you to add functionality to a type without directly modifying the type&rsquo;s definition. You can use extensions with your own types and also types you do not control, like <strong>List</strong>, <strong>Strings</strong> and other types from the Kotlin standard library.</p>
<p>Extensions are an alternative to the sharing bahavior of inheritance.</p>
<p>The Kotlin standard library frequently uses extensions.</p>
<h2 id="defining-extensions-functions">Defining Extensions Functions.</h2>
<p>My first extensions allows you to add a specified amount of enthusiasm to any String.</p>
<h3 id="listing-181-addiing-an-extension-to-string-extensionskt">Listing 18.1 Addiing an extension to String (Extensions.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">String</span>.addEnthusiasm(amount: Int = <span style="color:#ae81ff">1</span>) = <span style="color:#66d9ef">this</span> + <span style="color:#e6db74">&#34;!&#34;</span>.repeat(amount)
</span></span></code></pre></div><p>When you specify an extension function, you also specify the type the extensions adds functionality to, known as the <strong>receiver type</strong>. For the <em>addEnthusiasm</em> function, the receiver type you specified us String.</p>
<p><strong>addEnthusiasm&rsquo;s</strong> function body is a single-expression function that returns a new string: the contents of this plus 1 or more exclamations points, based on the argument passed to amount. The <em>this</em> keyword refers to the receiver instance the extension function was called on a String instance, in this case.</p>
<h3 id="listing-182-calling-the-new-extension-on-a-string-receiver-instance-extensionskt">Listing 18.2 Calling the new extension on a String receiver instance (Extensions.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">String</span>.addEnthusiasm(amount: Int = <span style="color:#ae81ff">1</span>) = <span style="color:#66d9ef">this</span> + <span style="color:#e6db74">&#34;!&#34;</span>.repeat(amount)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;Madrigal has left the building&#34;</span>.addEnthusiasm())
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="defining-an-extension-on-a-superclass">Defining an extension on a superclass</h2>
<p>Extension do not rely on inheritance, but they can be combined with inheritance to expand their scope. Define an extension on the Any type called <strong>easyPrint</strong></p>
<h3 id="listing-183-extending-any-extensionskt">Listing 18.3 Extending Any (Extensions.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Kotlin" data-lang="Kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">String</span>.addEnthusiasm(amount: Int = <span style="color:#ae81ff">1</span>) = <span style="color:#66d9ef">this</span> + <span style="color:#e6db74">&#34;!&#34;</span>.repeat(amount)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">Any</span>.easyPrint() = println(<span style="color:#66d9ef">this</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Madrigal has left the building&#34;</span>.addEnthusiasm().easyPrint()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Since you added the extension for the any type, it is also available for use with other subtyes. Call the extension on an <code>Int</code> after the <code>String</code></p>
<h3 id="listing-184-__easyprint__-is-available-on-all-subtypes-extensionskt">Listing 18.4 <strong>easyPrint</strong> is available on all subtypes (Extensions.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">String</span>.addEnthusiasm(amount: Int = <span style="color:#ae81ff">1</span>) = <span style="color:#66d9ef">this</span> + <span style="color:#e6db74">&#34;!&#34;</span>.repeat(amount)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">Any</span>.easyPrint() = println(<span style="color:#66d9ef">this</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Madrigal has left the building&#34;</span>.addEnthusiasm().easyPrint()
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">42.</span>easyPrint()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="generic-extension-functions">Generic Extension Functions</h2>
<h3 id="listing-185-making-__easypring__-chainable-extesionskt">Listing 18.5 Making <strong>easyPring</strong> chainable (Extesions.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">String</span>.addEnthusiasm(amount: Int = <span style="color:#ae81ff">1</span>) = <span style="color:#66d9ef">this</span> + <span style="color:#e6db74">&#34;!&#34;</span>.repeat(amount)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">Any</span>.easyPrint() : Any {
</span></span><span style="display:flex;"><span>    println(<span style="color:#66d9ef">this</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Now, try calling the easyPrint function two times: once before addEnthusiasm and once afteward</p>
<h3 id="listing-186-calling-easyprint-twice-extensionskt">Listing 18.6 Calling easyPrint twice (Extensions.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">String</span>.addEnthusiasm(amount: Int = <span style="color:#ae81ff">1</span>) = <span style="color:#66d9ef">this</span> + <span style="color:#e6db74">&#34;!&#34;</span>.repeat(amount)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">Any</span>.easyPrint(): Any {
</span></span><span style="display:flex;"><span>    println(<span style="color:#66d9ef">this</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Madrigal has left the building&#34;</span>.easyPrint().addEnthusiasm().easyPrint()
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">42.</span>easyPrint()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>The code does not compile. The first easyPrint call was allowed, buy addEnthisiasm was not. The easyPrint function returns the String it was called on, but uses Any to represent it. addEnthusiasm is only available on String, so it cannot be called on the return from easyPrint.</p>
<p>To solv this, you can make the extension generic.</p>
<h3 id="listing-187-making-easyprint-generic-extensionskt">Listing 18.7 Making easyPrint generic (Extensions.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">String</span>.addEnthusiasm(amount: Int = <span style="color:#ae81ff">1</span>) = <span style="color:#66d9ef">this</span> + <span style="color:#e6db74">&#34;!&#34;</span>.repeat(amount)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> &lt;<span style="color:#a6e22e">T</span>&gt; <span style="color:#a6e22e">T</span>.easyPrint(): T {
</span></span><span style="display:flex;"><span>    println(<span style="color:#66d9ef">this</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><h2 id="extension-properties">Extension Properties</h2>
<p>In addition to adding functionality to a type by specifying extension functions, you can also define extensions properties. Add another extension to String in Extensions.kt, this time an extension property that counts a strings&rsquo; vowels:</p>
<h3 id="listing-188-adding-an-extension-property-extensionskt">Listing 18.8 Adding an extension property (Extensions.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> String.numVowels
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">get</span>() = count { <span style="color:#e6db74">&#34;aeiou&#34;</span>.contains(<span style="color:#66d9ef">it</span>) }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">String</span>.addEnthusiasm(amount: Int = <span style="color:#ae81ff">1</span>) = <span style="color:#66d9ef">this</span> + <span style="color:#e6db74">&#34;!&#34;</span>.repeat(amount)
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><p>Try out your new extension property by printing the numVowel extension in <strong>main</strong>:</p>
<h3 id="listing-189-using-an-extension-property-extensionskt">Listing 18.9 Using an extension property (Extensions.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> String.numVowels
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">get</span>() = count { <span style="color:#e6db74">&#34;aeiouy&#34;</span>.contains(<span style="color:#66d9ef">it</span>) }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">String</span>.addEnthusiasm(amount: Int = <span style="color:#ae81ff">1</span>) = <span style="color:#66d9ef">this</span> + <span style="color:#e6db74">&#34;!&#34;</span>.repeat(amount)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> &lt;<span style="color:#a6e22e">T</span>&gt; <span style="color:#a6e22e">T</span>.easyPrint(): T {
</span></span><span style="display:flex;"><span>    println(<span style="color:#66d9ef">this</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Madrigal has left the building&#34;</span>.easyPrint().addEnthusiasm().easyPrint() <span style="color:#ae81ff">42.</span>easyPrint()
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;How many vowels?&#34;</span>.numVowels.easyPrint()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="extensions-on-nullable-types">Extensions on Nullable Types</h2>
<p>An extension can also be defined for use with nullable type. Defining an extension on a nullable type allows you to deal with the possibility of the value begin null within the body of extensions function, rather than at the call site.</p>
<p>Add an extension for nullable Strings in Extensions.kt and test it out in the main function:</p>
<h3 id="lisintg-1810-adding-an-extension-on-a-nullable-type-extensionskt">Lisintg 18.10 Adding an extension on a nullable type (Extensions.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">infix</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">String</span><span style="color:#f92672">?.</span>printWithdDefault(default: String) = println(<span style="color:#66d9ef">this</span> <span style="color:#f92672">?:</span> default)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;Madrigal has left the building&#34;</span>.easyPrint().addEnthusiasm().easyPrint()
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">42.</span>easyPrint()
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;How many vowels?&#34;</span>.numVowels.easyPrint()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> nullableString: String? = <span style="color:#66d9ef">null</span>
</span></span><span style="display:flex;"><span>    nullableString printWithDefault <span style="color:#e6db74">&#34;Default String&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>The <code>infix</code> keyword available for both extension and class functions that have a single argument, allows for the cleaner syntax you see in the function call.</p>
<p>If a function is defined with <code>infix</code> , you can omit the dow between the receiver and the function call as well the parentheses around the argument.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">null</span> printWithDefault <span style="color:#e6db74">&#34;Default string&#34;</span>  <span style="color:#75715e">// With infix
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">null</span>.printWithDefault(<span style="color:#e6db74">&#34;Default string&#34;</span>) <span style="color:#75715e">// Without infix
</span></span></span></code></pre></div><h2 id="extracting-to-extensions">Extracting to Extensions</h2>
<p>Applying what I have learned to refine NyeHack.</p>
<p>Tavern.kt contains duplicate chains of logic called onseveral collections: <code>shuffled().first()</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    (<span style="color:#ae81ff">0.</span>.<span style="color:#ae81ff">9</span>).forEach {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> first = patronList.shuffled().first()
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> last = lastName.shuffled().first()
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    uniquePatrons.forEach {
</span></span><span style="display:flex;"><span>        patronGold[<span style="color:#66d9ef">it</span>] = <span style="color:#ae81ff">6.0</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> orderCount = <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">while</span> (orderCount <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">9</span>) {
</span></span><span style="display:flex;"><span>        placeOrder(uniquePatrons.shuffled().first(),
</span></span><span style="display:flex;"><span>                menuList.shuffled().first())
</span></span><span style="display:flex;"><span>        orderCount<span style="color:#f92672">++</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span></code></pre></div><h3 id="lisintg-1811-adding-a-private-__random__-extension-tavernkt">Lisintg 18.11 Adding a private <strong>random</strong> extension (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> patronGold = mutableMapOf&lt;String, Double&gt;()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> &lt;<span style="color:#a6e22e">T</span>&gt; <span style="color:#a6e22e">Iterable</span>&lt;T&gt;.random(): T = <span style="color:#66d9ef">this</span>.shuffled().first()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><p>Now replace the old calls to shuffled().first() with a call to the extension function <strong>random</strong></p>
<h3 id="listing-1812-using-the-__random__-extension-tavernkt">Listing 18.12 Using the <strong>random</strong> extension (Tavern.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> &lt;<span style="color:#a6e22e">T</span>&gt; <span style="color:#a6e22e">Iterable</span>&lt;T&gt;.random(): T = <span style="color:#66d9ef">this</span>.shuffled().first()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>        (<span style="color:#ae81ff">0.</span>.<span style="color:#ae81ff">9</span>).forEach {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">val</span> first = patronList.random()
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">val</span> last = lastName.random()
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        uniquePatrons.forEach {
</span></span><span style="display:flex;"><span>            patronGold[<span style="color:#66d9ef">it</span>] = <span style="color:#ae81ff">6.0</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> orderCount = <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> (orderCount <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">9</span>) {
</span></span><span style="display:flex;"><span>            placeOrder(uniquePatrons.random(), menuList.random())
</span></span><span style="display:flex;"><span>            orderCount<span style="color:#f92672">++</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        displayPatronBalances()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><h3 id="listing-1814-adding-the-__random__-extension-to-iterableextkt-iterableextkt">Listing 18.14 Adding the <strong>random</strong> extension to IterableExt.kt (IterableExt.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">package</span> com.bignerdranch.nyethack.extensions
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> &lt;<span style="color:#a6e22e">T</span>&gt; <span style="color:#a6e22e">Iterable</span>&lt;T&gt;.random(): T = <span style="color:#66d9ef">this</span>.shuffled().first()
</span></span></code></pre></div><h3 id="listing-1815-using-random-in-selecthometown-playerkt">Listing 18.15 Using random in selectHometown (Player.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">selectHometown</span>() = File(<span style="color:#e6db74">&#34;data/towns.txt&#34;</span>)
</span></span><span style="display:flex;"><span>    .readText()
</span></span><span style="display:flex;"><span>    .split(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    .random()
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><h2 id="renaming-an-extension">Renaming an Extension</h2>
<h3 id="listing-1816-the-as-operator-taverkt">Listing 18.16 The as operator (Taver.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">import</span> com.bignerdranch.nyethack.extensions.random <span style="color:#66d9ef">as</span> randomizer
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">selectHometown</span>() = File(<span style="color:#e6db74">&#34;data/towns.txt&#34;</span>)
</span></span><span style="display:flex;"><span>    .readText()
</span></span><span style="display:flex;"><span>    .split(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>    .randomizer()
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><h1 id="19-functional-programming-basics">19. Functional Programming Basics</h1>
<p>For the last several chapters. you have been learning about and working with the object-oriented programming paradigm. Another prominent programming paradigm is <em>functional programming</em>, developed in the 1950s based on the mathematical abstraction lambda calculus. While functional programming languages have generally been more common in academia than in commercial software the principles of the approach are useful in any language.</p>
<p>The functional programming style relies on data that is returned from a small number of higher-order functions (functions that accpet or return another function) designed specifically to work on collections, and it favors with higher-order functions (which accpet functions as parameters and return functions as their result) and functions types (which enable you to define functions as values) already.</p>
<h2 id="function-categories">Function Categories</h2>
<p>There are three nroad categories of functions that compose a functional program: <em>transforms</em>, <em>filters</em> and <em>combines</em>. Each category is designed to work on collection data structures to yield a final result. Functions in functional programming are also designed to be <em>composable</em>, meaning that simple functions can be combined to build complex behavior.</p>
<h2 id="transforms">Transforms</h2>
<p>A <em>transform function</em> works on the contents of a collection by walking through the collections and transforming eache item with a <em>transformer function</em> provided as an argument. the transform function then returns a copy of the modified collection, and execution proceeds to the next function in the chain.</p>
<p>Two commonly used transforms are <strong>map</strong> and <strong>flatMap</strong></p>
<p>The <strong>map</strong> transforms functions iteratoes throught the collection it is called on and applies its transformer function to each element. The result is a collection with the same number of elements as the input collections.</p>
<h3 id="listing-191-converting-a-list-of-animals-to-babies---eith-tails-repl">Listing 19.1 Converting a list of animals to babies - eith tails (REPL)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> animals = listOf(<span style="color:#e6db74">&#34;zebra&#34;</span>, <span style="color:#e6db74">&#34;giraffe&#34;</span>, <span style="color:#e6db74">&#34;elephant&#34;</span>, <span style="color:#e6db74">&#34;rat&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">val</span> babies = animals
</span></span><span style="display:flex;"><span>    .map{ animal <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;A baby </span><span style="color:#e6db74">$animal</span><span style="color:#e6db74">&#34;</span>}
</span></span><span style="display:flex;"><span>    .map{ baby <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">$baby</span><span style="color:#e6db74">, with the cutest little tail ever!&#34;</span>}
</span></span><span style="display:flex;"><span>println (babies)
</span></span></code></pre></div><p>In the REPL, print the value of animals, the original list, to see that it has not changed</p>
<h3 id="listing-192-original-collection-not-modified-repl">Listing 19.2 Original collection not modified (REPL)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>print(animals)
</span></span><span style="display:flex;"><span>&gt;&gt;    <span style="color:#e6db74">&#34;zebra&#34;</span>, <span style="color:#e6db74">&#34;giraffe&#34;</span>, <span style="color:#e6db74">&#34;elephant&#34;</span>, <span style="color:#e6db74">&#34;rat&#34;</span>
</span></span></code></pre></div><h3 id="listing-193-before-and-after-mapping-same-number-of-itmes-different-types-repl">Listing 19.3 Before and after mapping: same number of itmes, different types (REPL)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> tenDollarWords = listOf(<span style="color:#e6db74">&#34;auspicious&#34;</span>, <span style="color:#e6db74">&#34;avuncular&#34;</span>, <span style="color:#e6db74">&#34;obviate&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">val</span> tenDollarLegths = tenDollarWords.map { <span style="color:#66d9ef">it</span>. length }
</span></span><span style="display:flex;"><span>print(tenDollarLegths)
</span></span><span style="display:flex;"><span>&gt;&gt;  [<span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">7</span>]
</span></span><span style="display:flex;"><span>tenDollarWords.size
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>tenDollarLegths.size
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#ae81ff">3</span>
</span></span></code></pre></div><h3 id="listing-194-flattening-two-list-repl">Listing 19.4 Flattening two list (REPL)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>listOf(listOf(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">3</span>), listOf(<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">6</span>)).flatMap{ <span style="color:#66d9ef">it</span> }
</span></span><span style="display:flex;"><span>&gt;&gt;  [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>]
</span></span></code></pre></div><h2 id="filters">Filters</h2>
<p>The second category of functions in functional programing is filters. A <em>filter function</em> accpets a predicate function that checks each element a collection against a condition and returns either true or false. If the prediacte return true, the element is added to the new collection that the filter returns. If the predicate returns false, the element is excluded from the new collections.</p>
<h3 id="listing-195-filtering-and-flattening-repl">Listing 19.5 Filtering and flattening (REPL)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> itemsOfManyColors = listOf(listOf(<span style="color:#e6db74">&#34;red apple&#34;</span>, <span style="color:#e6db74">&#34;green apple&#34;</span>, <span style="color:#e6db74">&#34;blue apple&#34;</span>), listOf(<span style="color:#e6db74">&#34;red fish&#34;</span>, <span style="color:#e6db74">&#34;blue fish&#34;</span>), listOf(<span style="color:#e6db74">&#34;yellow banana&#34;</span>, <span style="color:#e6db74">&#34;teal banana&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> redItems = itemsOfManyColors.flatMap { <span style="color:#66d9ef">it</span>.filter { <span style="color:#66d9ef">it</span>.contains(<span style="color:#e6db74">&#34;red&#34;</span>) } }
</span></span><span style="display:flex;"><span>print(redItems)
</span></span><span style="display:flex;"><span>&gt;&gt;  [red apple, red fish]
</span></span></code></pre></div><h3 id="listing-196-filtering-non-prime-numbers-repl">Listing 19.6 Filtering non-prime numbers (REPL)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> numbers = listOf(<span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">22</span>, <span style="color:#ae81ff">18</span>, <span style="color:#ae81ff">11</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">val</span> primes = numbers.filter { number <span style="color:#f92672">-&gt;</span> (<span style="color:#ae81ff">2</span> until number).map {number % <span style="color:#66d9ef">it</span>}.none { <span style="color:#66d9ef">it</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span>}}
</span></span><span style="display:flex;"><span>println( primes )
</span></span></code></pre></div><h2 id="combines">Combines</h2>
<p>The third category of functions used in functional programming is <em>combines</em>. Combining functions take different collections and merge the, into a new one.</p>
<h3 id="listing-197-combining-two-collections-functional-style-repl">Listing 19.7 Combining two collections, functional style (REPL)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">val</span> employees = listOf(<span style="color:#e6db74">&#34;Denny&#34;</span>, <span style="color:#e6db74">&#34;Claudette&#34;</span>, <span style="color:#e6db74">&#34;Peter&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">val</span> shirtSize = listOf(<span style="color:#e6db74">&#34;large&#34;</span>, <span style="color:#e6db74">&#34;x-large&#34;</span>, <span style="color:#e6db74">&#34;medium&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">val</span> employeeShirtSizes = employees.zip(shirtSize).toMap()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>println(employeeShirtSizes[<span style="color:#e6db74">&#34;Denny&#34;</span>])
</span></span><span style="display:flex;"><span>&gt;&gt;  large
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>println(employeeShirtSizes)
</span></span><span style="display:flex;"><span>&gt;&gt;  {Denny=large, Claudette=x-large, Peter=medium}
</span></span></code></pre></div><h2 id="why-functional-programming">Why functional Programming?</h2>
<p>At first glance, the imperative version here may look like it accomplishes the task in rouggly the same number of lines as the functional version.</p>
<ol>
<li>
<p>&ldquo;Accumulator&rdquo; variables are defined implicity, reducing the number of stateful variables to keep tracj of.</p>
</li>
<li>
<p>The result from functional operations are added to accumulator variables automatically, reduciong the risk of bugs.</p>
</li>
<li>
<p>New operations are trivially easy to add to the functional chain, since all functional operators work with the iterable you are performing work on.</p>
</li>
</ol>
<h2 id="sequences">Sequences</h2>
<p>These collection types are all know as <em>eager collections</em>. When an instance of any of these types is created, all the values it contains are added to the collection and can be accessed.</p>
<p>There is another flavor of collection: <em>lazy collections</em>. You learned about lazy initialization, in wich a variable is not initialized until it is first accessed. Lazy collection types, similar to lazy initialization of other types, provide better performance - specifically when working with very large collections - because their variables are produced only as needed.</p>
<p>With a sequences, you define a function that is referred to each time a new value is requested, called an <em>iterator function</em>. One way to define a sequence and its iterator is by using a seuqnce builder function provided by kotlin <strong>generateSequence</strong>, <strong>generateSequence</strong> accepts an initial seed value, the starting place for the sequence. When the sequence is acted on by a function , <strong>generateSequence</strong> calls an iterator you specify that determines the nex value to produce.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>generateSequence(<span style="color:#ae81ff">0</span>) { <span style="color:#66d9ef">it</span> + <span style="color:#ae81ff">1</span> }
</span></span><span style="display:flex;"><span>    .onEach { println(<span style="color:#e6db74">&#34;The Count says: </span><span style="color:#e6db74">$it</span><span style="color:#e6db74">, ah ah ah!&#34;</span>) }
</span></span></code></pre></div><h1 id="20-java-interoperability">20. Java Interoperability</h1>
<p>Full interoperability with Java means that kotlin files and Java files can exits in teh same project, side by sid. You can invoke Java methods from Kotlin and Kotlin function from Java. This means can use existing Java libraries from Kotlin, incliding the Android framework.</p>
<h2 id="interoperation-with-a-java-class">Interoperation with a Java Class</h2>
<p>Start by declaring the Jhava class and giving it a method called utterGreeting that returns a String.</p>
<h3 id="listing-201-declaring-a-class-and-method-in-java-jhavajava">Listing 20.1 Declaring a class and method in Java (Jhava.java)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Jhava</span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String utterGreeting(){
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;BLARGH&#34;</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Now, in Hero.kt, create a main function. In it declare an adversary val, and instance of Jhava.</p>
<h3 id="listing-202-declaring-a-main-function-and-jhava-adersary-in-kotlin-herokt">Listing 20.2 Declaring a main function and Jhava adersary in kotlin (Hero.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> adversary = Jhava()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-203-invoking-a-java-method-in-kotlin-herokt">Listing 20.3 Invoking a java method in kotlin (Hero.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> adversary = Jhava()
</span></span><span style="display:flex;"><span>&gt;&gt;  println(adversary.utterGreeting())
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="interoperability-and-nullity">Interoperability and Nullity</h2>
<h3 id="listing-204-returning-null-from-a--java-method-jhavajava">Listing 20.4 Returning null from a  java method (Jhava.java)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Jhava</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String utterGreeting() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;BLARGH&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">public</span> String determineFriendshipLevel() {
</span></span><span style="display:flex;"><span>&gt;&gt;      <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>&gt;&gt;  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Calling this methos from Hero.kt</p>
<h3 id="listing-205-printing-the-friendship-level-herokt">Listing 20.5 Printing the friendship level (Hero.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> adversary = Jhava()
</span></span><span style="display:flex;"><span>    println(adversary.utterGreeting())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> &gt;&gt; <span style="color:#66d9ef">val</span> friendshipLevel = adversary.determineFriendshipLevel()
</span></span><span style="display:flex;"><span> &gt;&gt; println(friendshipLevel.toLowerCase())
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-206-specifying-that-a-return-value-will-possibly-be-null-jhavajava">Listing 20.6 Specifying that a return value will possibly be null (Jhava.java)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Jhava</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String utterGreeting() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;BLARGH&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Nullable</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String determineFriendshipLevel() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>You will nedd to import org.jetbrains.annotations.Nullable</p>
<p>@Nullable warns the consumer of this API that the method can return null (not thta it <strong>must</strong> return null).</p>
<h3 id="listing-207-handling-nullability-with-the-safe-call-operator-herokt">Listing 20.7 Handling nullability with the safe call operator (Hero.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> adversary = Jhava()
</span></span><span style="display:flex;"><span>    println(adversary.utterGreeting())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> friendshipLevel = adversary.determineFriendshipLevel()
</span></span><span style="display:flex;"><span>    println(friendshipLevel<span style="color:#f92672">?.</span>toLowerCase())
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-208-providing-a-default-value-with-the-elvis-operaator-herokt">Listing 20.8 Providing a default value with the Elvis operaator (Hero.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> adversary = Jhava()
</span></span><span style="display:flex;"><span>    println(adversary.utterGreeting())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> friendshipLevel = adversary.determineFriendshipLevel()
</span></span><span style="display:flex;"><span>    println(friendshipLevel<span style="color:#f92672">?.</span>toLowerCase() <span style="color:#f92672">?:</span> <span style="color:#e6db74">&#34;It&#39;s complicated.&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>You used @Nullable to signify that a method could return null. You can specify that a value will definitely not be null using the @NotNull annotation. This annotations is nice, because it means that the consumer of this API does not need to worry that the value returned could be null.</p>
<h3 id="listing-209-specifying-that-a-return-value-will-not-be-null-jhavajava">Listing 20.9 Specifying that a return value will not be null (Jhava.java)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Jhava</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@NotNull</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String utterGreeting() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;BLARGH&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Nullable</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String determineFriendshipLevel() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>You will need to import the annotation <code>com.sun.istack.internal.NotNull</code></p>
<h2 id="type-mapping">Type Mapping</h2>
<p>Kotlin&rsquo;s types often correspond one to one with Java types. A String in Kotlin is a String when compiled down to Java. This means that a String returned from Java methods can be used in the same way in Kotlin as a String explicity declared in Kotlin. Some type mappings that are not one to one between Kotlin and Java.</p>
<h3 id="listing-2010-declaring-an-int-in-java-jhavajava">Listing 20.10 Declaring an int in Java (Jhava.java)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Jhava</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> int hitPoints = <span style="color:#ae81ff">52489112</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@NotNull</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String utterGreeting() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;BLARGH&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Nullable</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String determineFriendshipLevel() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-2011-referencing-a-java-field-from-kotlin-herokt">Listing 20.11 Referencing a java field from Kotlin (Hero.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> adversary = Jhava()
</span></span><span style="display:flex;"><span>    println(adversary.utterGreeting())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> friendshipLevel = adversary.determineFriendshipLevel()\
</span></span><span style="display:flex;"><span>    println(friendshipLevel<span style="color:#f92672">?.</span>toLowerCase() <span style="color:#f92672">?:</span> <span style="color:#e6db74">&#34;It&#39;s complicated.&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> adversaryHitPoints: Int = adversary.hitPoints
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Now that you have a reference to this integer, you can invoke functions on it. Call a function on adversary]HitPoiints and print out the result</p>
<h3 id="listing-2012-referencing-a-java-filed-from-kotlin-herokt">Listing 20.12 Referencing a Java filed from Kotlin (Hero.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> adversaryHitPoints: Int = adversary.hitPoints
</span></span><span style="display:flex;"><span>    println(adversaryHitPoints.dec())
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="getters-setters-and-interoperability">Getters, Setters, and Interoperability</h2>
<p>Kotlin and Java handle class-level variables quite differently. Java uses fileds and typically gates access via accessor and mutator methods. Kotlin, as you have seen, features propertiesm which restrict access to backing filed and may automatically expose accessors and mutators.</p>
<h3 id="listing-2014-declaring-a-field-in-java-jhavajava">Listing 20.14 Declaring a field in Java (Jhava.java)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Jhava</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    publicprivate int hitPoints = <span style="color:#ae81ff">52489112</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@NotNull</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String utterGreeting() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;BLARGH&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Nullable</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String determineFriendshipLevel() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> int getHitPoints() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> hitPoints;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-2015-exposing-a-greeting-in-java-jhavajava">Listing 20.15 Exposing a greeting in java (Jhava.java)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Jhava</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> int hitPoints = <span style="color:#ae81ff">52489112</span>;
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">private</span> String greeting = <span style="color:#e6db74">&#34;BLARGH&#34;</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@NotNull</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> String utterGreeting() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> greeting;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">public</span> String getGreeting() {
</span></span><span style="display:flex;"><span>&gt;&gt;      <span style="color:#66d9ef">return</span> greeting;
</span></span><span style="display:flex;"><span>&gt;&gt;  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  <span style="color:#66d9ef">public</span> void setGreeting(String greeting) {
</span></span><span style="display:flex;"><span>&gt;&gt;      <span style="color:#66d9ef">this</span>.greeting = greeting;
</span></span><span style="display:flex;"><span>&gt;&gt;  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-2016-setting-a-java-field-from-kotlin-hrtokt">Listing 20.16 Setting a Java field from kotlin (Hrto.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> adversaryHitPoints: Int = adversary.hitPoints
</span></span><span style="display:flex;"><span>    println(adversaryHitPoints.dec())
</span></span><span style="display:flex;"><span>    println(adversaryHitPoints.javaClass)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt;&gt;  adversary.greeting = <span style="color:#e6db74">&#34;Hello, Hero.&#34;</span>
</span></span><span style="display:flex;"><span>&gt;&gt;  println(adversary.utterGreeting())
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>You can use assigment syntaxis to mutate a Java field, rather calling its associated setter</p>
<h2 id="beyond-classes">Beyond Classes</h2>
<p>Kotlin affords developers greater flexibility with respect to the format of the code that they write. A kotlin file can include classes, functions and variables.</p>
<h3 id="listing-2017-declaring-a-top-level-function-in-kotlin-kotlinkt">Listing 20.17 Declaring a top-level function in kotlin (Kotlin.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">makeProclamation</span>() = <span style="color:#e6db74">&#34;Greetings, beast!&#34;</span>
</span></span></code></pre></div><p>You will need a way to invoke this function from Java, so add a main method to Jhava.</p>
<h3 id="listing-2018-defining-a-main-methos-in-java-jhavajava">Listing 20.18 Defining a main methos in java (Jhava.java)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Jhava</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> int hitPoints = <span style="color:#ae81ff">52489112</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> String greeting = <span style="color:#e6db74">&#34;BLARGH&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> static void main(String[] args) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-2019-referencing-a-top-level-kotlin-function-from-java-jhavakt">Listing 20.19 Referencing a top-level Kotlin function from java (Jhava.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Jhava</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> static void main(String[] args) {
</span></span><span style="display:flex;"><span>&gt;&gt;      <span style="color:#a6e22e">System</span>.<span style="color:#66d9ef">out</span>.println(<span style="color:#a6e22e">HeroKt</span>.makeProclamation());
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>If you would like Hero.kt and Jhava.java to interoperate a bit more fluidly, you can change the name of the generated class with the @JvmName annotation.</p>
<h3 id="listing-2020-specifying-compiled-class-name-using-jvmname-herokt">Listing 20.20 Specifying compiled class name using JvmName (Hero.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span>&gt;&gt;  <span style="color:#a6e22e">@file</span>:JvmName(<span style="color:#e6db74">&#34;Hero&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    }
</span></span></code></pre></div><p>Now, in Jhava, you can reference the makePlocamation function more cleanly</p>
<h3 id="listing-2021-referencing-a-renamed-top-level-kotlin-function-from-java-jhavajava">Listing 20.21 Referencing a renamed top-level Kotlin function from Java (Jhava.java)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Jhava</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> static void main(String[] args) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">System</span>.<span style="color:#66d9ef">out</span>.println(<span style="color:#a6e22e">Hero</span>.makeProclamation());
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Another importan JVM annotation is <code>@JvmOverloads</code>. Kotlin&rsquo;s default paramters empower you to replace verbose, repetitive method overloading with a streamlined approach to providing options in your API.</p>
<p>Add a new function called bandOverFood to Hero.kt</p>
<h3 id="listing-2022-adding-a-funtion-with-default-parameters-herokt">Listing 20.22 Adding a funtion with default parameters (Hero.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">makeProclamation</span>() = <span style="color:#e6db74">&#34;Greetings, beast!&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">handOverFood</span>(leftHand: String = <span style="color:#e6db74">&#34;berries&#34;</span>, rightHand: String = <span style="color:#e6db74">&#34;beef&#34;</span>) {
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;Mmmm... you hand over some delicious </span><span style="color:#e6db74">$leftHand</span><span style="color:#e6db74"> and </span><span style="color:#e6db74">$rightHand</span><span style="color:#e6db74">.&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>As you will see in a moment, the @JvmOverloads annotation triggers the generation of the three a method called offerFood to Jhava.java that exposes a way for a Hero to offer food to a Jhava</p>
<h3 id="listing-2023-only-one-method-signature-jhavajava">Listing 20.23 Only one method signature (Jhava.java)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Jhava</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> void setGreeting(String greeting) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.greeting = greeting;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> void offerFood() {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Hero</span>.handOverFood(<span style="color:#e6db74">&#34;pizza&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-2024-adding-jvmoverloads-herokt">Listing 20.24 Adding @JvmOverloads (Hero.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">makeProclamation</span>() = <span style="color:#e6db74">&#34;Greetings, beast!&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@JvmOverloads</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">handOverFood</span>(leftHand: String = <span style="color:#e6db74">&#34;berries&#34;</span>, rightHand: String = <span style="color:#e6db74">&#34;beef&#34;</span>) {
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;Mmmm... you hand over some delicious </span><span style="color:#e6db74">$leftHand</span><span style="color:#e6db74"> and </span><span style="color:#e6db74">$rightHand</span><span style="color:#e6db74">.&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>To test.</p>
<h3 id="listing-2025-testing-out-offerfood-herokt">Listing 20.25 Testing out offerFood (Hero.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#a6e22e">@file</span>:JvmName(<span style="color:#e6db74">&#34;Hero&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    adversary.greeting = <span style="color:#e6db74">&#34;Hello, Hero.&#34;</span>
</span></span><span style="display:flex;"><span>    println(adversary.utterGreeting())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    adversary.offerFood()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">makeProclamation</span>() = <span style="color:#e6db74">&#34;Greetings, beast!&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><h3 id="listing-2026-declaring-the-spellbook-class-herokt">Listing 20.26 Declaring the Spellbook class (Hero.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@JvmOverloads</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">handOverFood</span>(leftHand: String = <span style="color:#e6db74">&#34;berries&#34;</span>, rightHand: String = <span style="color:#e6db74">&#34;beef&#34;</span>) {
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;Mmmm... you hand over some delicious </span><span style="color:#e6db74">$leftHand</span><span style="color:#e6db74"> and </span><span style="color:#e6db74">$rightHand</span><span style="color:#e6db74">.&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Spellbook</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> spells = listOf(<span style="color:#e6db74">&#34;Magic Ms. L&#34;</span>, <span style="color:#e6db74">&#34;Lay on Hans&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>You can apply the @JvmField annotation to a Kotlin property to expose its backing field to Java consumers and avoid the need for a getter methos. Apply <code>JVMField</code> to spells to expose it directly to Jhava.</p>
<h3 id="listing-2027-applying-the-jvmfield-annotation-herokt">Listing 20.27 Applying the @JvmField annotation (Hero.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@JvmOverloads</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">handOverFood</span>(leftHand: String = <span style="color:#e6db74">&#34;berries&#34;</span>, rightHand: String = <span style="color:#e6db74">&#34;beef&#34;</span>) {
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;Mmmm... you hand over some delicious </span><span style="color:#e6db74">$leftHand</span><span style="color:#e6db74"> and </span><span style="color:#e6db74">$rightHand</span><span style="color:#e6db74">.&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Spellbook</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@JvmField</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> spells = listOf(<span style="color:#e6db74">&#34;Magic Ms. L&#34;</span>, <span style="color:#e6db74">&#34;Lay on Hans&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Now, in Jhava.java&rsquo;s main method, you can access spells derectly to print out each spell:</p>
<h3 id="listing-2028-accessing-a-kotlin-field-directly-in-java-jhavajava">Listing 20.28 Accessing a Kotlin field directly in java (Jhava.java)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> static void main(String[] args) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">System</span>.<span style="color:#66d9ef">out</span>.println(<span style="color:#a6e22e">Hero</span>.makeProclamation());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">System</span>.<span style="color:#66d9ef">out</span>.println(<span style="color:#e6db74">&#34;Spells:&#34;</span>);
</span></span><span style="display:flex;"><span>    Spellbook spellbook = new Spellbook();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (String spell : spellbook.spells) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">System</span>.<span style="color:#66d9ef">out</span>.println(spell);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@NotNull</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> String utterGreeting() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> greeting;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><h3 id="listing-2029-adding-a-companion-object-to-spellbook-herokt">Listing 20.29 Adding a companion object to Spellbook (Hero.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Spellbook</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@JvmField</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> spells = listOf(<span style="color:#e6db74">&#34;Magic Ms. L&#34;</span>, <span style="color:#e6db74">&#34;Lay on Hans&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">companion</span> <span style="color:#66d9ef">object</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> MAX_SPELL_COUNT = <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Now attempt to access MAX_SPELL_COUNT from Jhava&rsquo;s main method using Java&rsquo;static acces syntax</p>
<h3 id="listing-2030-accessing-a-static-value-in-java-jhavajava">Listing 20.30 Accessing a static value in Java (Jhava.java)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> static void main(String[] args) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">System</span>.<span style="color:#66d9ef">out</span>.println(<span style="color:#a6e22e">Hero</span>.makeProclamation());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">System</span>.<span style="color:#66d9ef">out</span>.println(<span style="color:#e6db74">&#34;Spells:&#34;</span>);
</span></span><span style="display:flex;"><span>    Spellbook spellbook = new Spellbook();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (String spell : spellbook.spells) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">System</span>.<span style="color:#66d9ef">out</span>.println(spell);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">System</span>.<span style="color:#66d9ef">out</span>.println(<span style="color:#e6db74">&#34;Max spell count: &#34;</span> + <span style="color:#a6e22e">Spellbook</span>.MAX_SPELL_COUNT);
</span></span><span style="display:flex;"><span>} <span style="color:#f92672">..</span>.
</span></span></code></pre></div><h3 id="listing-2031-adding-the-jvmfield-annotation-to-the-memeber-of-a-companion-object-herokt">Listing 20.31 Adding the @JvmField annotation to the memeber of a companion object (Hero.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Spellbook</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@JvmField</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> spells = listOf(<span style="color:#e6db74">&#34;Magic Ms. L&#34;</span>, <span style="color:#e6db74">&#34;Lay on Hans&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">companion</span> <span style="color:#66d9ef">object</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">@JvmField</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> MAX_SPELL_COUNT = <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>The <code>@JvmStatic</code> annotation works like `@JvmField to allow direct acces to functionsto the companion object.</p>
<h3 id="listing-2032-using-jvmstatic-on-a-function-herokt">Listing 20.32 Using @JvmStatic on a function (Hero.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Spellbook</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@JvmField</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">val</span> spells = listOf(<span style="color:#e6db74">&#34;Magic Ms. L&#34;</span>, <span style="color:#e6db74">&#34;Lay on Hans&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">companion</span> <span style="color:#66d9ef">object</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">@JvmField</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">val</span> MAX_SPELL_COUNT = <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">@JvmStatic</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">getSpellbookGreeting</span>() = println(<span style="color:#e6db74">&#34;I am the Great Grimoire!&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Now, invoke gteSpellbookGreeting in Jhava.java</p>
<h3 id="listing-2033-invoking-a-static-method-in-java-jhavajava">Listing 20.33 Invoking a static method in java (Jhava.java)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> static void main(String[] args) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">System</span>.<span style="color:#66d9ef">out</span>.println(<span style="color:#a6e22e">Hero</span>.makeProclamation());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">System</span>.<span style="color:#66d9ef">out</span>.println(<span style="color:#e6db74">&#34;Spells:&#34;</span>);
</span></span><span style="display:flex;"><span>    Spellbook spellbook = new Spellbook();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (String spell : spellbook.spells) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">System</span>.<span style="color:#66d9ef">out</span>.println(spell);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">System</span>.<span style="color:#66d9ef">out</span>.println(<span style="color:#e6db74">&#34;Max spell count: &#34;</span> + <span style="color:#a6e22e">Spellbook</span>.MAX_SPELL_COUNT);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Spellbook</span>.getSpellbookGreeting();
</span></span><span style="display:flex;"><span>} <span style="color:#f92672">..</span>.
</span></span></code></pre></div><p>Although statics do not exist in kotlin, many commonly used patters compile down to static variables and methods. Employing the @JvmStatic annotation gives you great controlhow Java developers interface with your code.</p>
<h2 id="exceptions-and-interoperability">Exceptions and Interoperability</h2>
<h3 id="listing-2034-throwing-an-exception-in-java-jhavajava">Listing 20.34 Throwing an exception in java (Jhava.java)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Jhava</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> void offerFood() {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Hero</span>.handOverFood(<span style="color:#e6db74">&#34;pizza&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> void extendHandInFriendship() throws Exception {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">throw</span> new Exception();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Invoke the method in Hero.kt</p>
<h3 id="listing-2035-invoking-a-method-that-throws-and-exception-herokt">Listing 20.35 Invoking a method that throws and exception (Hero.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#a6e22e">@file</span>:JvmName(<span style="color:#e6db74">&#34;Hero&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    adversary.offerFood()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    adversary.extendHandInFriendship()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">makeProclamation</span>() = <span style="color:#e6db74">&#34;Greetings, beast!&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><h2 id="listing-2036-handling-exceptions-using-trycatch-herokt">Listing 20.36 Handling exceptions using try/catch (Hero.kt)</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#a6e22e">@file</span>:JvmName(<span style="color:#e6db74">&#34;Hero&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    adversary.offerFood()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>        adversary.extendHandInFriendship()
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> (e: Exception) {
</span></span><span style="display:flex;"><span>        println(<span style="color:#e6db74">&#34;Begone, foul beast!&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">makeProclamation</span>() = <span style="color:#e6db74">&#34;Greetings, beast!&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span></code></pre></div><h3 id="listing-2037-throwing-an-unchecked-excpetion-herokt">Listing 20.37 Throwing an unchecked excpetion (Hero.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@JvmOverloads</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">handOverFood</span>(leftHand: String = <span style="color:#e6db74">&#34;berries&#34;</span>, rightHand: String = <span style="color:#e6db74">&#34;beef&#34;</span>) {
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;Mmmm... you hand over some delicious </span><span style="color:#e6db74">$leftHand</span><span style="color:#e6db74"> and </span><span style="color:#e6db74">$rightHand</span><span style="color:#e6db74">.&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">acceptApology</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">throw</span> IOException()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Spellbook</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>You will need to import java.io.IOException and call accept Apology from Jhava.java</p>
<h3 id="listing-2038-throwing-an-exception-in-java-jhavajava">Listing 20.38 Throwing an exception in java (Jhava.java)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Jhava</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> void apologize() {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">Hero</span>.acceptApology();
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">catch</span> (IOException e) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">System</span>.<span style="color:#66d9ef">out</span>.println(<span style="color:#e6db74">&#34;Caught!&#34;</span>);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="listing-2039-using-the-throws-annotation-herokt">Listing 20.39 Using the @Throws annotation (Hero.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@Throws</span>(IOException<span style="color:#f92672">::</span><span style="color:#66d9ef">class</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">acceptApology</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">throw</span> IOException()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Spellbook</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="function-types-in-java">Function Types in Java</h2>
<p>Function types and anonymous functions are novel inclusion in the Kotlin programming languages that provide a streamlined syntax for communication between componentes. Their concise syntax is made possible vie the -&gt; operator, nut lambdas are not supported in versions of Java prior to Java 8.</p>
<h3 id="listing-2040-defining-the-translator-function-type-herokt">Listing 20.40 Defining the translator function type (Hero.kt)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">main</span>(args: Array&lt;String&gt;) {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">val</span> translator = { utterance: String <span style="color:#f92672">-&gt;</span>
</span></span><span style="display:flex;"><span>    println(utterance.toLowerCase().capitalize())
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fun</span> <span style="color:#a6e22e">makeProclamation</span>() = <span style="color:#e6db74">&#34;Greetings, beast!&#34;</span>
</span></span></code></pre></div><h3 id="listing-2041--storing-a-function-type-in-a-variable-in-java-jhavajava">Listing 20.41  Storing a function type in a variable in Java (Jhava.java)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Jhava</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> static void main(String[] args) {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Spellbook</span>.getSpellbookGreeting();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        Function1&lt;String, Unit&gt; translator = <span style="color:#a6e22e">Hero</span>.getTranslator();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>You will be need to import <code>kotlin.Unit</code>; be sure to choose the option from the Kotlin standard library. Even you will also need to import <code>kotlin.jvm.functions.Function1</code></p>
<p>The function type is of type <code>Function&lt;String, Unit&gt;</code>, <code>Function1</code> is the vase type because transaltor has exactly one parameter. String and Unit are used as type parameters because the type of translato&rsquo;s paramter is String and it returns the Kotlin type Unit.</p>
<p>There are 23 of these <code>Function</code> interfaces, ranging from <code>Function0</code> to <code>Function22</code></p>
<h3 id="listing-2042-calling-a-function-type-in-java-jhavajava">Listing 20.42 Calling a function type in java (Jhava.java)</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-kotlin" data-lang="kotlin"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Jhava</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> static void main(String[] args) {
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">..</span>.
</span></span><span style="display:flex;"><span>        Function1&lt;String, Unit&gt; translator = <span style="color:#a6e22e">Hero</span>.getTranslator();
</span></span><span style="display:flex;"><span>        translator.invoke(<span style="color:#e6db74">&#34;TRUCE&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>While function types are useful in Kotlinm be mindful of how theu are represented in Java. The concise, fluid syntaxis that you have grown fond of in Kotlin is quite different when called from Java.</p>
<p>Interoperability between Kotlin and Java is the foundation of Kotlin&rsquo;s growth trajectory. It provides Kotlin with the ability to leverage existing frameworks, such as Android, and to interface with legacy codebases, giving you a path to gradually introduce Kotlin in your projects.</p>
</section>

  
  

  
  
  
  <nav class="mt-24 flex rounded-lg bg-black/[3%] text-lg dark:bg-white/[8%]">
    
    <a
      class="flex w-1/2 items-center rounded-l-md p-6 pr-3 font-semibold no-underline hover:bg-black/[2%] dark:hover:bg-white/[3%]"
      href="https://julitiux.github.io/posts/docker/"
      ><span class="mr-1.5">â†</span><span>Docker</span></a
    >
    
    
    <a
      class="ml-auto flex w-1/2 items-center justify-end rounded-r-md p-6 pl-3 font-semibold no-underline hover:bg-black/[2%] dark:hover:bg-white/[3%]"
      href="https://julitiux.github.io/posts/elixir/"
      ><span>Elixir</span><span class="ml-1.5">â†’</span></a
    >
    
  </nav>
  

  
  

  
  
</article>


    </main>

    <footer
  class="opaco mx-auto flex h-[4.5rem] max-w-3xl items-center px-8 text-[0.9em] opacity-60"
>
  <div class="mr-auto">
    &copy; 2023
    <a class="link" href="https://julitiux.github.io/">Blogs</a>
  </div>
  <a class="link mx-6" href="https://gohugo.io/" rel="noopener" target="_blank"
    >Powered by Hugoï¸ï¸</a
  >ï¸
  <a
    class="link"
    href="https://github.com/nanxiaobei/hugo-paper"
    rel="noopener"
    target="_blank"
    >âœŽ Paper</a
  >
</footer>

  </body>
</html>
